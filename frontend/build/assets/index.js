import{B as e,y as r,S as _r,U as ft,V as Or,X as Er,Y as Xe,Z as Hr,$ as Vr,I as Ar}from"./vendor_node_modules.js";import{u as Ur,S as qr}from"./vendor_notistack.js";import{D as He,a as Ve,b as Ae,B as de,c as Ge,F as Ye,C as Be,d as ae,A as zr,I as G,e as Br,f as Qr,T as E,g as be,M as Kr,h as st,i as w,j as Fe,k as gr,l as Gr,m as Mt,n as Jr,o as he,K as Qt,p as Kt,q as Ht,L as xt,r as dt,s as bt,t as B,W as ut,u as vt,H as yt,v as re,V as Gt,w as Jt,x as Zr,E as Yr,Q as mr,R as Dt,S as Xr,U as eo,P as to,y as hr,z as Vt,G as _e,J as At,N as fr,O as Je,X as xr,Y as ro,Z as br,_ as oo,$ as no,a0 as io,a1 as Zt,a2 as so,a3 as lo,a4 as ao,a5 as co,a6 as po,a7 as uo,a8 as go,a9 as Yt,aa as mo,ab as ho,ac as fo,ad as xo,ae as bo,af as vo,ag as yo,ah as jo,ai as Co,aj as wo,ak as So,al as ko,am as Io,an as ze,ao as Mo,ap as Do,aq as Ft,ar as vr,as as we,at as yr,au as $t,av as Ke,aw as Po,ax as Lo,ay as Qe,az as $o,aA as We,aB as jt,aC as Nt,aD as To,aE as Wo}from"./vendor_mui.js";import{I as ce,m as Fo,a as Xt,b as No,c as Ro,d as er,e as _o,f as Oo,g as Eo,h as Ho,i as Vo,j as Ao,k as Uo,l as qo,n as zo,o as Bo,p as Qo,q as Ko,r as tr,s as Go,t as Jo,u as Zo,v as Yo,w as Xo,x as en,y as tn,z as rn,A as rr,B as on,C as nn}from"./vendor_mdi.js";import{Q as sn}from"./vendor_qrcode.js";import{F as ln,v as an,e as cn,a as dn,g as pn,b as un,c as gn,d as Rt,A as mn}from"./vendor_rjsf.js";import"./vendor_lodash.js";import"./vendor_emotion.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const m of s)if(m.type==="childList")for(const g of m.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&i(g)}).observe(document,{childList:!0,subtree:!0});function l(s){const m={};return s.integrity&&(m.integrity=s.integrity),s.referrerPolicy&&(m.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?m.credentials="include":s.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function i(s){if(s.ep)return;s.ep=!0;const m=l(s);fetch(s.href,m)}})();function hn({open:n,title:a,message:l,onConfirm:i,onCancel:s}){const m=x=>{o&&console.log("Confirmed"),x.preventDefault(),i()},g=x=>{o&&console.log("Canceled"),x.preventDefault(),s()};return e.jsxs(He,{open:n,children:[e.jsx(Ve,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:a})]})}),e.jsxs(Ae,{children:[e.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",margin:"0",marginBottom:"20px",maxHeight:"350px",maxWidth:"350px"},children:e.jsx("p",{style:{flex:1,margin:"0"},children:l})}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around"},children:[e.jsx(de,{onClick:m,variant:"contained",color:"primary",size:"small",children:"Confirm"}),e.jsx(de,{onClick:g,variant:"contained",color:"primary",size:"small",children:"Cancel"})]})]})]})}const fe="",oe={enableMobile:`${fe}enableMobile`,devicesFilter:`${fe}devicesFilter`,devicesViewMode:`${fe}devicesViewMode`,frontendVersion:`${fe}frontendVersion`,matterbridgeVersion:`${fe}matterbridgeVersion`,homePageMode:`${fe}homePageMode`,logFilterLevel:`${fe}logFilterLevel`,logFilterSearch:`${fe}logFilterSearch`,logAutoScroll:`${fe}logAutoScroll`,logLength:`${fe}logLength`,frontendTheme:`${fe}frontendTheme`,homePagePlugins:`${fe}homePagePlugins`,virtualMode:`${fe}virtualMode`,installAutoExit:`${fe}installAutoExit`},fn={Devices_table_order_by:`${fe}Devices_table_order_by`,Devices_table_order:`${fe}Devices_table_order`,Devices_column_visibility:`${fe}Devices_column_visibility`,Plugins_table_order_by:`${fe}Plugins_table_order_by`,Plugins_table_order:`${fe}Plugins_table_order`,Plugins_column_visibility:`${fe}Plugins_column_visibility`,"Registered devices_table_order_by":`${fe}Registered devices_table_order_by`,"Registered devices_table_order":`${fe}Registered devices_table_order`,"Registered devices_column_visibility":`${fe}Registered devices_column_visibility`,Clusters_table_order_by:`${fe}Clusters_table_order_by`,Clusters_table_order:`${fe}Clusters_table_order`,Clusters_column_visibility:`${fe}Clusters_column_visibility`};function xn(){Object.values(oe).forEach(n=>{localStorage.removeItem(n)}),Object.values(fn).forEach(n=>{localStorage.removeItem(n)})}const bn=({open:n,output:a,title:l,_command:i,_packageName:s,onInstall:m,onClose:g})=>{const{installAutoExit:x,setInstallAutoExit:j}=r.useContext(Le),t=r.useRef(null),D=v=>{j(v.target.checked),localStorage.setItem(oe.installAutoExit,v.target.checked?"true":"false"),o&&console.log("handleInstallAutoExitChange called with value:",v.target.checked)};return r.useEffect(()=>{o&&console.log(`InstallProgressDialog output effect mounted, scrolling to bottom: ${t.current}`),setTimeout(()=>{o&&console.log("Scrolling to bottom:",t.current),t.current?.scrollIntoView({behavior:"smooth",block:"end"})},0)},[a]),e.jsxs(He,{open:n,onClose:(v,S)=>{S==="backdropClick"||S==="escapeKeyDown"||g()},slotProps:{paper:{sx:{width:"70vw",maxWidth:"70vw",height:"70vw",maxHeight:"70vh",overflow:"hidden"}}},children:[e.jsx(Ve,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:l})]})}),e.jsxs(Ae,{dividers:!0,style:{overflow:"hidden",display:"flex",flexDirection:"column",height:400,paddingBottom:0},children:[e.jsx("label",{style:{display:"block",marginBottom:"10px",fontSize:"16px",fontWeight:"bold",color:"var(--primary-color)"},children:"Process log"}),e.jsxs("ul",{style:{width:"100%",height:"100%",fontFamily:"monospace",fontSize:"14px",padding:"10px",margin:0,marginBottom:"10px",color:"var(--div-text-color)",background:"var(--div-bg-color)",overflow:"auto",listStyle:"none",boxSizing:"border-box",borderRadius:4,border:"4px solid var(--primary-color)",whiteSpace:"pre-wrap",display:"block"},children:[a.split(`
`).map((v,S)=>e.jsx("li",{style:{padding:0,margin:0,wordBreak:"break-all"},children:v},S)),e.jsx("li",{ref:t,style:{padding:0,margin:0}})]})]}),e.jsxs(Ge,{sx:{justifyContent:"space-evenly"},children:[m&&e.jsx(de,{variant:"contained",onClick:m,children:"Install"}),e.jsx(de,{onClick:g,children:"Close"}),e.jsx(Ye,{control:e.jsx(Be,{checked:x,onChange:v=>D(v)}),label:"Close on success",style:{color:"var(--div-text-color)"}})]})]})},Ct=[],Le=r.createContext(null);function vn({children:n}){const[a,l]=r.useState(!1),[i,s]=r.useState(null),{enqueueSnackbar:m,closeSnackbar:g}=Ur(),x=r.useCallback(P=>{o&&console.log(`UiProvider closeSnackbarMessage: message ${P}`);const O=Ct.findIndex(X=>X.message===P);O!==-1&&(g(Ct[O].key),Ct.splice(O,1),o&&console.log(`UiProvider closeSnackbarMessage: message ${P} removed from persistMessages`))},[g]),j=r.useCallback((P,O,X)=>{o&&console.log(`UiProvider showSnackbarMessage: message ${P} timeout ${O}`);const me=m(P,{variant:"default",autoHideDuration:O==null||O>0?(O??5)*1e3:null,persist:O===0,content:ue=>e.jsx(ae,{sx:{margin:"0",padding:"0",width:"300px",marginRight:"30px"},children:e.jsx(zr,{severity:X??"info",variant:"filled",sx:{color:"#fff",fontWeight:"normal",width:"100%",cursor:"pointer",padding:"0px 10px"},onClick:()=>g(ue),action:e.jsx(G,{size:"small",onClick:()=>g(ue),sx:{color:"#fff"},children:e.jsx(Br,{fontSize:"small"})}),children:P},ue)},ue)});O===0&&(o&&console.log(`UiProvider showSnackbarMessage: message ${P} timeout ${O} - persist key ${me}`),Ct.push({message:P,key:me}))},[m,g]),[t,D]=r.useState(!1),[v,S]=r.useState(""),[A,Y]=r.useState(""),[Q,q]=r.useState(""),h=r.useRef(null),c=r.useRef(null),u=()=>{o&&console.log(`UiProvider handle confirm action ${Q}`),D(!1),h.current&&h.current(Q)},k=()=>{o&&console.log(`UiProvider handle cancel action ${Q}`),D(!1),c.current&&c.current(Q)},I=r.useCallback((P,O,X,me,ue)=>{o&&console.log(`UiProvider showConfirmCancelDialog for command ${X}`),S(P),Y(O),q(X),h.current=me,c.current=ue,D(!0)},[]),[N,H]=r.useState(!1),[ne,y]=r.useState(""),[p,d]=r.useState(""),[b,F]=r.useState(""),[_,$]=r.useState(""),[V,ie]=r.useState(localStorage.getItem(oe.installAutoExit)!=="false"),K=r.useCallback((P,O,X)=>{o&&console.log(`UiProvider show install progress for package ${P}`),y(P),d(O),F(X),H(!0)},[]),te=r.useCallback(P=>{o&&console.log(`UiProvider addInstallProgress: output ${P}`),$(O=>O+P+`
`)},[]),R=r.useCallback(()=>{o&&console.log(`UiProvider exitInstallProgressSuccess: package ${b}`),localStorage.getItem(oe.installAutoExit)!=="false"&&H(!1)},[b]),M=r.useCallback(()=>{o&&console.log(`UiProvider exitInstallProgressError: package ${b}`)},[b]),C=r.useCallback(()=>{o&&console.log("UiProvider hide install progress"),H(!1)},[]),W=()=>{o&&console.log("UiProvider handle install close action"),H(!1),F(""),$("")},T=r.useMemo(()=>({mobile:a,setMobile:l,currentPage:i,setCurrentPage:s,showSnackbarMessage:j,closeSnackbarMessage:x,closeSnackbar:g,showConfirmCancelDialog:I,showInstallProgress:K,exitInstallProgressSuccess:R,exitInstallProgressError:M,hideInstallProgress:C,addInstallProgress:te,installAutoExit:V,setInstallAutoExit:ie}),[a,i,l,s,j,x,g,I,K,R,M,C,te,V,ie]);return e.jsxs(Le.Provider,{value:T,children:[e.jsx(hn,{open:t,title:v,message:A,onConfirm:u,onCancel:k}),e.jsx(bn,{open:N,title:ne,_command:p,_packageName:b,output:_,onClose:W}),n]})}const jr=r.createContext(null),ve=r.createContext(null);function yn({children:n}){const[a,l]=r.useState([]),[i,s]=r.useState(localStorage.getItem(oe.logFilterLevel)??"info"),[m,g]=r.useState(localStorage.getItem(oe.logFilterSearch)??"*"),[x,j]=r.useState(!1),{showSnackbarMessage:t,closeSnackbarMessage:D,closeSnackbar:v,showInstallProgress:S,hideInstallProgress:A,exitInstallProgressSuccess:Y,exitInstallProgressError:Q,addInstallProgress:q}=r.useContext(Le),h=r.useRef([]),c=r.useRef(null),u=r.useRef(1),k=r.useRef(Math.floor(Math.random()*999e3)+1e3),I=r.useRef(null),N=r.useRef(null),H=r.useRef(null),ne=r.useRef(i),y=r.useRef(m),p=r.useRef(0),d=r.useRef(null),b=r.useRef(Number(localStorage.getItem(oe.logLength)??200)),F=r.useRef(localStorage.getItem(oe.logAutoScroll)!=="false"),_=r.useMemo(()=>window.location.href.replace(/^http/,"ws"),[]),$=100,V=60,ie=50,K=300,te=10;r.useEffect(()=>(o&&console.log("WebSocket messages started counter interval"),d.current=setInterval(()=>{p.current>0&&(o&&console.log(`WebSocket messages received in the last ${te} seconds: ${p.current*(60/te)} messages/minute`),p.current=0)},te*1e3),()=>{o&&console.log("WebSocket messages stopped counter interval"),d.current&&clearInterval(d.current),d.current=null}),[]),r.useEffect(()=>{ne.current=i},[i]),r.useEffect(()=>{y.current=m},[m]);const R=r.useCallback(()=>Math.floor(Math.random()*999e3)+1e3,[]),M=r.useCallback((J,f)=>{o&&console.log(`WebSocket filterLogMessages called with level "${J}" and search "${f}"...`),l(pe=>pe.filter(Z=>!(["debug","info","notice","warn","error","fatal"].includes(Z.level)&&(J==="info"&&Z.level==="debug"||J==="notice"&&(Z.level==="debug"||Z.level==="info")||J==="warn"&&(Z.level==="debug"||Z.level==="info"||Z.level==="notice")||J==="error"&&(Z.level==="debug"||Z.level==="info"||Z.level==="notice"||Z.level==="warn")||J==="fatal"&&(Z.level==="debug"||Z.level==="info"||Z.level==="notice"||Z.level==="warn"||Z.level==="error"))||f!=="*"&&f!==""&&!f.startsWith("/")&&!f.endsWith("/")&&!Z.message.toLowerCase().includes(f.toLowerCase())&&!Z.name.toLowerCase().includes(f.toLowerCase())||f.startsWith("/")&&f.endsWith("/")&&(()=>{try{const L=new RegExp(f.slice(1,-1),"i");return!L.test(Z.message)&&!L.test(Z.name)}catch(L){return console.error(`WebSocket log search invalid regex filter "${f}":`,L),!1}})())))},[]),C=r.useCallback(J=>{if(c.current&&c.current.readyState===WebSocket.OPEN)try{o&&console.log(`WebSocket sending message with id ${J.id}:`,J),J.id===void 0&&(J.id=k.current);const f=JSON.stringify(J);c.current.send(f),o&&console.log("WebSocket sent message:",J)}catch(f){o&&console.error(`WebSocket error sending message: ${f}`)}else o&&console.error("WebSocket message not sent, WebSocket not connected:",J)},[]),W=r.useCallback((J,f)=>{l(pe=>[...pe,{level:J,time:"",name:"",message:f}])},[]),T=r.useCallback((J,f)=>{o&&console.log(`WebSocket addListener id ${f}:`,J),(f==null||isNaN(f)||f===0)&&console.error("WebSocket addListener called without id, listener not added:",J),h.current=[...h.current,{listener:J,id:f}],o&&console.log("WebSocket addListener total listeners:",h.current.length)},[]),P=r.useCallback(J=>{o&&console.log("WebSocket removeListener:",J),h.current=h.current.filter(f=>f.listener!==J),o&&console.log("WebSocket removeListener total listeners:",h.current.length)},[]),O=r.useCallback(()=>{_===""||_===null||_===void 0||(W("WebSocket",`Connecting ${at?"with password":""} to WebSocket: ${_}`),o&&console.log(`WebSocket connecting to: ${_}${at?"?password=[redacted]":""}`),c.current=new WebSocket(_+(at?`?password=${encodeURIComponent(at)}`:"")),c.current.onmessage=J=>{x||j(!0),p.current+=1;try{const f=JSON.parse(J.data);if(f.id===void 0||f.src===void 0||f.dst===void 0){o&&console.error("WebSocket undefined message id/src/dst:",f);return}if(f.src!=="Matterbridge"||f.dst!=="Frontend"){o&&console.error("WebSocket invalid message src/dst:",f);return}if(f.error){o&&console.error("WebSocket error message response:",f);return}if(f.id===k.current&&f.method==="pong"&&f.response==="pong"){o&&console.log(`WebSocket pong response message id ${f.id}:`,f),N.current&&clearTimeout(N.current),N.current=null;return}else if(f.method==="snackbar"&&f.response&&f.response.message){o&&console.log(`WebSocket message id ${f.id} method ${f.method}:`,f),t(f.response.message,f.response.timeout,f.response.severity);return}else if(f.method==="close_snackbar"&&f.response&&f.response.message){o&&console.log(`WebSocket message id ${f.id} method ${f.method}:`,f),D(f.response.message);return}else if(f.method==="log"){if(!f.response||!f.response.level||!f.response.time||!f.response.name||!f.response.message||(f.response.level==="spawn"&&(f.response.name==="Matterbridge:spawn-init"?S(f.response.message,"",""):f.response.name==="Matterbridge:spawn-exit-success"?Y():f.response.name==="Matterbridge:spawn-exit-error"?Q():q(f.response.message+`
`)),["debug","info","notice","warn","error","fatal"].includes(f.response.level)&&(ne.current==="info"&&f.response.level==="debug"||ne.current==="notice"&&(f.response.level==="debug"||f.response.level==="info")||ne.current==="warn"&&(f.response.level==="debug"||f.response.level==="info"||f.response.level==="notice")||ne.current==="error"&&(f.response.level==="debug"||f.response.level==="info"||f.response.level==="notice"||f.response.level==="warn")||ne.current==="fatal"&&(f.response.level==="debug"||f.response.level==="info"||f.response.level==="notice"||f.response.level==="warn"||f.response.level==="error")))||y.current!=="*"&&y.current!==""&&!y.current.startsWith("/")&&!y.current.endsWith("/")&&!f.response.message.toLowerCase().includes(y.current.toLowerCase())&&!f.response.name.toLowerCase().includes(y.current.toLowerCase())||y.current.startsWith("/")&&y.current.endsWith("/")&&(()=>{try{const Z=new RegExp(y.current.slice(1,-1),"i");return!Z.test(f.response.message)&&!Z.test(f.response.name)}catch(Z){return console.error(`WebSocket log search invalid regex filter "${y.current}":`,Z),!1}})()||f.response.name==="Commissioning"&&f.response.message.includes("is uncommissioned"))return;l(Z=>{const L=[...Z,{level:f.response.level,time:f.response.time,name:f.response.name,message:f.response.message}];return o&&console.log(`WebSocket new log message added (${L.length}/${b.current}):`,L[L.length-1]),L.length>b.current+b.current*10/100?(o&&console.log(`WebSocket sliced log messages to the last ${b.current} entries`),L.slice(L.length-b.current)):L})}else{if(o&&console.log(`WebSocket received message id ${f.id} method ${f.method}:`,f),f.id===0)h.current.forEach(pe=>pe.listener(f));else{const pe=h.current.find(Z=>Z.id===f.id);pe?pe.listener(f):console.warn(`WebSocket no listener found for message id ${f.id}:`,f)}return}}catch(f){console.error(`WebSocket error parsing message: ${f}`,f instanceof Error?f.stack:null)}},c.current.onopen=()=>{o&&console.log(`WebSocket: Connected to WebSocket: ${_}`),W("WebSocket",`Connected to WebSocket: ${_}`),j(!0),v(),u.current=1,H.current=setTimeout(()=>{I.current=setInterval(()=>{C({id:k.current,method:"ping",src:"Frontend",dst:"Matterbridge",params:{}}),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{o&&console.error(`WebSocketUse: No pong response received from WebSocket: ${_}`),W("WebSocket",`No pong response received from WebSocket: ${_}`),j(!1)},1e3*ie)},1e3*V)},1e3*K)},c.current.onclose=()=>{o&&console.error(`WebSocket: Disconnected from WebSocket ${mt?"with Ingress":""}: ${_}`),W("WebSocket",`Disconnected from WebSocket: ${_}`),j(!1),v(),A(),H.current&&clearTimeout(H.current),N.current&&clearTimeout(N.current),I.current&&clearInterval(I.current),W("WebSocket",`Reconnecting (attempt ${u.current} of ${$}) to WebSocket${mt?" (Ingress)":""}: ${_}`),mt?setTimeout(X,5e3):u.current===1?X():u.current<$?setTimeout(X,1e3*u.current):W("WebSocket",`Reconnect attempts exceeded limit of ${$} retries, refresh the page to reconnect to: ${_}`),u.current=u.current+1},c.current.onerror=J=>{o&&console.error(`WebSocket: WebSocket error connecting to ${_}:`,J),W("WebSocket",`WebSocket error connecting to ${_}`)})},[_]),X=r.useCallback(()=>{o&&console.log(`WebSocket attemptReconnect ${u.current}/${$} to:`,_),O()},[O]);r.useEffect(()=>(O(),()=>{c.current&&c.current.readyState===WebSocket.OPEN&&c.current.close()}),[O]);const me=r.useMemo(()=>({messages:a,logLength:b,logAutoScroll:F,logFilterLevel:i,logFilterSearch:m,setMessages:l,setLogFilterLevel:s,setLogFilterSearch:g,filterLogMessages:M}),[a,b,F,i,m,l,s,g,M]),ue=r.useMemo(()=>({logLength:b,logAutoScroll:F,logFilterLevel:i,logFilterSearch:m,setMessages:l,setLogFilterLevel:s,setLogFilterSearch:g,filterLogMessages:M,online:x,retry:u.current,getUniqueId:R,addListener:T,removeListener:P,sendMessage:C,logMessage:W}),[b,F,l,s,g,x,u.current,T,P,C,W]);return e.jsx(jr.Provider,{value:me,children:e.jsx(ve.Provider,{value:ue,children:n})})}function jn(n){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 296.2 296.2",...n,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"lg1",x1:"16.6",y1:"16.6",x2:"279.6",y2:"279.6",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#00b48d"}),e.jsx("stop",{offset:".1",stopColor:"#3faa77"}),e.jsx("stop",{offset:".3",stopColor:"#234148"}),e.jsx("stop",{offset:".7",stopColor:"#203b44"}),e.jsx("stop",{offset:".9",stopColor:"#ad2e6e"}),e.jsx("stop",{offset:"1",stopColor:"#c81b74"})]}),e.jsxs("linearGradient",{id:"lg2",x1:"31.1",y1:"31.1",x2:"265.1",y2:"265.1",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#00b48d"}),e.jsx("stop",{offset:".2",stopColor:"#285251"}),e.jsx("stop",{offset:".4",stopColor:"#234148"}),e.jsx("stop",{offset:".8",stopColor:"#203b44"}),e.jsx("stop",{offset:".9",stopColor:"#a8316c"}),e.jsx("stop",{offset:"1",stopColor:"#c81b74"})]}),e.jsxs("linearGradient",{id:"lg3",x1:"116.2",y1:"143.9",x2:"139.8",y2:"143.9",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#8bc751"}),e.jsx("stop",{offset:"1",stopColor:"#0db14b"})]}),e.jsx("linearGradient",{id:"lg4",x1:"136.1",y1:"100.8",x2:"159.6",y2:"100.8",xlinkHref:"#lg3"}),e.jsx("linearGradient",{id:"lg5",x1:"155.3",y1:"143.9",x2:"178.9",y2:"143.9",xlinkHref:"#lg3"}),e.jsxs("linearGradient",{id:"lg6",x1:"46.8",y1:"25.7",x2:"89.6",y2:"74.8",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#b1d34a"}),e.jsx("stop",{offset:"1",stopColor:"#50b848"})]})]}),e.jsx("rect",{width:"296.2",height:"296.2",rx:"56.7",ry:"56.7",style:{fill:"url(#lg1)"}}),e.jsx("rect",{x:"16.3",y:"16.3",width:"263.6",height:"263.6",rx:"50.5",ry:"50.5",style:{fill:"url(#lg2)"}}),e.jsx("circle",{cx:"128",cy:"143.9",r:"11.8",style:{fill:"url(#lg3)"}}),e.jsx("circle",{cx:"147.8",cy:"100.8",r:"11.8",style:{fill:"url(#lg4)"}}),e.jsx("path",{d:"m244.6 114.5.4-.5L160 33a17 17 0 0 0-24.7-.5l-86.4 83.3a15 15 0 0 0 9.2 26.9h19.3v-4.7l-13.7-12.7v-.1l83.7-80.8 84.2 81-13.9 12.8v4.5h19.5a15 15 0 0 0 7.4-28.1Z",style:{fill:"url(#lg3)"}}),e.jsx("circle",{cx:"167.1",cy:"143.9",r:"11.8",style:{fill:"url(#lg5)"}}),e.jsx("path",{fill:"#fff",d:"M219 89.3V35.5a10.5 10.5 0 1 0-21 0v33.7l21 20Z"}),e.jsx("path",{d:"M91.4 73.3H83a37 37 0 0 0-14.5-28.4L65 50.2c.1 0 12.6 9 11.7 25.4-5.3-.4-11.2-1.9-16.3-5.3-11.8-7.8-16-23.7-11.9-46 8.7 1.5 34 7 43 22.8 4.1 7.3 4.1 16.1 0 26.2Z",style:{fill:"url(#lg6)"}}),e.jsx("path",{d:"M65.9 80a49.6 49.6 0 0 0 17.8 2.2l16.6-16c1.6-8.3.5-15.7-3.3-22.4C84.6 22 47.8 17.5 46.2 17.4l-3-.4-.6 3c-3.8 18.4-5.9 50.6 23.2 60ZM48.4 24.4c8.7 1.5 34 7 43 22.8 4.1 7.3 4.1 16.1 0 26.2H83a37 37 0 0 0-14.5-28.4l-3.7 5.3c.1 0 12.6 9 11.7 25.4-5.3-.4-11.2-1.9-16.3-5.3-11.9-7.8-16-23.7-11.9-46Z",fill:"#1e5857"}),e.jsx("path",{fill:"#fff",d:"M250.5 90.5a17.4 17.4 0 1 1 0-34.8 17.4 17.4 0 0 1 0 34.8Zm0-22.7a5.4 5.4 0 0 0 0 10.7 5.3 5.3 0 0 0 0-10.7ZM258.8 148.2a15.9 15.9 0 0 0-9.6 28.5c-.8 4.2-5.4 4.6-5.4 4.6h-26v-43l13.6-13-1.8-2-82.2-79-81.2 78.3-2.5 2.6 13.7 13v42.9H53a21.5 21.5 0 1 0 11.7 15h12.6v18.8c0 7.8 6.4 14.1 14.1 14.1h29.3v14.8H64a10.6 10.6 0 0 0-17.7 8 10.6 10.6 0 0 0 17.6 8h157.6a16.3 16.3 0 1 0 0-16h-84.8V229h66.8c7.8 0 14.2-6.3 14.2-14.1v-19.2h27.6c14.3 0 17.8-12.8 18.5-16.6a15.9 15.9 0 0 0-5-30.9ZM43.7 210.8a10.3 10.3 0 1 1 0-20.6 10.3 10.3 0 0 1 0 20.6Zm192 36a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm-77-34.8h-22v-34h22v34Zm8.4-79.8c2.7 0 5.2 1 7.2 2.5v-10.4L188 137s2.6 1.3 4.6 1.3h6.7v68c0 3.2-2.6 5.7-5.7 5.7h-19v-34h1.4a7.5 7.5 0 0 0 0-15H120a7.5 7.5 0 0 0 0 15h.7v34h-19.3a5.7 5.7 0 0 1-5.7-5.6v-68.1h6.7c2 0 4.6-1.3 4.6-1.3l13.7-12.7v10.4a11.7 11.7 0 0 1 16 1.6v-13a14.9 14.9 0 0 0-25-10.8s-.1.2-.1.2l-.5.5-6.9 7H92.5l55-53.2 55.1 53.2h-11.8l-7-7c0-.2-.2-.3-.4-.5l-.2-.2a14.8 14.8 0 0 0-25 10.9v12.9c2.2-2.5 5.3-4.1 8.9-4.1Zm91.7 36.7a4.9 4.9 0 1 1 0-9.7 4.9 4.9 0 0 1 0 9.7Z"})]})}function Oe(){const{retry:n}=r.useContext(ve),a=()=>{window.location.reload()};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh",justifyContent:"center",alignItems:"center",fontSize:"20px",color:"var(--main-text-color)",backgroundColor:"var(--main-bg-color)"},children:[e.jsx(jn,{style:{height:"128px",width:"128px",margin:"10px",marginBottom:"20px"}}),n<100?e.jsxs(e.Fragment,{children:[e.jsx(Qr,{style:{color:"var(--primary-color)"}}),e.jsx("div",{style:{marginTop:"20px",color:"var(--primary-color)",textAlign:"center"},children:e.jsxs("span",{children:["Reconnecting to Matterbridge ","(attempt "+n+")","..."]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginTop:"20px",color:"var(--primary-color)",textAlign:"center"},children:[e.jsx("span",{children:"Unable to connect to Matterbridge after multiple attempts."}),e.jsx("br",{}),e.jsx("span",{children:"Please check your network connection."}),e.jsx("br",{})]}),e.jsx(de,{variant:"contained",color:"primary",onClick:a,style:{marginTop:"20px"},children:"Refresh the Page"})]})]})}function Cr({value:n,maxChars:a}){let l=n;if(n.length>a&&a>3){const i=a-3,s=n.substring(0,Math.ceil(i/2)),m=n.substring(n.length-Math.floor(i/2),n.length);l=`${s} â€¦ ${m}`}return n!==l?e.jsx(E,{title:n,placement:"top",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[0,12]}}]}},children:e.jsx("span",{children:l})}):e.jsx("span",{children:l})}function Ce({children:n,style:a}){const l={display:"flex",flexDirection:"column",flex:"0 0 auto",width:"100%",overflow:"hidden",margin:"0px",padding:"0px",gap:"0px",backgroundColor:"var(--div-bg-color)",boxShadow:"5px 5px 10px var(--div-shadow-color)",border:"1px solid var(--table-border-color)",borderRadius:"var(--div-border-radius)",boxSizing:"border-box"};return e.jsx("div",{style:{...l,...a},children:n})}function De({children:n,style:a}){const l={display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",height:"30px",borderBottom:"1px solid var(--table-border-color)",color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color)",margin:"0px",padding:"0px",boxSizing:"border-box"};return e.jsx("div",{style:{...l,...a},children:n})}function Se({children:n,style:a}){const l={color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color)",fontSize:"16px",fontWeight:"bold",margin:"0px",padding:"5px 10px"};return e.jsx("div",{style:{...l,...a},children:n})}function gt({children:n,style:a}){const l={display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",height:"30px",color:"var(--footer-text-color)",backgroundColor:"var(--footer-bg-color)",margin:"0px",padding:"0px",boxSizing:"border-box"};return e.jsx("div",{style:{...l,...a},children:n})}function lt({children:n,style:a}){const l={color:"var(--footer-text-color)",backgroundColor:"var(--footer-bg-color)",fontSize:"14px",fontWeight:"bold",margin:"0px",padding:"5px 10px"};return e.jsx("div",{style:{...l,...a},children:n})}function pt({children:n,style:a}){const l={color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)",fontSize:"14px",fontWeight:"normal",margin:"0px",padding:"5px 10px"};return e.jsx("div",{style:{...l,...a},children:n})}function Ne({children:n,style:a,onDragOver:l,onDragLeave:i,onDrop:s}){const m={flex:"0 0 auto",display:"flex",flexDirection:"row",overflow:"hidden",alignItems:"start",justifyContent:"space-between",margin:"0px",padding:"10px",gap:"20px"};return e.jsx("div",{style:{...m,...a},onDragOver:l,onDragLeave:i,onDrop:s,children:n})}function Ze({children:n,style:a,close:l}){const i={display:"flex",flexDirection:"row",margin:"0px",padding:"0px",paddingRight:"10px",gap:"10px"};return e.jsxs("div",{style:{...i,...a},children:[n,Hi]})}function Cn({systemInfo:n,compact:a}){const{mobile:l}=r.useContext(Le),{addListener:i,removeListener:s,getUniqueId:m,sendMessage:g}=r.useContext(ve),[x,j]=r.useState(n),t=r.useRef(m());if(o&&console.log("SystemInfoTable loading with systemInfo:",x,"compact:",a),n&&a&&x.totalMemory&&x.freeMemory){const h=x.totalMemory,c=x.freeMemory;x.freeMemory=`${c} / ${h}`,x.totalMemory=""}if(n&&a&&x.heapTotal&&x.heapUsed){const h=x.heapTotal,c=x.heapUsed;x.heapUsed=`${c} / ${h}`,x.heapTotal=""}if(n&&a&&x.osRelease&&x.osType){const h=x.osType,c=x.osRelease;x.osType=`${h} (${c})`,x.osRelease=""}if(n&&a&&x.osArch&&x.osPlatform){const h=x.osPlatform,c=x.osArch;x.osPlatform=`${h} (${c})`,x.osArch=""}const D=(h,c,u,k,I)=>{j(N=>({...N,totalMemory:h,freeMemory:c,heapTotal:u,heapUsed:k,rss:I}))},v=h=>{j(c=>({...c,cpuUsage:h.toFixed(2)+" %"}))},S=h=>{j(c=>({...c,processCpuUsage:h.toFixed(2)+" %"}))},A=(h,c)=>{j(u=>({...u,systemUptime:h,processUptime:c}))},Y=()=>{o&&console.log("SystemInfoTable handleViewHistory clicked"),g({id:t.current,sender:"Header",method:"/api/viewhistorypage",src:"Frontend",dst:"Matterbridge",params:{}})};r.useEffect(()=>{const h=c=>{o&&console.log("SystemInfoTable received WebSocket Message:",c),c.method==="memory_update"&&c.response&&c.response.totalMemory&&c.response.freeMemory&&c.response.heapTotal&&c.response.heapUsed&&c.response.rss?(o&&console.log("SystemInfoTable received memory_update",c),D(c.response.totalMemory,c.response.freeMemory,c.response.heapTotal,c.response.heapUsed,c.response.rss)):c.method==="cpu_update"&&c.response&&c.response.cpuUsage?(o&&console.log("SystemInfoTable received cpu_update",c),v(c.response.cpuUsage),S(c.response.processCpuUsage)):c.method==="uptime_update"&&c.response&&c.response.systemUptime&&c.response.processUptime?(o&&console.log("SystemInfoTable received uptime_update",c),A(c.response.systemUptime,c.response.processUptime)):c.method==="/api/viewhistorypage"&&c.id===t.current&&c.success===!0&&(o&&console.log("SystemInfoTable received /api/viewhistorypage success"),window.open("./api/viewhistory","_blank","noopener,noreferrer"))};return i(h,t.current),o&&console.log(`SystemInfoTable added WebSocket listener id ${t.current}`),()=>{s(h),o&&console.log("SystemInfoTable removed WebSocket listener")}},[i,s]);const[Q,q]=r.useState(!1);return!x||Q?null:(o&&console.log("SystemInfoTable rendering..."),e.jsxs(Ce,{style:xe&&l?{flex:"1 1 300px"}:{flex:"0 1 auto",width:"302px",minWidth:"302px"},children:[e.jsxs(De,{children:[e.jsx(Se,{children:"System info"}),e.jsx(Ze,{close:()=>q(!0),children:e.jsx(G,{size:"small",sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},onClick:Y,children:e.jsx(E,{title:"Open the cpu and memory usage page",arrow:!0,children:e.jsx(ce,{path:Fo,size:"22px"})})})})]}),e.jsx(Ne,{style:xe&&l?{flex:"1 1 auto",margin:"0px",padding:"0px",gap:"0px"}:{flex:"1 1 auto",overflow:"auto",margin:"0px",padding:"0px",gap:"0px"},children:e.jsxs("table",{style:{border:"none",borderCollapse:"collapse",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"60%"}})]}),e.jsx("tbody",{style:{border:"none",borderCollapse:"collapse"},children:Object.entries(x).filter(([h,c])=>c!==void 0&&c!=="").map(([h,c],u)=>e.jsxs("tr",{className:u%2===0?"table-content-even":"table-content-odd",style:{border:"none",borderCollapse:"collapse"},children:[e.jsx("td",{style:{border:"none",borderCollapse:"collapse",whiteSpace:"nowrap"},children:h.replace("interfaceName","Interface name").replace("macAddress","Mac address").replace("ipv4Address","IPv4 address").replace("ipv6Address","IPv6 address").replace("nodeVersion","Node version").replace("hostname","Hostname").replace("user","User").replace("osType","Os").replace("osPlatform","Platform").replace("freeMemory","Memory").replace("systemUptime","System uptime").replace("processUptime","Process uptime").replace("cpuUsage","Host CPU").replace("processCpuUsage","Process CPU").replace("rss","Rss").replace("heapUsed","Heap")}),e.jsx("td",{style:{border:"none",borderCollapse:"collapse",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:xe&&l?typeof c!="string"?c.toString():c:e.jsx(Cr,{value:typeof c!="string"?c.toString():c,maxChars:22})})]},h))})]})})]}))}const or=r.memo(Cn),nr={margin:"0px",padding:"0px",color:"var(--div-text-color)",transition:"color 0.2s ease","& svg":{display:"block"},"& svg path":{fill:"var(--div-text-color)",transition:"fill 0.2s ease"},"&:hover":{color:"var(--primary-color)"},"&:hover svg path":{fill:"var(--primary-color)"},"&:focus-visible":{outline:"2px solid var(--primary-color)",outlineOffset:"2px"}},wn=n=>{if(!n)return"";const a=n.toString().replace(/[^0-9]/g,"");if(a.length<5)return a;const l=a.slice(0,4),i=a.slice(4,7),s=a.slice(7,11);return[l,i,s].filter(Boolean).join("-")};function Sn({id:n}){const{online:a,sendMessage:l,addListener:i,removeListener:s,getUniqueId:m}=r.useContext(ve),[g,x]=r.useState(null),j=r.useRef(null),t=r.useRef(null),D=r.useRef(m()),{mobile:v,showConfirmCancelDialog:S}=r.useContext(Le);o&&console.log(`QRDiv loading with id = "${n}" storeId = "${j.current}" timeout = ${t.current} and  matter:`,g),r.useEffect(()=>{o&&console.log(`QRDiv id effect "${n}"`),j.current=n,t.current&&clearTimeout(t.current),t.current=null,n?(o&&console.log(`QRDiv id effect sending data request for storeId "${n}"`),l({id:D.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:n,server:!0}})):(o&&console.log("QRDiv id effect setting matter to null"),x(null))},[n,l]),r.useEffect(()=>{const c=u=>{o&&console.log("QRDiv received WebSocket Message:",u),u.method==="refresh_required"&&u.response.changed==="matter"&&u.response.matter&&(o&&console.log(`QRDiv received refresh_required: changed=${u.response.changed} for storeId "${u.response.matter.id}":`,u.response.matter),j.current===u.response.matter.id&&(o&&console.log(`QRDiv received refresh_required/matter: setting matter data for storeId "${u.response.matter.id}":`,u.response.matter),t.current&&clearTimeout(t.current),u.response.matter.advertising&&u.response.matter.advertiseTime&&u.response.matter.advertiseTime+9e5<=Date.now()&&(u.response.matter.advertising=!1),x(u.response.matter),u.response.matter.advertising&&(o&&console.log(`QRDiv setting matter advertise timeout for storeId "${u.response.matter.id}":`,u.response.matter.advertiseTime+9e5-Date.now()),t.current=setTimeout(()=>{t.current&&clearTimeout(t.current),o&&console.log(`QRDiv clearing advertising state for storeId "${j.current}" after 15 minutes`),x(k=>k&&{...k,advertising:!1})},u.response.matter.advertiseTime+9e5-Date.now()))))};return i(c,D.current),o&&console.log("QRDiv webSocket effect mounted"),()=>{s(c),t.current&&clearTimeout(t.current),t.current=null,o&&console.log("QRDiv webSocket effect unmounted")}},[i,s]);const A=()=>{o&&console.log(`QRDiv sent matter startCommission for node "${g?.id}"`),g&&l({id:D.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:g.id,startCommission:!0}})},Y=()=>{o&&console.log(`QRDiv sent matter stopCommission for node "${g?.id}"`),g&&l({id:D.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:g.id,stopCommission:!0}})},Q=()=>{o&&console.log(`QRDiv sent matter advertise for node "${g?.id}"`),g&&l({id:D.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:g.id,advertise:!0}})},q=c=>{o&&console.log(`QRDiv sent matter removeFabric for node "${g?.id}" and fabricIndex ${c}`),g&&l({id:D.current,sender:"QRDiv",method:"/api/matter",src:"Frontend",dst:"Matterbridge",params:{id:g.id,removeFabric:c}})},h=async()=>{if(!g||!g.manualPairingCode)return;const c=g.manualPairingCode.toString();try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(c);else{const u=document.createElement("textarea");u.value=c,u.style.position="fixed",u.style.opacity="0",document.body.appendChild(u),u.focus(),u.select(),document.execCommand("copy"),document.body.removeChild(u)}o&&console.log("Manual pairing code copied to clipboard")}catch(u){console.error("Failed to copy manual pairing code",u)}};return!g||!a?(o&&console.log("QRDiv rendering undefined state"),null):g.online?g.advertising&&g.qrPairingCode&&g.manualPairingCode?(o&&console.log("QRDiv rendering advertising state"),e.jsxs(Ce,{style:xe&&v?{flex:"1 1 300px",alignItems:"center"}:{alignItems:"center",width:"302px",minWidth:"302px"},children:[e.jsxs(De,{children:[e.jsx(Se,{children:"QR pairing code"}),e.jsxs(Ze,{children:[e.jsx(G,{"aria-label":"send advertising",size:"small",onClick:Q,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(E,{title:"Send again the mDNS advertisement",arrow:!0,children:e.jsx(ce,{path:Xt,size:"22px"})})}),e.jsx(G,{"aria-label":"stop pairing",size:"small",onClick:Y,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(E,{title:"Turn off pairing",arrow:!0,children:e.jsx(ce,{path:No,size:"22px"})})})]})]}),e.jsx(pt,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:j.current}),e.jsx(sn,{value:g.qrPairingCode,size:256,level:"M",fgColor:"var(--div-text-color)",bgColor:"var(--div-bg-color)",style:{margin:"20px"}}),e.jsxs(gt,{style:{justifyContent:"space-between"},children:[e.jsxs(lt,{style:{fontWeight:"normal",color:"var(--div-text-color)"},children:["Manual pairing code: ",wn(g.manualPairingCode)]}),e.jsx(Ze,{children:e.jsx(E,{title:"Copy manual pairing code",arrow:!0,children:e.jsx(G,{"aria-label":"copy manual pairing code",size:"small",onClick:h,sx:nr,children:e.jsx(ce,{path:Ro,size:.85})})})})]})]})):g.commissioned&&g.fabricInformations&&g.sessionInformations?(o&&console.log("QRDiv rendering commissioned state"),e.jsxs(Ce,{style:xe&&v?{flex:"1 1 300px",alignItems:"center"}:{alignItems:"center",width:"302px",minWidth:"302px",overflow:"hidden"},children:[e.jsxs(De,{children:[e.jsx(Se,{children:"Paired fabrics"}),e.jsxs(Ze,{children:[e.jsx(G,{"aria-label":"send advertising",size:"small",onClick:Q,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(E,{title:"Send again the mDNS advertisement",arrow:!0,children:e.jsx(ce,{path:Xt,size:"22px"})})}),e.jsx(G,{"aria-label":"start pairing",size:"small",onClick:A,sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},children:e.jsx(E,{title:"Turn on pairing",arrow:!0,children:e.jsx(ce,{path:er,size:"22px"})})})]})]}),e.jsx(pt,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:j.current}),e.jsx(Ne,{style:{flexDirection:"column",justifyContent:"flex-start",flex:"1 1 auto",overflow:"auto",padding:"0px 0px 10px 0px",gap:"0px"},children:g.fabricInformations.map((c,u)=>e.jsxs("div",{style:{margin:"0px",padding:"10px",gap:"0px",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)",textAlign:"left",fontSize:"14px"},children:[e.jsxs("div",{style:{marginLeft:"20px",marginBottom:"10px",display:"flex",flexDirection:"row",justifyContent:"space-between",gap:"20px",alignItems:"center"},children:[e.jsxs("p",{className:"status-blue",style:{margin:"0px",padding:"3px 10px",width:"200px",fontSize:"14px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)"},children:["Fabric: ",c.fabricIndex]}),e.jsx(E,{title:"Remove the fabric. You will also need to remove it from the controller.",arrow:!0,children:e.jsx(G,{"aria-label":"remove the fabric",size:"small",onClick:()=>S("Remove fabric","Are you sure you want to remove this fabric? You will also need to remove it from the controller.","RemoveFabric",()=>q(c.fabricIndex),()=>{}),sx:{...nr,padding:"2px"},children:e.jsx(ce,{path:_o,size:1})})})]}),e.jsxs("p",{style:{margin:"0px 20px 0px 20px",color:"var(--div-text-color)"},children:["Vendor: ",c.rootVendorId," ",c.rootVendorName]}),c.label!==""&&e.jsxs("p",{style:{margin:"0px 20px 0px 20px",color:"var(--div-text-color)"},children:["Label: ",c.label]}),e.jsxs("p",{style:{margin:"0px 20px 0px 20px",color:"var(--div-text-color)"},children:["Sessions: ",g.sessionInformations?g.sessionInformations.filter(k=>k.fabric?.fabricIndex===c.fabricIndex&&k.isPeerActive===!0).length:"0"," ","subscriptions: ",g.sessionInformations?g.sessionInformations.filter(k=>k.fabric?.fabricIndex===c.fabricIndex&&k.isPeerActive===!0&&k.numberOfActiveSubscriptions>0).length:"0"]})]},u))}),e.jsx(gt,{style:{justifyContent:"center"},children:e.jsxs(lt,{style:{fontWeight:"normal"},children:["Serial number: ",g.serialNumber]})})]})):!g.commissioned&&!g.advertising?(o&&console.log("QRDiv rendering not commissioned and not advertising state"),e.jsxs(Ce,{style:xe&&v?{flex:"1 1 300px",alignItems:"center"}:{alignItems:"center",width:"302px",minWidth:"302px"},children:[e.jsx(De,{children:e.jsx(Se,{children:"QR pairing code"})}),e.jsx(pt,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:j.current}),e.jsx(de,{onClick:A,endIcon:e.jsx(ce,{path:er,size:1}),style:{margin:"20px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:"Turn on pairing"}),e.jsx(gt,{style:{justifyContent:"center"},children:e.jsxs(lt,{style:{fontWeight:"normal"},children:["Serial number: ",g.serialNumber]})})]})):(o&&console.log("QRDiv rendering unknown state"),null):(o&&console.log("QRDiv rendering offline state"),e.jsxs(Ce,{style:xe&&v?{flex:"1 1 300px",alignItems:"center"}:{alignItems:"center",width:"302px",minWidth:"302px"},children:[e.jsx(De,{style:{height:"30px",justifyContent:"space-between"},children:e.jsx(Se,{children:"Server node"})}),e.jsx(pt,{style:{maxWidth:"280px",fontWeight:"bold",color:"var(--secondary-color)"},children:j.current}),e.jsx(pt,{style:{fontWeight:"bold"},children:"Server offline"}),e.jsx(gt,{style:{justifyContent:"center"},children:e.jsxs(lt,{style:{fontWeight:"normal"},children:["Serial number: ",g.serialNumber]})})]}))}const ir=r.memo(Sn),sr=["matterbridge-","matterbridge-plugin-template","matterbridge-dyson","matterbridge-irobot","matterbridge-tuya","matterbridge-mqtt","matterbridge-matter","matterbridge-security","matterbridge-automations","matterbridge-securitysystem"];function kn(){const{mobile:n,showSnackbarMessage:a}=r.useContext(Le),{logMessage:l,sendMessage:i,getUniqueId:s}=r.useContext(ve),[m,g]=r.useState("matterbridge-"),[x,j]=r.useState(!1),[t,D]=r.useState(null),v=r.useRef(s()),S=p=>{p.preventDefault(),j(!0)},A=()=>{j(!1)},Y=p=>{p.preventDefault(),j(!1);const d=p.dataTransfer.files[0];if(d){l("Plugins",`Installing package ${d.name}. Please wait...`);const b=new FormData;b.append("file",d),b.append("filename",d.name),fetch("./api/uploadpackage",{method:"POST",body:b}).then(F=>F.text()).then(F=>{l("Plugins",`Server response: ${F}`)}).catch(F=>{console.error("Error uploading plugin file:",F),l("Plugins",`Error installing package ${F}`)})}},Q=p=>{const d=p.target.files&&p.target.files[0];if(d){l("Plugins",`Uploading package ${d.name}`);const b=new FormData;b.append("file",d),b.append("filename",d.name),fetch("./api/uploadpackage",{method:"POST",body:b}).then(F=>F.text()).then(F=>{l("Plugins",`Server response: ${F}`)}).catch(F=>{console.error("Error uploading plugin file:",F),l("Plugins",`Error uploading package ${F}`)})}},q=()=>{if(sr.includes(m.split("@")[0])){a(`Installation of plugin "${m}" is blocked by the ignore list.`);return}i({id:v.current,sender:"InstallPlugins",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:m,restart:!1}})},h=()=>{i({id:v.current,sender:"InstallPlugins",method:"/api/uninstall",src:"Frontend",dst:"Matterbridge",params:{packageName:m}})},c=()=>{document.getElementById("file-upload")?.click()},u=()=>{if(sr.includes(m.split("@")[0])){a(`Addition of plugin "${m}" is blocked by the ignore list.`);return}i({id:v.current,sender:"InstallPlugins",method:"/api/addplugin",src:"Frontend",dst:"Matterbridge",params:{pluginNameOrPath:m}})},k=p=>{p.preventDefault(),console.log("Right-clicked Upload button")},I=p=>{p.preventDefault(),console.log("Right-clicked Add button")},N=p=>{D(p.currentTarget)},H=p=>{p!==""&&g(p),D(null)},[ne,y]=r.useState(!1);return o&&console.log("HomeInstallAddPlugins rendering..."),ne?null:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Se,{children:"Install plugins"}),e.jsx(Ze,{close:()=>y(!0)})]}),e.jsxs(Ne,{onDragOver:S,onDragLeave:A,onDrop:Y,style:xe&&n?{flexWrap:"wrap",alignItems:"center",gap:"10px"}:{flexWrap:"wrap",alignItems:"center",gap:"20px"},children:[e.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(be,{value:m,onChange:p=>{g(p.target.value)},size:"small",id:"plugin-name",label:"Plugin name or plugin path",variant:"outlined",fullWidth:!0}),e.jsx(G,{onClick:N,children:e.jsx(Kr,{})}),e.jsxs(st,{id:"simple-menu",anchorEl:t,keepMounted:!0,open:!!t,onClose:()=>H(""),children:[e.jsx(w,{onClick:()=>H("matterbridge-zigbee2mqtt"),children:"matterbridge-zigbee2mqtt"}),e.jsx(w,{onClick:()=>H("matterbridge-somfy-tahoma"),children:"matterbridge-somfy-tahoma"}),e.jsx(w,{onClick:()=>H("matterbridge-shelly"),children:"matterbridge-shelly"}),e.jsx(w,{onClick:()=>H("matterbridge-hass"),children:"matterbridge-hass"}),e.jsx(w,{onClick:()=>H("matterbridge-webhooks"),children:"matterbridge-webhooks"}),e.jsx(w,{onClick:()=>H("matterbridge-bthome"),children:"matterbridge-bthome"}),e.jsx(w,{onClick:()=>H("matterbridge-test"),children:"matterbridge-test"}),e.jsx(w,{onClick:()=>H("matterbridge-example-accessory-platform"),children:"matterbridge-example-accessory-platform"}),e.jsx(w,{onClick:()=>H("matterbridge-example-dynamic-platform"),children:"matterbridge-example-dynamic-platform"}),e.jsx(w,{onClick:()=>H("matterbridge-eve-door"),children:"matterbridge-eve-door"}),e.jsx(w,{onClick:()=>H("matterbridge-eve-motion"),children:"matterbridge-eve-motion"}),e.jsx(w,{onClick:()=>H("matterbridge-eve-energy"),children:"matterbridge-eve-energy"}),e.jsx(w,{onClick:()=>H("matterbridge-eve-weather"),children:"matterbridge-eve-weather"}),e.jsx(w,{onClick:()=>H("matterbridge-eve-room"),children:"matterbridge-eve-room"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[e.jsx(E,{title:"Install or update a plugin from npm",children:e.jsxs(de,{onClick:q,endIcon:e.jsx(Fe,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Install"]})}),e.jsx(E,{title:"Uninstall and remove a plugin",children:e.jsxs(de,{onClick:h,endIcon:e.jsx(gr,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Uninstall"]})}),e.jsx(E,{title:"Upload and install a plugin from a tarball",children:e.jsxs(de,{onClick:c,onContextMenu:k,endIcon:e.jsx(Gr,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Upload"]})}),e.jsx(E,{title:"Add an installed plugin",children:e.jsxs(de,{onClick:u,onContextMenu:I,endIcon:e.jsx(Mt,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px",minWidth:"90px"},children:[" ","Add"]})}),e.jsx("input",{id:"file-upload",type:"file",accept:".tgz",style:{display:"none"},onChange:Q})]})]})]})}const In=r.memo(kn);function et({status:n,enabledText:a="Enabled",disabledText:l=void 0,tooltipText:i=void 0,onClick:s}){if(n===void 0)return null;{const m=e.jsx("div",{className:n?"status-enabled":"status-disabled",style:{cursor:"default"},onClick:s,children:n?a:l??a});return i!==void 0?e.jsx(E,{title:i,children:m}):m}}function Mn({title:n,children:a}){const l=r.useRef(null),[i,s]=r.useState(!1),m=()=>{const j=l.current;if(!j){s(!1);return}s(j.scrollWidth>j.clientWidth)},g=()=>{s(!1)},x={display:"inline-block",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"};return e.jsx(E,{title:n,open:i,disableHoverListener:!0,disableFocusListener:!0,disableTouchListener:!0,slotProps:{tooltip:{sx:{fontSize:"14px",fontWeight:"normal",color:"#ffffff",backgroundColor:"var(--primary-color)"}}},children:e.jsx("span",{ref:l,onMouseEnter:m,onMouseLeave:g,style:x,children:a})})}function Dn(n,a,l){const i=n?.[l],s=a?.[l];return i==null&&s==null?0:i==null?-1:s==null?1:typeof i=="boolean"&&typeof s=="boolean"?i===s?0:i?1:-1:typeof i=="number"&&typeof s=="number"?i-s:String(i).localeCompare(String(s))}function Pn({name:n,title:a,columns:l,rows:i,getRowKey:s,footerLeft:m,footerRight:g,onRowClick:x}){const j=r.useRef(new WeakMap),t=r.useRef(1),D=d=>{if(typeof s=="string"&&d&&d[s]!=null)return d[s];if(typeof s=="function"){const _=s(d);if(_!=null)return _}const b=l?.[0]?.id;if(b&&d&&d[b]!=null)return d[b];console.warn(`MbfTable(${n}): using fallback stable row key; consider providing getRowKey prop for better React performance`);let F=j.current.get(d);return F||(F=`rk_${t.current++}`,j.current.set(d,F)),F},[v,S]=r.useState(localStorage.getItem(`${n}_table_order_by`)||null),[A,Y]=r.useState(localStorage.getItem(`${n}_table_order`)||null),[Q,q]=r.useState(!1),[h,c]=r.useState(()=>{try{const d=localStorage.getItem(`${n}_column_visibility`);if(d)return JSON.parse(d)}catch{}return{}}),u=r.useMemo(()=>{const d={};for(const b of l)b.hidden||(d[b.id]=b.required?!0:h[b.id]!==!1);return d},[l,h]),k=r.useMemo(()=>{if(!v||!A)return i;const d=l.find(F=>F.id===v);if(!d||d.noSort)return i;const b=i.map((F,_)=>({el:F,index:_}));return b.sort((F,_)=>{let $;return typeof d.comparator=="function"?$=d.comparator(F.el,_.el):$=Dn(F.el,_.el,v),$!==0?A==="asc"?$:-$:F.index-_.index}),b.map(F=>F.el)},[i,v,A,l]),I=d=>{if(v!==d||!v){S(d),Y("asc"),localStorage.setItem(`${n}_table_order_by`,d),localStorage.setItem(`${n}_table_order`,"asc");return}if(A==="asc"){Y("desc"),localStorage.setItem(`${n}_table_order`,"desc");return}S(null),Y(null),localStorage.removeItem(`${n}_table_order_by`),localStorage.removeItem(`${n}_table_order`)},N=()=>{q(!Q)},H=d=>{c(b=>{const F=l.find(V=>V.id===d);if(F&&F.required)return b;const _=u[d]!==!1,$={...b};_?$[d]=!1:delete $[d];try{localStorage.setItem(`${n}_column_visibility`,JSON.stringify($))}catch{}return $})},ne=()=>{c({});try{localStorage.removeItem(`${n}_column_visibility`)}catch{}q(!1)},[y,p]=r.useState(!1);return y?null:(o&&console.log(`Rendering table ${n}${v&&A?` ordered by ${v}:${A}`:""}`),e.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",margin:"0",padding:"0",gap:"0",width:"100%",height:"100%",overflow:"hidden"},children:[e.jsxs(He,{open:Q,onClose:(d,b)=>{b==="backdropClick"||b==="escapeKeyDown"||N()},disableEscapeKeyDown:!0,disableRestoreFocus:!0,children:[e.jsx(Ve,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:`Configure ${n} columns`})]})}),e.jsx(Ae,{children:e.jsx(Jr,{children:l.filter(d=>!d.hidden).map(d=>e.jsx(Ye,{control:e.jsx(Be,{disabled:!!d.required,checked:d.required?!0:u[d.id]!==!1,onChange:()=>H(d.id)}),label:d.label},d.id))})}),e.jsxs(Ge,{children:[e.jsx(de,{onClick:ne,children:"Reset"}),e.jsx(de,{variant:"contained",onClick:d=>{if(d?.currentTarget&&typeof d.currentTarget.blur=="function")try{d.currentTarget.blur()}catch{}const b=document.activeElement;if(b&&b instanceof HTMLElement&&typeof b.blur=="function")try{b.blur()}catch{}N()},children:"Close"})]})]}),e.jsxs(De,{style:{height:"30px",minHeight:"30px",justifyContent:"space-between",borderBottom:"none"},children:[e.jsx(Se,{children:n}),a&&e.jsx(Se,{children:a}),e.jsx(Ze,{close:()=>p(!0),children:e.jsx(G,{size:"small",sx:{color:"var(--header-text-color)",margin:"0px",padding:"0px"},onClick:d=>{if(d?.currentTarget?.blur)try{d.currentTarget.blur()}catch{}N()},"aria-label":"Configure Columns",children:e.jsx(E,{title:`Configure ${n} columns`,children:e.jsx(ce,{path:Oo,size:"20px",color:"var(--header-text-color)"})})})})]}),e.jsx(Ne,{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",minHeight:0,width:"100%",overflow:"auto",margin:"0px",padding:"0px",gap:"0"},children:e.jsxs("table",{"aria-label":`${n} table`,style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{style:{position:"sticky",top:0,zIndex:10,border:"none",color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color"},children:e.jsx("tr",{style:{height:"30px",minHeight:"30px"},children:l.map(d=>{if(d.hidden||!d.required&&u[d.id]===!1)return null;const b=!d.noSort,F=b&&v===d.id&&!!A;return e.jsxs("th",{onClick:b?()=>I(d.id):void 0,style:{margin:"0",padding:"5px 10px",position:"sticky",top:0,minWidth:d.minWidth,maxWidth:d.maxWidth,textAlign:d.align||"left",cursor:b?"pointer":"default",border:"none",color:"var(--header-text-color)",backgroundColor:"var(--header-bg-color)",whiteSpace:d.maxWidth?"nowrap":void 0,overflow:d.maxWidth?"hidden":void 0,textOverflow:d.maxWidth?"ellipsis":void 0},"aria-sort":b?F?A==="asc"?"ascending":"descending":"none":void 0,children:[d.label,F&&e.jsxs("span",{style:{marginLeft:6},children:[A==="asc"&&e.jsx(ce,{path:Eo,size:"15px"}),A==="desc"&&e.jsx(ce,{path:Ho,size:"15px"})]})]},d.id)})})}),e.jsx("tbody",{children:k.map((d,b)=>{const F=D(d);return e.jsx("tr",{className:b%2===0?"table-content-even":"table-content-odd",onClick:x?_=>x(d,F,_):void 0,style:{height:"30px",minHeight:"30px",border:"none",borderCollapse:"collapse",cursor:x?"pointer":void 0},children:l.map(_=>{if(_.hidden||!_.required&&u[_.id]===!1)return null;const $=d[_.id],V=typeof _.render=="function"?_.render($,F,d,_):typeof $=="boolean"?e.jsx(Be,{checked:$,disabled:!0,size:"small",sx:{m:0,p:0,color:"var(--table-text-color)","&.Mui-disabled":{color:"var(--table-text-color)",opacity:.7}}}):_.format&&typeof $=="number"?_.format($):$!=null?String($):null,K=!!_.tooltip&&_.maxWidth!==void 0&&_.maxWidth!==null&&$!==void 0&&$!==null&&V!==null?e.jsx(Mn,{title:String($),children:V}):V;return e.jsx("td",{style:{border:"none",borderCollapse:"collapse",textAlign:_.align||"left",padding:"5px 10px",margin:"0",maxWidth:_.maxWidth,whiteSpace:_.maxWidth?"nowrap":void 0,overflow:_.maxWidth?"hidden":void 0,textOverflow:_.maxWidth?"ellipsis":void 0},children:K},_.id)})},F)})})]})}),(m||g)&&e.jsxs(gt,{style:{height:"30px",minHeight:"30px",justifyContent:"space-between",border:"none"},children:[e.jsx(lt,{style:{fontSize:"14px",fontWeight:"normal",color:"var(--secondary-color)"},children:m}),e.jsx(lt,{style:{fontSize:"14px",fontWeight:"normal",color:"var(--secondary-color)"},children:g})]})]}))}function Ln(n){return r.memo(n)}const Tt=Ln(Pn);function lr(n){return n.id!==0&&n.src==="Matterbridge"&&n.dst==="Frontend"}const tt={fontSize:"16px",fontWeight:"bold",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},rt={fontSize:"12px",fontWeight:"normal",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},$n={fontSize:"14px",fontWeight:"normal",color:"var(--secondary-color)",backgroundColor:"var(--div-bg-color)"},Tn={fontSize:"16px",fontWeight:"bold",backgroundColor:"var(--div-bg-color)"},qe={padding:"0px",margin:"0px"},Wn="5px 10px 5px 10px",wt={},Ie={},St={},kt={};let ot=[],_t=[];const Fn=({open:n,onClose:a,plugin:l})=>{const{sendMessage:i,addListener:s,removeListener:m,getUniqueId:g}=r.useContext(ve),x=r.useRef(g()),[j,t]=r.useState(l.configJson),[D,v]=r.useState(null),[S,A]=r.useState({"ui:submitButtonOptions":{submitText:"Confirm"},"ui:globalOptions":{orderable:!0}}),[Y,Q]=r.useState("");let q={};r.useEffect(()=>{const W=T=>{T.src==="Matterbridge"&&T.dst==="Frontend"&&(lr(T)&&T.id===x.current&&T.method==="/api/select/devices"&&T.response&&(o&&console.log(`ConfigPluginDialog (id: ${T.id}) received ${T.response.length} /api/select/devices:`,T.response),ot=T.response),lr(T)&&T.id===x.current&&T.method==="/api/select/entities"&&T.response&&(o&&console.log(`ConfigPluginDialog (id: ${T.id}) received ${T.response.length} /api/select/entities:`,T.response),_t=T.response))};return s(W,x.current),o&&console.log("ConfigPluginDialog added WebSocket listener id:",x.current),j&&D&&D.properties&&(Object.keys(D.properties).forEach(T=>{Object.keys(D.properties[T]).forEach(P=>{P.startsWith("ui:")&&(S[T]={},S[T][P]=D.properties[T][P],delete D.properties[T][P])})}),A(S)),l.name&&l.configJson&&l.schemaJson&&(t(l.configJson),v(l.schemaJson),i({id:x.current,sender:"ConfigPlugin",method:"/api/select/devices",src:"Frontend",dst:"Matterbridge",params:{plugin:l.name}}),i({id:x.current,sender:"ConfigPlugin",method:"/api/select/entities",src:"Frontend",dst:"Matterbridge",params:{plugin:l.name}}),o&&console.log('HomePlugins sent "/api/select/devices" and "/api/select/entities" for plugin:',l.name)),()=>{m(W),o&&console.log("ConfigPluginDialog removed WebSocket listener")}},[s,j,l,m,D,i,S]);const h=(W,T)=>{q=W.formData},c=W=>{o&&console.log("ConfigPluginDialog handleSaveChanges:",W.formData),t(W.formData),l.configJson=W.formData,l.restartRequired=!0,i({id:x.current,sender:"ConfigPlugin",method:"/api/savepluginconfig",src:"Frontend",dst:"Matterbridge",params:{pluginName:W.formData.name,formData:W.formData}}),a()};function u(W){const{id:T,label:P,onKeyChange:O,onDropPropertyClick:X,disabled:me,schema:ue,children:J,registry:f,readonly:pe,required:Z}=W,{templates:L}=f,{RemoveButton:je}=L.ButtonTemplates;if(!(mn in ue))return e.jsx(ae,{sx:{display:"flex",flexDirection:"column",flexGrow:1,padding:0,margin:0,border:"none"},children:J});const ye=({target:se})=>O(se&&se.value);return e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",flexGrow:1,padding:0,margin:0,border:"none"},children:[e.jsx(be,{id:`${T}-key`,name:`${T}-key`,required:Z,disabled:me||pe,defaultValue:P,onBlur:pe?void 0:ye,type:"text",variant:"outlined",sx:{width:"250px",minWidth:"250px",maxWidth:"250px",marginRight:"20px"}}),e.jsx(ae,{sx:{flex:1},children:J}),e.jsx(je,{disabled:me||pe,onClick:X(P),registry:f})]})}function k(W){const{children:T,description:P,displayLabel:O,errors:X,help:me,hidden:ue,registry:J,uiSchema:f}=W,pe=un(f),Z=gn("WrapIfAdditionalTemplate",J,pe);return ue?e.jsx("div",{style:{display:"none"},children:T}):e.jsx(ae,{sx:{display:"flex",flexDirection:"column",flexGrow:1,padding:0,margin:0,border:"none"},children:e.jsxs(Z,{...W,children:[O===!0&&P,T,X,me]})})}function I(W){const{description:T}=W;return T?e.jsx(he,{sx:rt,children:T}):null}function N(W){const{required:T,title:P}=W;return P?e.jsx(ae,{sx:{padding:"0px",margin:"0px",marginTop:"5px"},children:e.jsxs(he,{sx:tt,children:["Title ",P," ",T&&e.jsx("mark",{children:"***"})]})}):null}function H(W){const{help:T}=W;return T?e.jsx(ae,{sx:{padding:"0px",margin:"0px",marginTop:"5px"},children:e.jsx(he,{sx:$n,children:T})}):null}function ne(W){const{errors:T}=W;return T?e.jsxs(ae,{sx:{padding:"10px",margin:"10px",border:"1px solid grey"},children:[e.jsx(he,{color:"error",sx:Tn,children:"Please fix the following errors:"}),e.jsx(dt,{children:T.map((P,O)=>e.jsxs(Zr,{children:[e.jsx(B,{children:e.jsx(Yr,{color:"error"})}),e.jsx(re,{primary:P.stack})]},O))})]}):null}function y(W){const{errors:T}=W;return T?e.jsx(ae,{sx:{padding:"0px",margin:"0px",marginTop:"5px"},children:T.map((P,O)=>e.jsxs(he,{color:"error",variant:"body2",sx:{marginLeft:1},children:["This field ",P]},O))}):null}function p(W){const{id:T,name:P,_schema:O,_uiSchema:X,value:me,options:ue,label:J,type:f,placeholder:pe,required:Z,disabled:L,readonly:je,autofocus:Re,onChange:ye,onChangeOverride:se,onBlur:ge,onFocus:Ee,_rawErrors:Me,_hideError:ct,_registry:U,_formContext:ke}=W,z=({target:{value:Te}})=>ye(Te===""?ue.emptyValue:Te),le=({target:Te})=>ge(T,Te&&Te.value),$e=({target:Te})=>Ee(T,Te&&Te.value);return e.jsx(ae,{sx:{padding:"0px",margin:"0px"},children:e.jsx(be,{id:T,name:T,label:pe&&pe!==""?J:void 0,variant:"outlined",placeholder:pe&&pe!==""?pe:J,required:Z,disabled:L||je,autoFocus:Re,value:me||me===0?me:"",type:f,autoComplete:f==="password"?"current-password":P,onChange:se||z,onBlur:le,onFocus:$e,fullWidth:!0})})}function d(W){return console.log("ArrayFieldTitleTemplate:",W),null}function b(W){return console.log("ArrayFieldDescriptionTemplate:",W),null}function F(W){return console.log("ArrayFieldItemTemplate:",W),null}function _(W){const{canAdd:T,onAddClick:P,schema:O,title:X}=W,[me,ue]=r.useState(!1),[J,f]=r.useState(!1),[pe,Z]=r.useState(!1),[L,je]=r.useState(""),Re=U=>{je(U.target.value)},ye=()=>{o&&console.log("ArrayFieldTemplate: handleDialogDeviceToggle filter:",L,"selectDevices:",ot),ue(!me)},se=()=>{o&&console.log("ArrayFieldTemplate: handleDialogEntityToggle filter:",L,"selectEntities:",_t),f(!J)},ge=()=>{o&&console.log("ArrayFieldTemplate: handleDialogDeviceEntityToggle filter:",L,"selectDevices:",ot),Z(!pe)},Ee=U=>{ue(!1),O.selectFrom==="serial"?O.items.default=U.serial:O.selectFrom==="name"&&(O.items.default=U.name),P()},Me=U=>{f(!1),O.selectEntityFrom==="name"?O.items.default=U.name:O.selectEntityFrom==="description"&&(O.items.default=U.description),P()},ct=U=>{Z(!1),O.selectDeviceEntityFrom==="name"?O.items.default=U.name:O.selectDeviceEntityFrom==="description"&&(O.items.default=U.description),P()};return e.jsxs(ae,{sx:{margin:"0px",padding:"5px 10px 5px 10px",border:"1px solid grey"},children:[X&&e.jsxs(ae,{sx:{margin:"0px",padding:"0px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[X&&e.jsx(he,{sx:tt,children:X}),T&&e.jsxs(ae,{sx:{margin:"0px",padding:"0px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[O.selectFrom&&e.jsx(E,{title:"Add a device from the list",children:e.jsx(G,{onClick:ye,size:"small",color:"primary",sx:qe,children:e.jsx(xt,{})})}),O.selectEntityFrom&&e.jsx(E,{title:"Add an entity from the list",children:e.jsx(G,{onClick:se,size:"small",color:"primary",sx:qe,children:e.jsx(xt,{})})}),O.selectDeviceEntityFrom&&e.jsx(E,{title:"Add a device entity from the list",children:e.jsx(G,{onClick:ge,size:"small",color:"primary",sx:qe,children:e.jsx(xt,{})})}),e.jsx(E,{title:"Add a new item",children:e.jsx(G,{onClick:P,size:"small",color:"primary",sx:qe,children:e.jsx(Mt,{})})})]})]}),O.description&&e.jsx(he,{sx:rt,children:O.description}),W.items.map(U=>e.jsxs(ae,{sx:{margin:"2px 0px",padding:"0px",display:"flex",alignItems:"center"},children:[e.jsx(ae,{sx:{flexGrow:1,marginRight:"10px"},children:U.children}),e.jsx(G,{disabled:!U.hasMoveUp,onClick:U.onReorderClick(U.index,U.index-1),size:"small",color:"primary",sx:qe,children:e.jsx(Kt,{})}),e.jsx(G,{disabled:!U.hasMoveDown,onClick:U.onReorderClick(U.index,U.index+1),size:"small",color:"primary",sx:qe,children:e.jsx(Qt,{})}),e.jsx(G,{onClick:U.onDropIndexClick(U.index),size:"small",color:"primary",sx:qe,children:e.jsx(Ht,{})})]},U.index)),e.jsxs(He,{open:me,onClose:ye,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsx(Ve,{children:"Select a device"}),e.jsxs(Ae,{children:[e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(he,{variant:"subtitle1",sx:{whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(be,{fullWidth:!0,variant:"outlined",value:L,onChange:Re,placeholder:"Enter serial or name"})]}),e.jsx(dt,{dense:!0,children:ot.filter(U=>U.serial.toLowerCase().includes(L.toLowerCase())||U.name.toLowerCase().includes(L.toLowerCase())).map((U,ke)=>e.jsxs(bt,{onClick:()=>Ee(U),sx:wt,children:[U.icon==="wifi"&&e.jsx(B,{children:e.jsx(ut,{style:Ie})}),U.icon==="ble"&&e.jsx(B,{children:e.jsx(vt,{style:Ie})}),U.icon==="hub"&&e.jsx(B,{children:e.jsx(yt,{style:Ie})}),e.jsx(re,{primary:U.name,secondary:U.serial,primaryTypographyProps:{style:St},secondaryTypographyProps:{style:kt}})]},ke))})]}),e.jsx(Ge,{children:e.jsx(de,{onClick:ye,children:"Close"})})]}),e.jsxs(He,{open:J,onClose:se,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsx(Ve,{children:"Select an entity"}),e.jsxs(Ae,{children:[e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(he,{variant:"subtitle1",sx:{whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(be,{fullWidth:!0,variant:"outlined",value:L,onChange:Re,placeholder:"Enter name or description"})]}),e.jsx(dt,{dense:!0,children:_t.filter(U=>U.name.toLowerCase().includes(L.toLowerCase())||U.description.toLowerCase().includes(L.toLowerCase())).map((U,ke)=>e.jsxs(bt,{onClick:()=>Me(U),sx:wt,children:[U.icon==="wifi"&&e.jsx(B,{children:e.jsx(ut,{style:Ie})}),U.icon==="ble"&&e.jsx(B,{children:e.jsx(vt,{style:Ie})}),U.icon==="hub"&&e.jsx(B,{children:e.jsx(yt,{style:Ie})}),U.icon==="component"&&e.jsx(B,{children:e.jsx(Gt,{style:Ie})}),U.icon==="matter"&&e.jsx(B,{children:e.jsx(Jt,{style:Ie})}),e.jsx(re,{primary:U.name,secondary:U.description,primaryTypographyProps:{style:St},secondaryTypographyProps:{style:kt}})]},ke))})]}),e.jsx(Ge,{children:e.jsx(de,{onClick:se,children:"Close"})})]}),e.jsxs(He,{open:pe,onClose:ge,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsxs(Ve,{children:["Select an entity for ",X]}),e.jsx(Ae,{children:e.jsx(dt,{dense:!0,children:ot.filter(U=>U.serial===X||U.name===X).map(U=>U.entities?.map((ke,z)=>e.jsxs(bt,{onClick:()=>ct(ke),sx:wt,children:[ke.icon==="wifi"&&e.jsx(B,{children:e.jsx(ut,{style:Ie})}),ke.icon==="ble"&&e.jsx(B,{children:e.jsx(vt,{style:Ie})}),ke.icon==="hub"&&e.jsx(B,{children:e.jsx(yt,{style:Ie})}),ke.icon==="component"&&e.jsx(B,{children:e.jsx(Gt,{style:Ie})}),ke.icon==="matter"&&e.jsx(B,{children:e.jsx(Jt,{style:Ie})}),e.jsx(re,{primary:ke.name,secondary:ke.description,primaryTypographyProps:{style:St},secondaryTypographyProps:{style:kt}})]},z)))})}),e.jsx(Ge,{children:e.jsx(de,{onClick:ge,children:"Close"})})]})]})}function $(W){const{onAddClick:T,schema:P,properties:O,title:X,description:me}=W,[ue,J]=r.useState(!1),[f,pe]=r.useState(""),Z=se=>{pe(se.target.value)},L=()=>{J(!ue)},je=se=>{o&&console.log(`ObjectFieldTemplate: handleSelectValue value "${se.serial}" for schema "${P.selectFrom}"`),J(!1);let ge="";P.selectFrom==="serial"?ge=se.serial:P.selectFrom==="name"&&(ge=se.name),Q(ge),o&&console.log(`ObjectFieldTemplate: handleSelectValue newkey "${ge}"`),T(P)()},Re=()=>{T(P)()},ye=!P.additionalProperties;return o&&console.log(`ObjectFieldTemplate: isRoot ${ye} newkey "${Y}"`),!ye&&Y!==""&&(o&&console.log("ObjectFieldTemplate: newkey",Y,"properties",O),O.forEach(se=>{if(se.name==="newKey"&&se.content.key==="newKey"&&se.content.props.name==="newKey"&&se.content.props.onKeyChange&&Y!==""){o&&console.log("ObjectFieldTemplate: newkey onKeyChange",Y);const ge=Y;Q(""),se.content.props.onKeyChange(ge)}})),e.jsxs(ae,{sx:{margin:"0px",padding:ye?"10px":"5px 10px 0px 10px",border:ye?"none":"1px solid grey"},children:[P.title&&ye&&e.jsx(ae,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px",margin:"0px",marginBottom:"10px"},children:e.jsx(he,{sx:tt,children:P.title})}),X&&!ye&&e.jsxs(ae,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px",margin:"0px"},children:[e.jsx(he,{sx:tt,children:X}),e.jsxs(ae,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px",margin:"0px"},children:[P.selectFrom&&e.jsx(E,{title:"Add a device from the list",children:e.jsx(G,{onClick:L,size:"small",color:"primary",sx:qe,children:e.jsx(xt,{})})}),e.jsx(E,{title:"Add a new item",children:e.jsx(G,{onClick:Re,size:"small",color:"primary",sx:qe,children:e.jsx(Mt,{})})})]})]}),P.description&&e.jsx(ae,{sx:{padding:"0px",margin:"0px",marginBottom:"10px"},children:e.jsx(he,{sx:rt,children:P.description})}),O.map(({content:se,name:ge,hidden:Ee})=>!Ee&&e.jsxs(ae,{sx:{margin:"0px",marginBottom:"10px",padding:["object","array","boolean"].includes(P.properties[ge].type)?"0px":Wn,border:["object","array","boolean"].includes(P.properties[ge].type)?"none":"1px solid grey"},children:[!["object","array","boolean"].includes(P.properties[ge].type)&&e.jsx(he,{sx:tt,children:ge}),e.jsx(ae,{sx:{flexGrow:1,padding:"0px",margin:"0px"},children:se})]},ge)),e.jsxs(He,{open:ue,onClose:L,PaperProps:{sx:{maxHeight:"50vh",maxWidth:"50vw",overflow:"auto"}},children:[e.jsx(Ve,{children:"Select a device"}),e.jsxs(Ae,{children:[e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx(he,{variant:"subtitle1",sx:{whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(be,{fullWidth:!0,variant:"outlined",value:f,onChange:Z,placeholder:"Enter serial or name"})]}),e.jsx(dt,{dense:!0,children:ot.filter(se=>se.serial.toLowerCase().includes(f.toLowerCase())||se.name.toLowerCase().includes(f.toLowerCase())).map((se,ge)=>e.jsxs(bt,{onClick:()=>je(se),sx:wt,children:[se.icon==="wifi"&&e.jsx(B,{children:e.jsx(ut,{style:Ie})}),se.icon==="ble"&&e.jsx(B,{children:e.jsx(vt,{style:Ie})}),se.icon==="hub"&&e.jsx(B,{children:e.jsx(yt,{style:Ie})}),e.jsx(re,{primary:se.name,secondary:se.serial,primaryTypographyProps:{style:St},secondaryTypographyProps:{style:kt}})]},ge))})]}),e.jsx(Ge,{children:e.jsx(de,{onClick:L,children:"Close"})})]})]})}function V(W){const{uiSchema:T}=W,{submitText:P,norender:O}=pn(T);return O?null:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",margin:"10px",padding:"0px",gap:"20px"},children:[e.jsx(de,{type:"submit",variant:"contained",color:"primary",children:P}),e.jsx(de,{variant:"contained",color:"primary",onClick:a,children:"Cancel"})]})}function ie(W){const{className:T,disabled:P,onClick:O,registry:X,style:me,uiSchema:ue,...J}=W;return e.jsx(E,{title:"Remove the item",children:e.jsx(G,{disabled:P,size:"small",color:"primary",onClick:O,children:e.jsx(Ht,{})})})}function K(W){const{className:T,disabled:P,onClick:O,registry:X,uiSchema:me,...ue}=W;return e.jsx(E,{title:"Add an item",children:e.jsx(G,{size:"small",color:"primary",onClick:O,children:e.jsx(Mt,{})})})}function te(W){const{disabled:T,onClick:P,registry:O,style:X,uiSchema:me,...ue}=W;return e.jsx(E,{title:"Move up the item",children:e.jsx(G,{size:"small",color:"primary",onClick:P,children:e.jsx(Kt,{})})})}function R(W){const{disabled:T,onClick:P,registry:O,style:X,uiSchema:me,...ue}=W;return e.jsx(E,{title:"Move down the item",children:e.jsx(G,{size:"small",color:"primary",onClick:P,children:e.jsx(Qt,{})})})}function M(W){const{id:T,name:P,value:O,schema:X,readonly:me,onChange:ue}=W,[J,f]=r.useState(),pe=L=>{o&&console.log(`CheckboxWidget ${P} onChangeField:`,L),f(L&&L!==""?L:void 0)},Z=()=>{o&&console.log(`CheckboxWidget onClick plugin="${l.name}" action="${P}" value="${J}"`),i({id:x.current,sender:"ConfigPlugin",method:"/api/action",src:"Frontend",dst:"Matterbridge",params:{plugin:l.name,action:P,value:J,formData:q,id:T}}),X.buttonClose===!0?a():X.buttonSave===!0&&c({formData:j})};return X.buttonText&&X.description?e.jsxs(ae,{sx:{margin:"0px",padding:"10px",border:"1px solid grey",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(he,{sx:rt,children:X.description}),e.jsx(de,{variant:"contained",color:"primary",onClick:()=>Z(),children:X.buttonText})]}):X.buttonField&&X.description?e.jsxs(ae,{sx:{margin:"0px",padding:"10px",gap:"20px",border:"1px solid grey",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(he,{sx:rt,children:X.description}),e.jsx(be,{id:P+"-input",name:P,label:X.textLabel,placeholder:X.textPlaceholder,onChange:L=>pe(L.target.value),sx:{width:"250px",minWidth:"250px",maxWidth:"250px"}}),e.jsx(de,{id:P+"-button",variant:"contained",color:"primary",disabled:J===void 0,onClick:()=>Z(),children:X.buttonField})]}):e.jsxs(ae,{sx:{margin:"0px",padding:"5px 10px",border:"1px solid grey"},children:[P&&e.jsxs(ae,{sx:{margin:"0px",padding:"0px",gap:"10px",display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(he,{sx:tt,children:P}),e.jsx(Be,{checked:O,readOnly:me,onChange:()=>ue(!O),sx:{padding:"0px",margin:"0px"}})]}),X.description&&e.jsx(he,{sx:rt,children:X.description})]})}function C({schema:W,id:T,name:P,options:O,label:X,hideLabel:me,required:ue,disabled:J,placeholder:f,readonly:pe,value:Z,multiple:L,autofocus:je,onChange:Re,onBlur:ye,onFocus:se,errorSchema:ge,rawErrors:Ee=[],registry:Me,uiSchema:ct,hideError:U,formContext:ke,...z}){const{enumOptions:le,enumDisabled:$e,emptyValue:Te}=O;L=typeof L>"u"?!1:!!L;const Ut=L?[]:"",qt=typeof Z>"u"||L&&Z.length<1||!L&&Z===Ut,Mr=({target:{value:Ue}})=>Re(Rt(Ue,le,Te)),Dr=({target:Ue})=>ye(T,Rt(Ue&&Ue.value,le,Te)),Pr=({target:Ue})=>se(T,Rt(Ue&&Ue.value,le,Te)),zt=cn(Z,le,L),{InputLabelProps:Lr,SelectProps:$r,autocomplete:Tr,...Wr}=z,Fr=!L&&W.default===void 0;return e.jsxs(be,{id:T,name:T,value:!qt&&typeof zt<"u"?zt:Ut,required:ue,disabled:J||pe,autoFocus:je,autoComplete:Tr,placeholder:f,error:Ee.length>0,onChange:Mr,onBlur:Dr,onFocus:Pr,...Wr,select:!0,InputLabelProps:{...Lr,shrink:!qt},SelectProps:{...$r,multiple:L},"aria-describedby":dn(T),children:[Fr&&e.jsx(w,{value:"",children:f}),Array.isArray(le)&&le.map(({value:Ue,label:Nr},Bt)=>{const Rr=Array.isArray($e)&&$e.indexOf(Ue)!==-1;return e.jsx(w,{value:String(Bt),disabled:Rr,children:Nr},Bt)})]})}return o&&console.log("ConfigPluginDialog rendering..."),!n||!D||!j?null:e.jsxs(He,{open:n,onClose:a,slotProps:{paper:{sx:{maxWidth:"800px"}}},children:[e.jsx(Ve,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h3",{children:"Matterbridge plugin configuration"})]})}),e.jsx(Ae,{style:{padding:"0px",margin:"0px",width:"800px",height:"600px",overflow:"auto"},children:e.jsx(ln,{schema:D,formData:j,uiSchema:S,validator:an,templates:{FieldTemplate:k,BaseInputTemplate:p,TitleFieldTemplate:N,DescriptionFieldTemplate:I,FieldHelpTemplate:H,FieldErrorTemplate:y,ErrorListTemplate:ne,WrapIfAdditionalTemplate:u,ArrayFieldTitleTemplate:d,ArrayFieldDescriptionTemplate:b,ArrayFieldItemTemplate:F,ArrayFieldTemplate:_,ObjectFieldTemplate:$,ButtonTemplates:{SubmitButton:V,RemoveButton:ie,AddButton:K,MoveUpButton:te,MoveDownButton:R}},widgets:{CheckboxWidget:M,SelectWidget:C},onChange:h,onSubmit:c})})]})};function wr(n){if(o&&console.log(`getQRColor (id: ${n?.id}) received matter:`,n??"undefined"),n===void 0||!n.online||!n.qrPairingCode&&!n.manualPairingCode&&!n.fabricInformations&&!n.sessionInformations)return"red";if(n.commissioned===!1&&n.qrPairingCode&&n.manualPairingCode)return"var(--primary-color)";let a=0,l=0;for(const i of n.sessionInformations??[])i.fabric&&i.isPeerActive===!0&&a++,i.numberOfActiveSubscriptions>0&&(l+=i.numberOfActiveSubscriptions);return n.commissioned===!0&&n.fabricInformations&&n.sessionInformations&&(a===0||l===0)?"var(--secondary-color)":"var(--div-text-color)"}function Nn({storeId:n,setStoreId:a}){const{online:l,sendMessage:i,addListener:s,removeListener:m,getUniqueId:g}=r.useContext(ve),{showConfirmCancelDialog:x}=r.useContext(Le),j=r.useRef(g()),[t,D]=r.useState(null),[v,S]=r.useState(null),[A,Y]=r.useState([]),Q=[{label:"Name",id:"name",required:!0,render:(R,M,C,W)=>e.jsx(E,{title:`Plugin path ${C.path}`,children:e.jsx("span",{style:{cursor:"pointer"},onClick:()=>y(C),children:C.name})})},{label:"Description",id:"description",render:(R,M,C,W)=>e.jsx(E,{title:"Open the plugin homepage",children:e.jsx("span",{style:{cursor:"pointer"},onClick:()=>y(C),children:C.description})})},{label:"Version",id:"version",render:(R,M,C,W)=>e.jsx(e.Fragment,{children:e.jsx(E,{title:`Plugin v.${C.version}`,children:e.jsx("span",{children:C.version.split("-")[0]+(C.version.includes("-dev-")?"@dev":"")+(C.version.includes("-git-")?"@git":"")})})})},{label:"Author",id:"author",render:(R,M,C,W)=>e.jsx(e.Fragment,{children:C.author?C.author.replace("https://github.com/",""):"Unknown"})},{label:"Type",id:"type",render:(R,M,C,W)=>e.jsx(e.Fragment,{children:C.type?C.type.replace("Platform",""):"Unknown"})},{label:"Devices",id:"registeredDevices"},{label:"Actions",id:"actions",required:!0,noSort:!0,render:(R,M,C,W)=>e.jsxs("div",{style:{margin:"0px",padding:"0px",gap:"4px",display:"flex",flexDirection:"row"},children:[v&&v.bridgeMode==="childbridge"&&!C.error&&C.enabled&&e.jsx(E,{title:"Shows the QRCode or the fabrics",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{margin:"0",padding:"0",width:"19px",height:"19px",color:wr(C.matter)},onClick:()=>{C.matter?.id&&a(C.matter?.id)},size:"small",children:e.jsx(mr,{})})}),v&&v.bridgeMode==="childbridge"&&!C.error&&C.enabled&&e.jsx(E,{title:"Restart the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{margin:"0",padding:"0",width:"19px",height:"19px"},onClick:()=>H(C),size:"small",children:e.jsx(Dt,{})})}),e.jsx(E,{title:"Plugin config",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{disabled:C.restartRequired===!0,style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>ie(C),size:"small",children:e.jsx(Xr,{})})}),v&&!v.readOnly&&e.jsx(E,{title:"Remove the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>{h("Remove plugin","Are you sure? This will also remove all devices and configuration from the controller.","remove",C)},size:"small",children:e.jsx(gr,{})})}),C.enabled?e.jsx(E,{title:"Disable the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>{h("Disable plugin","Are you sure? This will also remove all devices and configuration from the controller.","disable",C)},size:"small",children:e.jsx(eo,{})})}):e.jsx(e.Fragment,{}),C.enabled?e.jsx(e.Fragment,{}):e.jsx(E,{title:"Enable the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{margin:"0px",padding:"0px",width:"19px",height:"19px"},onClick:()=>ne(C),size:"small",children:e.jsx(to,{})})}),e.jsx(E,{title:"Open the plugin help",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{margin:"0px 2px",padding:"0px",width:"19px",height:"19px"},onClick:()=>d(C),size:"small",children:e.jsx(hr,{})})}),e.jsx(E,{title:"Open the plugin version history",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{margin:"0px 2px",padding:"0px",width:"19px",height:"19px"},onClick:()=>b(C),size:"small",children:e.jsx(Vt,{})})}),C.latestVersion!==void 0&&C.latestVersion!==C.version&&v&&!v.readOnly&&e.jsx(E,{title:"Update the plugin to the latest version",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{color:"var(--primary-color)",margin:"0px 2px",padding:"0px",width:"19px",height:"19px"},onClick:()=>k(C),size:"small",children:e.jsx(_e,{})})}),(C.version.includes("-dev-")||C.version.includes("-git-"))&&C.devVersion!==void 0&&C.devVersion!==C.version&&v&&!v.readOnly&&e.jsx(E,{title:"Update the plugin to the latest dev version",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{color:"var(--secondary-color)",margin:"0px 2px",padding:"0px",width:"19px",height:"19px"},onClick:()=>I(C),size:"small",children:e.jsx(_e,{})})}),v&&!v.readOnly&&e.jsx(E,{title:"Sponsor the plugin",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{style:{margin:"0",padding:"0",width:"19px",height:"19px",color:"#b6409c"},onClick:()=>p(C),size:"small",children:e.jsx(At,{})})})]})},{label:"Status",id:"status",required:!0,noSort:!0,render:(R,M,C,W)=>e.jsx("div",{style:{display:"flex",flexDirection:"row",flex:"1 1 auto",margin:"0",padding:"0",gap:"5px",width:"auto",maxWidth:"max-content"},children:C.error?e.jsx(e.Fragment,{children:e.jsx(et,{status:!1,enabledText:"Error",disabledText:"Error",tooltipText:"The plugin is in error state. Check the log!"})}):e.jsx(e.Fragment,{children:C.enabled===!1?e.jsx(e.Fragment,{children:e.jsx(et,{status:C.enabled,enabledText:"Enabled",disabledText:"Disabled",tooltipText:"Whether the plugin is enable or disabled"})}):e.jsx(e.Fragment,{children:C.loaded&&C.started&&C.configured?e.jsx(e.Fragment,{children:e.jsx(et,{status:C.loaded,enabledText:"Running",tooltipText:"Whether the plugin is running"})}):e.jsxs(e.Fragment,{children:[e.jsx(et,{status:C.loaded,enabledText:"Loaded",tooltipText:"Whether the plugin has been loaded"}),e.jsx(et,{status:C.started,enabledText:"Started",tooltipText:"Whether the plugin started"}),e.jsx(et,{status:C.configured,enabledText:"Configured",tooltipText:"Whether the plugin has been configured"})]})})})})}];r.useEffect(()=>{const R=M=>{o&&console.log("HomePlugins received WebSocket Message:",M),M.method==="refresh_required"&&M.response.changed==="plugins"?(o&&console.log(`HomePlugins received refresh_required: changed=${M.response.changed} and sending /api/plugins request`),i({id:j.current,sender:"HomePlugins",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}})):M.method==="refresh_required"&&M.response.changed==="matter"?(o&&console.log(`HomePlugins received refresh_required: changed=${M.response.changed} and setting matter id ${M.response.matter?.id}`),Y(C=>{const W=C.findIndex(P=>P.matter?.id===M.response.matter?.id);if(W<0)return o&&console.log(`HomePlugins received refresh_required: changed=${M.response.changed} and matter id ${M.response.matter?.id} not found`),C;o&&console.log(`HomePlugins received refresh_required: changed=${M.response.changed} set matter id ${M.response.matter?.id}`);const T=[...C];return T[W]={...T[W],matter:M.response.matter},T})):M.method==="refresh_required"&&M.response.changed==="settings"&&(o&&console.log(`HomePlugins received refresh_required: changed=${M.response.changed} and sending /api/settings request`),i({id:j.current,sender:"HomePlugins",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})),M.id===j.current&&M.method==="/api/settings"?(o&&console.log(`HomePlugins (id: ${M.id}) received settings:`,M.response),D(M.response.systemInformation),S(M.response.matterbridgeInformation)):M.id===j.current&&M.method==="/api/plugins"&&(o&&console.log(`HomePlugins (id: ${M.id}) received ${M.response.length} plugins:`,M.response),Y(M.response))};return s(R,j.current),o&&console.log("HomePlugins added WebSocket listener id:",j.current),()=>{m(R),o&&console.log("HomePlugins removed WebSocket listener")}},[s,m,i]),r.useEffect(()=>{l&&(o&&console.log("HomePlugins sending api requests"),i({id:j.current,sender:"HomePlugins",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),i({id:j.current,sender:"HomePlugins",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}))},[l,i]);const q=r.useRef(null),h=(R,M,C,W)=>{o&&console.log(`handleActionWithConfirmCancel ${C} ${W.name}`),q.current=W,x(R,M,C,c,u)},c=R=>{o&&console.log(`handleConfirm action confirmed ${R} ${q.current?.name}`),R==="remove"&&q.current?N(q.current):R==="disable"&&q.current&&ne(q.current),q.current=null},u=R=>{o&&console.log(`handleCancel action canceled ${R} ${q.current?.name}`),q.current=null},k=R=>{o&&console.log("handleUpdatePlugin plugin:",R.name),i({id:j.current,sender:"HomePlugins",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:R.name,restart:!1}})},I=R=>{o&&console.log("handleUpdateDevPlugin plugin:",R.name),i({id:j.current,sender:"HomePlugins",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:R.name+"@dev",restart:!1}})},N=R=>{o&&console.log("handleRemovePlugin plugin:",R.name),i({id:j.current,sender:"HomePlugins",method:"/api/removeplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:R.name}})},H=R=>{o&&console.log("handleRestartPlugin plugin:",R.name),i({id:j.current,sender:"HomePlugins",method:"/api/restartplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:R.name}})},ne=R=>{o&&console.log("handleEnableDisablePlugin plugin:",R.name,"enabled:",R.enabled),R.enabled===!0?(R.enabled=!1,i({id:j.current,sender:"HomePlugins",method:"/api/disableplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:R.name}})):(R.enabled=!0,i({id:j.current,sender:"HomePlugins",method:"/api/enableplugin",src:"Frontend",dst:"Matterbridge",params:{pluginName:R.name}}))},y=R=>{o&&console.log(`handleHomepagePlugin plugin: ${R.name} homepage: ${R.homepage}`),R.homepage&&window.open(R.homepage,"_blank")},p=R=>{o&&console.log("handleSponsorPlugin plugin:",R.name,"funding:",R.funding),R.funding&&window.open(R.funding,"_blank")},d=R=>{o&&console.log("handleHelpPlugin plugin:",R.name,"help:",R.help),R.help&&window.open(R.help,"_blank")},b=R=>{o&&console.log("handleChangelogPlugin plugin:",R.name,"changelog:",R.changelog),R.changelog&&window.open(R.changelog,"_blank")},[F,_]=r.useState(),[$,V]=r.useState(!1),ie=R=>{o&&console.log("handleConfigPlugin plugin:",R.name),i({id:j.current,sender:"HomePlugins",method:"/api/select/devices",src:"Frontend",dst:"Matterbridge",params:{plugin:R.name}}),i({id:j.current,sender:"HomePlugins",method:"/api/select/entities",src:"Frontend",dst:"Matterbridge",params:{plugin:R.name}}),_(R),K()},K=()=>{V(!0)},te=()=>{V(!1)};return o&&console.log("HomePlugins rendering..."),l?e.jsxs(Ce,{children:[F&&e.jsx(Fn,{open:$,onClose:te,plugin:F}),e.jsx(Tt,{name:"Plugins",columns:Q,rows:A,footerRight:"",footerLeft:""})]}):e.jsx(Oe,{})}const Rn=r.memo(Nn),_n=n=>`${n.pluginName}::${n.serial}`;function On({storeId:n,setStoreId:a}){const{online:l,sendMessage:i,addListener:s,removeListener:m,getUniqueId:g}=r.useContext(ve),[x,j]=r.useState(!1),[t,D]=r.useState(!0),[v,S]=r.useState(null),[A,Y]=r.useState([]),[Q,q]=r.useState([]),[h,c]=r.useState([]),[u,k]=r.useState([]),I=r.useRef(g()),N=[{label:"Plugin",id:"pluginName"},{label:"Name",id:"name",required:!0},{label:"Serial",id:"serial"},{label:"Availability",id:"availability",render:(y,p,d,b)=>d.reachable===!0?"Online":d.reachable===!1?e.jsx("span",{style:{color:"red"},children:"Offline"}):"",comparator:(y,p)=>{const d=y.reachable===!0?1:y.reachable===!1?0:-1,b=p.reachable===!0?1:p.reachable===!1?0:-1;return d-b}},{label:"Power",id:"powerSource",render:(y,p,d,b)=>d.powerSource==="ac"||d.powerSource==="dc"?e.jsx(fr,{fontSize:"small",sx:{color:"var(--primary-color)"}}):d.powerSource==="ok"?d.batteryLevel?e.jsx(E,{title:`Battery level: ${d.batteryLevel}%`,children:e.jsx(Je,{fontSize:"small",sx:{color:"green"}})}):e.jsx(Je,{fontSize:"small",sx:{color:"gray"}}):d.powerSource==="warning"?d.batteryLevel?e.jsx(E,{title:`Battery level: ${d.batteryLevel}%`,children:e.jsx(Je,{fontSize:"small",sx:{color:"yellow"}})}):e.jsx(Je,{fontSize:"small",sx:{color:"yellow"}}):d.powerSource==="critical"?d.batteryLevel?e.jsx(E,{title:`Battery level: ${d.batteryLevel}%`,children:e.jsx(Je,{fontSize:"small",sx:{color:"red"}})}):e.jsx(Je,{fontSize:"small",sx:{color:"red"}}):e.jsx("span",{})},{label:"Actions",id:"selected",required:!0,render:(y,p,d,b)=>e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[d.matter!==void 0?e.jsx(E,{title:"Show the QRCode or the fabrics",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{onClick:()=>a(n===d.matter?.id?v?.matterbridgeInformation.bridgeMode==="bridge"?"Matterbridge":null:d.matter?.id||null),"aria-label":"Show the QRCode",sx:{margin:0,padding:0,color:wr(d.matter)},children:e.jsx(mr,{fontSize:"small"})})}):e.jsx("div",{style:{width:"20px",height:"20px"}}),d.configUrl?e.jsx(E,{title:"Open the configuration page",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(G,{onClick:()=>window.open(d.configUrl,"_blank"),"aria-label":"Open config url",sx:{margin:0,padding:0},children:e.jsx(xr,{fontSize:"small"})})}):e.jsx("div",{style:{width:"20px",height:"20px"}}),d.selected!==void 0?e.jsx(E,{title:"Select/unselect the device",slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[30,15]}}]}},children:e.jsx(Be,{checked:d.selected,onChange:F=>ne(F,d),sx:{margin:"0",marginLeft:"8px",padding:"0"},size:"small"})}):e.jsx("div",{style:{width:"20px",height:"20px"}})]})}],H=r.useCallback(y=>{y.selected=void 0;const p=A.find(F=>F.name===y.pluginName);if(!p)return console.error(`HomeDevices isSelected: plugin ${y.pluginName} not found for device ${y.name} `),y.selected;const d=p.schemaJson?.properties?.whiteList?.selectFrom;let b=p.configJson.postfix;return b===""&&(b=void 0),p.hasWhiteList===!0&&p.hasBlackList===!0&&d&&(y.selected=!0,d==="serial"&&p.configJson.whiteList&&p.configJson.whiteList.length>0&&p.configJson.whiteList.includes(b?y.serial.replace("-"+b,""):y.serial)&&(y.selected=!0),d==="serial"&&p.configJson.whiteList&&p.configJson.whiteList.length>0&&!p.configJson.whiteList.includes(b?y.serial.replace("-"+b,""):y.serial)&&(y.selected=!1),d==="serial"&&p.configJson.blackList&&p.configJson.blackList.length>0&&p.configJson.blackList.includes(b?y.serial.replace("-"+b,""):y.serial)&&(y.selected=!1),d==="name"&&p.configJson.whiteList&&p.configJson.whiteList.length>0&&p.configJson.whiteList.includes(y.name)&&(y.selected=!0),d==="name"&&p.configJson.whiteList&&p.configJson.whiteList.length>0&&!p.configJson.whiteList.includes(y.name)&&(y.selected=!1),d==="name"&&p.configJson.blackList&&p.configJson.blackList.length>0&&p.configJson.blackList.includes(y.name)&&(y.selected=!1)),y.selected},[A]);r.useEffect(()=>{const y=p=>{if(o&&console.log("HomeDevices received WebSocket Message:",p),p.method==="refresh_required"&&p.response.changed!=="matter"?(o&&console.log(`HomeDevices received refresh_required: changed=${p.response.changed} and sending /api/plugins request`),i({id:I.current,sender:"HomeDevices",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}})):p.method==="refresh_required"&&p.response.changed==="matter"?(o&&console.log(`HomeDevices received refresh_required: changed=${p.response.changed} and setting matter id ${p.response.matter?.id}`),k(d=>{const b=d.findIndex(_=>_.name.replaceAll(" ","")===p.response.matter?.id);if(b<0)return o&&console.debug(`HomeDevices: matter id ${p.response.matter?.id} not found`),d;const F=[...d];return F[b]={...F[b],matter:p.response.matter},o&&console.log(`HomeDevices received refresh_required: changed=${p.response.changed} and set matter id ${p.response.matter?.id}`),F})):p.method==="restart_required"?(o&&console.log("HomeDevices received restart_required"),j(!0)):p.method==="restart_not_required"?(o&&console.log("HomeDevices received restart_not_required"),j(!1)):p.method==="state_update"&&p.response.plugin&&p.response.serialNumber&&p.response.cluster.includes("BasicInformation")&&p.response.attribute==="reachable"&&(o&&console.log(`HomeDevices updating device reachability for plugin ${p.response.plugin} serial ${p.response.serialNumber} value ${p.response.value}`),q(d=>{const b=d.findIndex(F=>F.pluginName===p.response.plugin&&F.serial===p.response.serialNumber);return b<0?(o&&console.warn(`HomeDevices: device to update not found for plugin ${p.response.plugin} serial ${p.response.serialNumber}`),d):(d[b]={...d[b],reachable:p.response.value},[...d])})),p.id===I.current&&p.method==="/api/settings")o&&console.log(`HomeDevices (id: ${p.id}) received settings:`,p.response),S(p.response),j(p.response.matterbridgeInformation.restartRequired||p.response.matterbridgeInformation.fixedRestartRequired);else if(p.id===I.current&&p.method==="/api/plugins"){if(o&&console.log(`HomeDevices (id: ${p.id}) received ${p.response?.length} plugins:`,p.response),p.response){let d=!0;for(const b of p.response)b.enabled===!0&&(b.loaded!==!0||b.started!==!0||b.error===!0)&&(d=!1);if(!d)return;o&&console.log("HomeDevices reset plugins, devices and selectDevices"),D(!1),Y(p.response),q([]),c([]),i({id:I.current,sender:"HomeDevices",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}}),o&&console.log("HomeDevices sent /api/devices");for(const b of p.response)b.enabled===!0&&b.loaded===!0&&b.started===!0&&b.error!==!0&&(i({id:I.current,sender:"HomeDevices",method:"/api/select/devices",src:"Frontend",dst:"Matterbridge",params:{plugin:b.name}}),o&&console.log(`HomeDevices sent /api/select/devices for plugin: ${b.name}`))}}else if(p.id===I.current&&p.method==="/api/devices"){if(o&&console.log(`HomeDevices (id: ${p.id}) received ${p.response?.length} devices:`,p.response),p.response){for(const d of p.response)d.selected=H(d);q(p.response)}}else p.id===I.current&&p.method==="/api/select/devices"&&(o&&console.log(`HomeDevices (id: ${p.id}) received ${p.response?.length} selectDevices for plugin ${p.response&&p.response.length>0?p.response[0].pluginName:"without select devices"}:`,p.response),p.response&&p.response.length>0&&c(d=>{const b=d.filter(_=>_.pluginName!==p.response[0].pluginName),F=p.response.map(_=>({..._,selected:H(_)}));return[...b,...F]}))};return s(y,I.current),o&&console.log(`HomeDevices added WebSocket listener id ${I.current}`),()=>{m(y),o&&console.log("HomeDevices removed WebSocket listener")}},[A,s,m,i,H]),r.useEffect(()=>{if(Q.length===0&&h.length===0){k([]);return}o&&console.log(`HomeDevices mixing devices (${Q.length}) and selectDevices (${h.length})`);const y=[];for(const p of Q)y.push(p);for(const p of h)Q.find(d=>d.pluginName===p.pluginName&&d.serial.includes(p.serial))||y.push(p);y.length>0&&(k(y),o&&console.log(`HomeDevices mixed ${y.length} devices and selectDevices`))},[A,Q,h,k]),r.useEffect(()=>{l&&(o&&console.log("HomeDevices sending /api/settings and /api/plugins requests"),i({id:I.current,sender:"HomeDevices",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),i({id:I.current,sender:"HomeDevices",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}))},[l,i]);const ne=(y,p)=>{o&&console.log(`handleCheckboxChange: checkbox changed to ${y.target.checked} for device ${p.name} serial ${p.serial}`),Q.findIndex(d=>d.pluginName===p.pluginName&&d.serial===p.serial)<0?(o&&console.warn(`handleCheckboxChange: device ${p.name} serial ${p.serial} not found in devices, trying in mixedDevices`),k(d=>{const b=d.findIndex(F=>F.pluginName===p.pluginName&&F.serial===p.serial);return b<0?(console.error(`handleCheckboxChange: device ${p.name} serial ${p.serial} not found in mixedDevices`),d):(d[b]={...d[b],selected:y.target.checked},[...d])})):q(d=>{const b=d.findIndex(F=>F.pluginName===p.pluginName&&F.serial===p.serial);return b<0?(console.error(`handleCheckboxChange: device ${p.name} serial ${p.serial} not found in devices`),d):(d[b]={...d[b],selected:y.target.checked},[...d])}),y.target.checked?i({id:I.current,sender:"HomeDevices",method:"/api/command",src:"Frontend",dst:"Matterbridge",params:{command:"selectdevice",plugin:p.pluginName,serial:p.serial,name:p.name}}):i({id:I.current,sender:"HomeDevices",method:"/api/command",src:"Frontend",dst:"Matterbridge",params:{command:"unselectdevice",plugin:p.pluginName,serial:p.serial,name:p.name}})};return o&&console.log("HomeDevices rendering..."),l?e.jsx(Ce,{style:{flex:"1 1 auto"},children:e.jsx(Tt,{name:"Devices",getRowKey:_n,rows:u,columns:N,footerLeft:t?"Waiting for the plugins to fully load...":`Registered devices: ${Q.length.toString()}/${u.length.toString()}`,footerRight:x?"Restart required":""})}):e.jsx(Oe,{})}const En=r.memo(On);function ht({children:n,style:a,name:l}){const{setCurrentPage:i}=r.useContext(Le);i(l),o&&console.log(`MbfPage: current page set to ${l}`);const s={display:"flex",flexDirection:"column",width:"100%",height:"100%",margin:"0px",padding:"0px",gap:"20px"};return e.jsx("div",{style:{...s,...a},children:n})}const Hn=()=>"ontouchstart"in window||typeof window.DocumentTouch<"u"&&document instanceof window.DocumentTouch?(o&&console.log("WebSocketLogs detectTouchscreen = true"),!0):(o&&console.log("WebSocketLogs detectTouchscreen = false"),!1);function Vn(){const{messages:n,logAutoScroll:a}=r.useContext(jr),[l,i]=r.useState(!1),s=r.useRef(null),m=r.useRef(0),g=r.useRef(null),x=r.useMemo(()=>Hn(),[]),j=S=>i(!0),t=S=>i(!1);r.useEffect(()=>{if(o&&console.log(`WebSocketLogs logAutoScroll: ${a.current} isHovering: ${l}`),a.current&&!l&&!x){const S=Date.now();S-m.current>=500?(o&&console.log("WebSocketLogs auto-scroll to bottom"),m.current=S,s.current?.scrollIntoView({behavior:"smooth",block:"end"})):(o&&console.log("WebSocketLogs auto-scroll skipped to avoid flicker"),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{s.current?.scrollIntoView({behavior:"smooth"}),m.current=Date.now()},1e3))}},[n,a,l,x]);const D=S=>{switch(S.toLowerCase()){case"debug":return"gray";case"info":return"#267fb7";case"notice":return"green";case"warn":return"#e9db18";case"error":return"red";case"fatal":return"#ff0000";case"spawn":return"#ff00d0";default:return"#5c0e91"}},v=S=>{switch(S.toLowerCase()){case"warn":return"black";default:return"white"}};return e.jsx("div",{style:{margin:"0px",padding:"0px"},children:e.jsxs("ul",{style:{margin:"0px",padding:"0px"},onMouseEnter:j,onMouseLeave:t,children:[n.map((S,A)=>e.jsxs("li",{style:{wordWrap:"break-word",maxHeight:"200px",overflow:"hidden"},children:[e.jsx("span",{style:{marginRight:"5px",padding:"1px 5px",backgroundColor:D(S.level),color:v(S.level),fontSize:"12px",borderRadius:"3px",textAlign:"center"},children:S.level}),S.time&&e.jsx("span",{style:{marginRight:"3px",color:"#505050"},children:"["+S.time+"]"}),S.name&&e.jsx("span",{style:{marginRight:"3px",color:"#09516d"},children:"["+S.name+"]"}),e.jsx("span",{style:{color:"var(--main-log-color)"},children:S.message})]},A)),e.jsx("div",{ref:s})]})})}const Sr=r.memo(Vn);function An(){const[n,a]=r.useState(localStorage.getItem(oe.logFilterLevel)??"info"),[l,i]=r.useState(localStorage.getItem(oe.logFilterSearch)??"*"),{online:s,logAutoScroll:m}=r.useContext(ve);return o&&console.log("HomeLogs rendering..."),s?e.jsxs(Ce,{style:{flex:"1 1 auto"},children:[e.jsxs(De,{children:[e.jsx(Se,{children:"Logs"}),e.jsxs(Se,{style:{fontWeight:"normal",fontSize:"12px",marginTop:"2px"},children:['Filter: logger level "',n,'" and search "',l===""?"*":l,'" Scroll: ',m.current?"auto":"manual"]})]}),e.jsx(Ne,{style:{flex:"1 1 auto",overflow:"auto",margin:"0px",padding:"10px",alignItems:"start"},children:e.jsx(Sr,{})})]}):e.jsx(Oe,{})}const Un=r.memo(An);function qn(){const{online:n}=r.useContext(ve);return o&&console.log("HomeBrowserRefresh rendering..."),n?e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Se,{children:"Frontend Update"})}),e.jsxs(Ne,{style:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"The frontend has been updated. You are viewing an outdated web UI. Please refresh the page now."}),e.jsx("div",{children:e.jsx(de,{onClick:()=>window.location.reload(),endIcon:e.jsx(ro,{}),style:{marginLeft:"10px",color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Refresh"})})]})]}):e.jsx(Oe,{})}const zn=r.memo(qn);function Bn({changelog:n}){const{online:a}=r.useContext(ve);return o&&console.log("HomeShowChangelog rendering..."),a?e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Se,{children:"Matterbridge Update"})}),e.jsxs(Ne,{style:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Matterbridge has been updated."}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"10px"},children:[e.jsx(de,{onClick:()=>window.open("https://github.com/Luligu/matterbridge","_blank"),endIcon:e.jsx(br,{style:{color:"#FFD700"}}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Star"}),e.jsx(de,{onClick:()=>window.open("https://www.buymeacoffee.com/luligugithub","_blank"),endIcon:e.jsx(At,{style:{color:"#b6409c"}}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Sponsor"}),e.jsx(de,{onClick:()=>window.open(n,"_blank"),endIcon:e.jsx(Vt,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Changelog"}),e.jsx(de,{onClick:()=>window.location.reload(),endIcon:e.jsx(oo,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Close"})]})]})]}):e.jsx(Oe,{})}const Qn=r.memo(Bn);function Kn({matterbridgeInfo:n}){const{mobile:a}=r.useContext(Le);o&&console.log("MatterbridgeInfoTable:",n);const l=["matterbridgeLatestVersion","matterbridgeDevVersion","--matterFileLogger","--fileLogger","--matterLoggerLevel","--loggerLevel","--virtualMode","--bridgeMode","--restartMode","--restartRequired","fixedRestartRequired","--updateRequired","matterMdnsInterface","matterIpv4Address","matterIpv6Address","readOnly","shellyBoard","shellySysUpdate","shellyMainUpdate","matterPort","matterDiscriminator","matterPasscode"],[i,s]=r.useState(!1);return!n||i?null:(o&&console.log("MatterbridgeInfoTable rendering..."),e.jsxs(Ce,{style:xe&&a?{flex:"1 1 300px"}:{flex:"0 1 auto",width:"302px",minWidth:"302px"},children:[e.jsxs(De,{children:[e.jsx(Se,{children:"Matterbridge info"}),e.jsx(Ze,{close:()=>s(!0)})]}),e.jsx(Ne,{style:xe&&a?{flex:"1 1 auto",margin:"0px",padding:"0px",gap:"0px"}:{flex:"1 1 auto",overflow:"auto",margin:"0px",padding:"0px",gap:"0px"},children:e.jsxs("table",{style:{border:"none",borderCollapse:"collapse",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"60%"}})]}),e.jsx("tbody",{style:{border:"none",borderCollapse:"collapse"},children:Object.entries(n).filter(([m,g])=>!l.includes(m)&&g!==null&&g!==void 0&&g!=="").map(([m,g],x)=>e.jsxs("tr",{className:x%2===0?"table-content-even":"table-content-odd",style:{border:"none",borderCollapse:"collapse"},children:[e.jsx("td",{style:{border:"none",borderCollapse:"collapse",whiteSpace:"nowrap"},children:m.replace("matterbridgeVersion","Matterbridge version").replace("matterbridgeLatestVersion","Matterbridge latest v.").replace("matterbridgeDevVersion","Matterbridge dev v.").replace("frontendVersion","Frontend version").replace("homeDirectory","Home").replace("rootDirectory","Root").replace("matterbridgeDirectory","Storage").replace("matterbridgeCertDirectory","Cert").replace("matterbridgePluginDirectory","Plugins").replace("globalModulesDirectory","Modules").replace("bridgeMode","Bridge mode").replace("restartMode","Restart mode").replace("virtualMode","Virtual mode").replace("profile","Profile").replace("loggerLevel","Logger level").replace("fileLogger","File logger").replace("loggerLevel","Logger level").replace("fileLogger","File logger").replace("matterLoggerLevel","Matter logger level").replace("matterFileLogger","Matter file logger").replace("restartRequired","Restart required").replace("updateRequired","Update required")}),e.jsx("td",{style:{border:"none",borderCollapse:"collapse",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:xe&&a?typeof g!="string"?g.toString():g:e.jsx(Cr,{value:typeof g!="string"?g.toString():g,maxChars:24})})]},m))})]})})]}))}const Gn=r.memo(Kn);function Jn(){const[n,a]=r.useState(null),[l,i]=r.useState(null),[s,m]=r.useState([]),[g]=r.useState(localStorage.getItem(oe.homePagePlugins)!=="false"),[x,j]=r.useState(localStorage.getItem(oe.homePageMode)??"devices"),[t,D]=r.useState(""),[v,S]=r.useState(!1),[A,Y]=r.useState(!1),[Q,q]=r.useState(null),{mobile:h}=r.useContext(Le),{addListener:c,removeListener:u,online:k,sendMessage:I,getUniqueId:N}=r.useContext(ve),H=r.useRef(N());return r.useEffect(()=>{const ne=y=>{o&&console.log("Home received WebSocket Message:",y),y.method==="refresh_required"&&y.response.changed==="settings"&&(o&&console.log(`Home received refresh_required: changed=${y.response.changed} and sending /api/settings request`),q(null),m([]),I({id:H.current,sender:"Home",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),I({id:H.current,sender:"Home",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}})),y.method==="/api/settings"&&y.id===H.current&&(o&&console.log("Home received settings:",y.response),a(y.response.systemInformation),i(y.response.matterbridgeInformation),y.response.matterbridgeInformation.matterbridgeVersion&&D(`https://github.com/Luligu/matterbridge/blob/${y.response.matterbridgeInformation.matterbridgeVersion.includes("-dev-")?"dev":"main"}/CHANGELOG.md`),localStorage.getItem(oe.frontendVersion)===null&&y.response.matterbridgeInformation.frontendVersion?localStorage.setItem(oe.frontendVersion,y.response.matterbridgeInformation.frontendVersion):y.response.matterbridgeInformation.frontendVersion!==localStorage.getItem(oe.frontendVersion)&&y.response.matterbridgeInformation.frontendVersion&&(localStorage.setItem(oe.frontendVersion,y.response.matterbridgeInformation.frontendVersion),Y(!0)),localStorage.getItem(oe.matterbridgeVersion)===null?localStorage.setItem(oe.matterbridgeVersion,y.response.matterbridgeInformation.matterbridgeVersion):y.response.matterbridgeInformation.matterbridgeVersion!==localStorage.getItem(oe.matterbridgeVersion)&&(localStorage.setItem(oe.matterbridgeVersion,y.response.matterbridgeInformation.matterbridgeVersion),S(!0)),y.response.matterbridgeInformation.shellyBoard&&(localStorage.getItem(oe.homePageMode)||(localStorage.setItem(oe.homePageMode,"devices"),j("devices")))),y.method==="/api/plugins"&&y.id===H.current&&(o&&console.log("Home received plugins:",y.response),m(y.response))};return c(ne,H.current),o&&console.log(`Home added WebSocket listener id ${H.current}`),()=>{u(ne),o&&console.log("Home removed WebSocket listener")}},[c,u,I]),r.useEffect(()=>{if(o&&console.log(`Home storeId effect with storeId ${Q}`),l?.bridgeMode==="bridge"&&!Q&&(o&&console.log("Home storeId effect set storeId to Matterbridge"),q("Matterbridge")),l?.bridgeMode==="childbridge"&&!Q&&s){for(const ne of s)if(ne.matter?.id){o&&console.log(`Home storeId effect set storeId to ${ne.matter.id}`),q(ne.matter.id);break}}},[l,s,Q]),r.useEffect(()=>{k&&(o&&console.log("Home online effect, sending /api/settings and /api/plugins requests"),I({id:H.current,sender:"Home",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),I({id:H.current,sender:"Home",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}))},[k,I]),o&&console.log("Home rendering..."),!k||!n||!l?e.jsx(Oe,{}):e.jsxs(ht,{name:"Home",style:xe&&h?{alignItems:"center",gap:"10px"}:{flexDirection:"row"},children:[(xe&&!h||!xe)&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"302px",minWidth:"302px",gap:"20px"},children:[e.jsx(ir,{id:Q}),e.jsx(or,{systemInfo:n,compact:!0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",gap:xe&&h?"10px":"20px"},children:[A&&e.jsx(zn,{}),v&&e.jsx(Qn,{changelog:t}),xe&&h&&e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"10px"},children:[e.jsx(ir,{id:Q}),e.jsx(or,{systemInfo:n,compact:!0}),e.jsx(Gn,{matterbridgeInfo:l})]}),g&&!l.readOnly&&e.jsx(In,{}),g&&e.jsx(Rn,{storeId:Q,setStoreId:q}),x==="devices"&&e.jsx(En,{storeId:Q,setStoreId:q}),x==="logs"&&e.jsx(Un,{})]})]})}const Zn=r.memo(Jn),It=!1,ar={display:"flex",gap:"2px",justifyContent:"space-evenly",width:"100%",height:"40px"},Yn={margin:"0",padding:"0",fontSize:"36px",fontWeight:"medium",color:"var(--primary-color)"},Xn={margin:"0",padding:"0",fontSize:"20px",fontWeight:"medium",color:"var(--div-text-color)",textAlign:"center"},cr={margin:"0",padding:"0",paddingBottom:"2px",fontSize:"16px",fontWeight:"medium",color:"var(--div-text-color)",textAlign:"center"},ei={display:"flex",gap:"2px",justifyContent:"center",width:"100%",height:"18px",margin:"0",padding:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},ti={margin:"0",padding:"0",fontSize:"12px",fontWeight:"normal",color:"var(--div-text-color)"},ri={display:"flex",justifyContent:"center",width:"100%",height:"52px",margin:"0",padding:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},oi={margin:"0",padding:"0",fontSize:"14px",fontWeight:"bold",color:"var(--div-text-color)"},ni={display:"flex",gap:"4px",justifyContent:"center",width:"100%",height:"15px",margin:"0",padding:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},Ot={margin:"0",padding:"0px 4px",borderRadius:"5px",textAlign:"center",fontSize:"12px",fontWeight:"normal",color:"var(--secondary-color)"},ii=[256,257,268,269],si=[266,267],li=[259,260,261,271,272],ai=[256,257,268,269,266,267,259,260,261,272];function ee({icon:n,iconColor:a,cluster:l,value:i,unit:s,prefix:m}){return o&&console.log(`Render cluster "${l.clusterName}.${l.attributeName}" value(${typeof i}-${isNaN(i)}) "${i}" unit "${s}"`),m=m??!1,e.jsxs(ae,{sx:ar,children:[n&&r.cloneElement(n,{key:`${l.clusterId}-${l.attributeId}-icon`,sx:{...Yn,color:a??"var(--primary-color)"}}),e.jsxs(ae,{sx:{...ar,gap:"4px",alignContent:"center",alignItems:"end",justifyContent:"center"},children:[s&&m===!0&&e.jsx(he,{sx:cr,children:s},`${l.clusterId}-${l.attributeId}-unit`),e.jsx(he,{sx:Xn,children:i==null||typeof i=="number"&&isNaN(i)||i==="NaN"?"---":i},`${l.clusterId}-${l.attributeId}-value`),s&&m===!1&&e.jsx(he,{sx:cr,children:s},`${l.clusterId}-${l.attributeId}-unit`)]},`${l.clusterId}-${l.attributeId}-valueunitbox`)]},`${l.clusterId}-${l.attributeId}-box`)}function ci({device:n,endpoint:a,id:l,deviceType:i,clusters:s}){const m=["Unknown","Good","Fair","Moderate","Poor","VeryPoor","Ext.Poor"];let g="";const x=t=>s.find(v=>(v.clusterName==="Thermostat"||v.clusterName==="TemperatureMeasurement")&&v.attributeName===t)?.attributeUnit??"Â°C";o&&console.log(`Device "${n.name}" endpoint "${a}" id "${l}" deviceType "0x${i.toString(16).padStart(4,"0")}" clusters (${s?.length})`);const j=s.find(t=>t.clusterName==="Descriptor"&&t.attributeName==="tagList")?.attributeLocalValue;if(j){let t="";j.map(D=>{D.label&&(t+=D.label+" ")}),g=t.trim()}if(i===17&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="batVoltage").map(t=>g=`${t.attributeLocalValue} mV`),ai.includes(i)&&s.filter(t=>t.clusterName==="LevelControl"&&t.attributeName==="currentLevel").map(t=>g=`Level ${t.attributeValue}`),i===514&&s.filter(t=>t.clusterName==="WindowCovering"&&t.attributeName==="currentPositionLiftPercent100ths").map(t=>g=`Position ${t.attributeLocalValue/100}%`),i===769&&s.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="occupiedHeatingSetpoint").map(t=>g=`Heat ${t.attributeLocalValue/100}${x("occupiedHeatingSetpoint")} `),i===769&&s.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="occupiedCoolingSetpoint").map(t=>g=g+`Cool ${t.attributeLocalValue/100}${x("occupiedCoolingSetpoint")}`),i===118&&s.filter(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="coState").map(t=>g=`${t.attributeLocalValue===0?"No CO detected":"CO alarm!"}`),i===1296&&s.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="voltage").map(t=>g=`${t.attributeLocalValue/1e3} V, `),i===1296&&s.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="activeCurrent").map(t=>g=g+`${t.attributeLocalValue/1e3} A, `),i===1296&&s.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="activePower").map(t=>g=g+`${t.attributeLocalValue/1e3} W`),i===39){const t=s.find(v=>v.clusterName==="ModeSelect"&&v.attributeName==="currentMode")?.attributeLocalValue;g=s.find(v=>v.clusterName==="ModeSelect"&&v.attributeName==="supportedModes")?.attributeLocalValue?.find(v=>v.mode===t)?.label||"Unknown"}if(i===116){const t=s.find(v=>v.clusterName==="RvcRunMode"&&v.attributeName==="currentMode")?.attributeLocalValue;g=s.find(v=>v.clusterName==="RvcRunMode"&&v.attributeName==="supportedModes")?.attributeLocalValue?.find(v=>v.mode===t)?.label||"Unknown"}return e.jsxs(Ce,{style:{margin:"0px",padding:"5px",width:"150px",height:"150px",borderColor:"var(--div-bg-color)",borderRadius:"5px",justifyContent:"space-between"},children:[i===19&&s.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(ee,{icon:t.attributeLocalValue===!0?e.jsx(ut,{}):e.jsx(no,{}),iconColor:t.attributeLocalValue===!0?"green":"red",cluster:t,value:t.attributeLocalValue===!0?"Online":"Offline"})),i===17&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="batPercentRemaining").map(t=>e.jsx(ee,{icon:e.jsx(Je,{}),cluster:t,value:t.attributeLocalValue/2,unit:"%"})),i===17&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="wiredCurrentType").map(t=>e.jsx(ee,{icon:e.jsx(fr,{}),cluster:t,value:t.attributeLocalValue===0?"AC":"DC"})),i===1293&&s.filter(t=>t.clusterName==="DeviceEnergyManagement"&&t.attributeName==="esaState").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Vo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Offline":"Online"})),ii.includes(i)&&s.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(ee,{icon:e.jsx(io,{}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),si.includes(i)&&s.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Ao,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),li.includes(i)&&s.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Uo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),i===115&&s.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:qo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===124&&s.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:zo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===117&&s.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Bo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===123&&s.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(ee,{icon:e.jsx(Zt,{}),cluster:t,value:"Oven"})),i===112&&s.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(ee,{icon:e.jsx(so,{}),cluster:t,value:"Fridge"})),i===113&&s.filter(t=>t.clusterName==="TemperatureControl"&&t.attributeName==="selectedTemperatureLevel").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Qo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue,unit:"mode",prefix:!0})),i===121&&s.filter(t=>t.clusterName==="OperationalState"&&t.attributeName==="operationalState").map(t=>e.jsx(ee,{icon:e.jsx(Zt,{}),cluster:t,value:t.attributeLocalValue===0?"Normal":"Error"})),i===122&&s.filter(t=>t.clusterName==="FanControl"&&t.attributeName==="fanMode").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Ko,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue,unit:"mode",prefix:!0})),i===120&&s.filter(t=>t.clusterName==="BridgedDeviceBasicInformation"&&t.attributeName==="reachable").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:tr,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Cooktop"})),i===119&&s.filter(t=>t.clusterName==="TemperatureControl"&&t.attributeName==="selectedTemperatureLevel").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:tr,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue,unit:"mode",prefix:!0})),i===514&&s.filter(t=>t.clusterName==="WindowCovering"&&t.attributeName==="currentPositionLiftPercent100ths").map(t=>e.jsx(ee,{icon:e.jsx(lo,{}),cluster:t,value:t.attributeLocalValue/100,unit:"%"})),i===769&&s.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="localTemperature").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Go,size:"40px",color:"var(--primary-color)"}),cluster:t,value:(t.attributeLocalValue??0)/100,unit:t.attributeUnit??"Â°C"})),i===10&&s.filter(t=>t.clusterName==="DoorLock"&&t.attributeName==="lockState").map(t=>e.jsx(ee,{icon:t.attributeValue==="1"?e.jsx(ao,{}):e.jsx(co,{}),cluster:t,value:t.attributeValue==="1"?"Locked":"Unlocked"})),i===43&&s.filter(t=>t.clusterName==="FanControl"&&t.attributeName==="percentCurrent").map(t=>e.jsx(ee,{icon:e.jsx(po,{}),cluster:t,value:t.attributeValue,unit:"%"})),i===15&&s.filter(t=>t.clusterName==="Switch"&&t.attributeName==="currentPosition").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Jo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeValue,unit:"pos",prefix:!0})),i===39&&s.filter(t=>t.clusterName==="ModeSelect"&&t.attributeName==="currentMode").map(t=>e.jsx(ee,{icon:e.jsx(uo,{}),cluster:t,value:t.attributeValue,unit:"Mode",prefix:!0})),i===771&&s.filter(t=>t.clusterName==="OnOff"&&t.attributeName==="onOff").map(t=>e.jsx(ee,{icon:e.jsx(go,{}),cluster:t,value:t.attributeLocalValue===!0?"On":"Off"})),i===45&&s.filter(t=>t.clusterName==="FanControl"&&t.attributeName==="percentCurrent").map(t=>e.jsx(ee,{icon:e.jsx(Yt,{}),cluster:t,value:t.attributeValue,unit:"%"})),i===114&&s.filter(t=>t.clusterName==="Thermostat"&&t.attributeName==="localTemperature").map(t=>e.jsx(ee,{icon:e.jsx(Yt,{}),cluster:t,value:(t.attributeLocalValue??0)/100,unit:t.attributeUnit??"Â°C"})),i===67&&s.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(ee,{icon:e.jsx(mo,{}),cluster:t,value:t.attributeLocalValue===!0?"Leak":"No leak"})),i===65&&s.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(ee,{icon:e.jsx(ho,{}),cluster:t,value:t.attributeLocalValue===!0?"Freeze":"No freeze"})),i===68&&s.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(ee,{icon:e.jsx(fo,{}),cluster:t,value:t.attributeLocalValue===!0?"Rain":"No rain"})),i===116&&s.filter(t=>t.clusterName==="RvcRunMode"&&t.attributeName==="currentMode").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Zo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeValue,unit:"Run mode",prefix:!0})),i===1292&&s.filter(t=>t.clusterName==="EnergyEvse"&&t.attributeName==="state").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Yo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"Free":"In use"})),i===1295&&s.filter(t=>t.clusterName==="WaterHeaterManagement"&&t.attributeName==="tankPercentage").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:Xo,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Tank "+(t.attributeLocalValue??0)+"%"})),i===777&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="featureMap").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:en,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"HeatPump"})),i===23&&s.filter(t=>t.clusterName==="PowerSource"&&t.attributeName==="featureMap").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:tn,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Solar"})),i===24&&s.filter(t=>t.clusterName==="ElectricalPowerMeasurement"&&t.attributeName==="featureMap").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:rn,size:"40px",color:"var(--primary-color)"}),cluster:t,value:"Inverter"})),i===118&&s.find(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="featureMap"&&t.attributeLocalValue.smokeAlarm===!0)&&s.filter(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="smokeState").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:rr,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"No smoke":"Smoke!"})),i===118&&s.find(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="featureMap"&&t.attributeLocalValue.smokeAlarm===!1)&&s.filter(t=>t.clusterName==="SmokeCoAlarm"&&t.attributeName==="coState").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:rr,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue===0?"No Co":"Co!"})),i===66&&s.filter(t=>t.clusterName==="ValveConfigurationAndControl"&&t.attributeName==="currentState").map(t=>e.jsx(ee,{icon:e.jsx(xo,{}),cluster:t,value:t.attributeLocalValue===0?"Closed":"Opened"})),i===44&&s.filter(t=>t.clusterName==="AirQuality"&&t.attributeName==="airQuality").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:on,size:"40px",color:"var(--primary-color)"}),cluster:t,value:m[t.attributeLocalValue??0]})),i===770&&s.filter(t=>t.clusterName==="TemperatureMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(ee,{icon:e.jsx(bo,{}),cluster:t,value:t.attributeLocalValue/100,unit:t.attributeUnit??"Â°C"})),i===775&&s.filter(t=>t.clusterName==="RelativeHumidityMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(ee,{icon:e.jsx(ce,{path:nn,size:"40px",color:"var(--primary-color)"}),cluster:t,value:t.attributeLocalValue/100,unit:"%"})),i===774&&s.filter(t=>t.clusterName==="FlowMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(ee,{icon:e.jsx(vo,{}),cluster:t,value:t.attributeLocalValue,unit:"l/h"})),i===773&&s.filter(t=>t.clusterName==="PressureMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(ee,{icon:e.jsx(yo,{}),cluster:t,value:t.attributeLocalValue,unit:"hPa"})),i===21&&s.filter(t=>t.clusterName==="BooleanState"&&t.attributeName==="stateValue").map(t=>e.jsx(ee,{icon:t.attributeValue==="true"?e.jsx(jo,{}):e.jsx(Co,{}),cluster:t,value:t.attributeValue==="true"?"Closed":"Opened"})),i===263&&s.filter(t=>t.clusterName==="OccupancySensing"&&t.attributeName==="occupancy").map(t=>e.jsx(ee,{icon:t.attributeValue==="{ occupied: true }"?e.jsx(wo,{}):e.jsx(So,{}),cluster:t,value:t.attributeValue==="{ occupied: true }"?"Occupied":"Unocc."})),i===262&&s.filter(t=>t.clusterName==="IlluminanceMeasurement"&&t.attributeName==="measuredValue").map(t=>e.jsx(ee,{icon:e.jsx(ko,{}),cluster:t,value:Math.round(Math.pow(10,t.attributeLocalValue/1e4)),unit:"lx"})),i===1296&&s.filter(t=>t.clusterName==="ElectricalEnergyMeasurement"&&t.attributeName==="cumulativeEnergyImported").map(t=>e.jsx(ee,{icon:e.jsx(Io,{}),cluster:t,value:Math.round(t.attributeLocalValue?.energy/1e6),unit:"kwh"})),e.jsx(ae,{sx:ei,children:e.jsx(he,{sx:ti,children:g})}),e.jsx(ae,{sx:ri,children:e.jsx(he,{sx:oi,children:n.name})}),e.jsxs(ae,{sx:ni,children:[o&&e.jsx(he,{sx:Ot,children:a}),e.jsx(he,{sx:Ot,children:l}),o&&e.jsxs(he,{sx:Ot,children:["0x",i.toString(16).padStart(4,"0")]})]})]})}function di({filter:n}){const{online:a,sendMessage:l,addListener:i,removeListener:s,getUniqueId:m}=r.useContext(ve),[g,x]=r.useState([]),[j,t]=r.useState({}),[D,v]=r.useState({}),[S,A]=r.useState({}),Y=r.useRef(m()),Q=r.useCallback(c=>{(o||It)&&console.log(`DevicesIcons received state_update "${c.response.cluster}.${c.response.attribute}" for "${c.response.id}:${c.response.number}": "${c.response.value}"`,c.response);const u=g.find(I=>I.pluginName===c.response.plugin&&I.serial===c.response.serialNumber);if(!u){(o||It)&&console.warn(`DevicesIcons updater device of plugin "${c.response.plugin}" serial "${c.response.serialNumber}" number "${c.response.number}" id "${c.response.id}" not found in devices(${g.length})`);return}const k=S[u.serial]?.find(I=>I.endpoint===c.response.number.toString()&&I.clusterName===c.response.cluster&&I.attributeName===c.response.attribute);if(!k){(o||It)&&console.warn(`DevicesIcons updater device "${u.name}" serial "${u.serial}" cluster "${c.response.cluster}" attribute "${c.response.attribute}" not found in clusters(${S[u.serial]?.length})`);return}k.attributeValue=String(c.response.value),k.attributeLocalValue=c.response.value,A({...S}),(o||It)&&console.log(`DevicesIcons updated "${k.clusterName}.${k.attributeName}" for device "${u.name}" serial "${u.serial}" to "${k.attributeValue}"`)},[S,g]),q=r.useCallback(c=>{if(o&&console.log(`DevicesIcons received for device "${c.response.deviceName}" serial "${c.response.serialNumber}" deviceTypes (${c.response.deviceTypes.length}) "${c.response.deviceTypes.join(",")}" clusters (${c.response.clusters.length}):`,c.response),c.response.clusters.length===0)return;const u=c.response.serialNumber;j[u]=[],D[u]=c.response.deviceTypes,S[u]=[];for(const k of c.response.clusters)j[u].find(I=>I.endpoint===k.endpoint)||j[u].push({endpoint:k.endpoint,id:k.id,deviceTypes:k.deviceTypes}),!["FixedLabel","Identify","Groups","PowerTopology"].includes(k.clusterName)&&S[u].push(k);t({...j}),v({...D}),A({...S}),o&&console.log(`DevicesIcons endpoints for "${u}":`,j[u]),o&&console.log(`DevicesIcons deviceTypes for "${u}":`,D[u]),o&&console.log(`DevicesIcons clusters for "${u}":`,S[u])},[S,D,j]);r.useEffect(()=>{const c=u=>{if(o&&console.log("DevicesIcons received WebSocket Message:",u),u.method==="refresh_required")o&&console.log(`DevicesIcons received refresh_required: changed=${u.response.changed} and sending api requests`),l({id:Y.current,sender:"DevicesIcons",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}});else if(u.method==="state_update"&&u.response)Q(u);else if(u.method==="/api/devices"&&u.response){o&&console.log(`DevicesIcons received ${u.response.length} devices:`,u.response),x(u.response),t({}),v({}),A({});for(const k of u.response)o&&console.log("DevicesIcons sending /api/clusters"),l({id:Y.current,sender:"DevicesIcons",method:"/api/clusters",src:"Frontend",dst:"Matterbridge",params:{plugin:k.pluginName,endpoint:k.endpoint||0}})}else u.method==="/api/clusters"&&u.response&&q(u)};return i(c,Y.current),o&&console.log("DevicesIcons WebSocket effect mounted"),()=>{s(c),o&&console.log("DevicesIcons WebSocket effect unmounted")}},[g]),r.useEffect(()=>(o&&console.log("DevicesIcons useEffect online mounting"),a&&(o&&console.log("DevicesIcons useEffect online sending api requests"),l({id:Y.current,sender:"DevicesIcons",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}})),o&&console.log("DevicesIcons useEffect online mounted"),()=>{o&&console.log("DevicesIcons useEffect online unmounted")}),[a,l]);const h=r.memo(ci);return o&&console.log("DevicesIcons rendering..."),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",paddingBottom:"5px",gap:"20px",width:"100%",overflow:"auto"},children:g.filter(c=>c.name.toLowerCase().includes(n)||c.serial.toLowerCase().includes(n)).map(c=>j[c.serial]&&j[c.serial].map(u=>u.deviceTypes.map(k=>e.jsx(h,{device:c,endpoint:u.endpoint,id:u.id,deviceType:k,clusters:S[c.serial].filter(I=>I.endpoint===u.endpoint)},`${c.pluginName}-${c.uniqueId}-${u.endpoint}-${u.id}-${k.toString()}`))))})}const pi=r.memo(di),ui="follow_system",gi=[{value:"none",label:"No conversion"},{value:"celsius",label:"Celsius"},{value:"fahrenheit",label:"Fahrenheit"}],mi=[{value:"follow_system",label:"Follow Matterbridge system settings"},{value:"none",label:"No conversion"},{value:"force_celsius",label:"Force Celsius"},{value:"force_fahrenheit",label:"Force Fahrenheit"}],hi=[{label:"Plugin name",id:"pluginName",required:!0},{label:"Device type",id:"type"},{label:"Endpoint",id:"endpoint",align:"right"},{label:"Name",id:"name",required:!0},{label:"Serial number",id:"serial"},{label:"Unique ID",id:"uniqueId"},{label:"Url",id:"configUrl"},{label:"Config",id:"configButton",noSort:!0,render:(n,a,l,i)=>l.configUrl?e.jsx(G,{onClick:()=>window.open(l.configUrl,"_blank"),"aria-label":"Open Config",sx:{margin:0,padding:0},children:e.jsx(xr,{fontSize:"small"})}):null},{label:"Cluster",id:"cluster"}],fi=[{label:"Endpoint",id:"endpoint",required:!0},{label:"Id",id:"id"},{label:"Device Types",id:"deviceTypes",render:(n,a,l,i)=>Array.isArray(n)?e.jsx(e.Fragment,{children:n.map(s=>`0x${s.toString(16).padStart(4,"0")}`).join(", ")}):e.jsx(e.Fragment,{children:n})},{label:"Cluster Name",id:"clusterName",required:!0},{label:"Cluster ID",id:"clusterId"},{label:"Attribute Name",id:"attributeName",required:!0},{label:"Attribute ID",id:"attributeId"},{label:"Attribute Value",id:"attributeValue",required:!0,maxWidth:350,tooltip:!0}],xi=n=>`${n.pluginName}::${n.uniqueId}`,bi=n=>`${n.endpoint}::${n.clusterName}::${n.attributeName}`;function vi({filter:n}){const{online:a,sendMessage:l,addListener:i,removeListener:s,getUniqueId:m}=r.useContext(ve),[g,x]=r.useState([]),[j,t]=r.useState(g),[D,v]=r.useState([]),[S,A]=r.useState(0),[Y,Q]=r.useState({}),[q,h]=r.useState(null),[c,u]=r.useState(null),[k,I]=r.useState(null),[N,H]=r.useState(null),ne=r.useRef(m()),y=r.useRef(j),p=r.useCallback($=>{o&&console.log(`DevicesTable received state_update "${$.response.cluster}.${$.response.attribute}" for "${$.response.id}:${$.response.number}": "${$.response.value}"`,$.response);const V=y.current.find(ie=>ie.pluginName===$.response.plugin&&ie.uniqueId===$.response.uniqueId);if(!V){o&&console.warn(`DevicesTable updater device of plugin "${$.response.plugin}" serial "${$.response.serialNumber}" not found in filteredDevicesRef.current`);return}if(q&&c&&V.pluginName===q&&V.uniqueId===N&&$.response.number.toString()===c){const ie=D.find(K=>K.endpoint===$.response.number.toString()&&K.clusterName===$.response.cluster&&K.attributeName===$.response.attribute);if(!ie){o&&console.warn(`DevicesTable updater cluster ${$.response.cluster}.${$.response.attribute} for device "${V.name}" serial "${V.serial}" not found in clusters`);return}ie.attributeValue=typeof $.response.value=="object"?JSON.stringify($.response.value,void 0,1).replaceAll('"',""):String($.response.value),ie.attributeLocalValue=$.response.value,v([...D]),o&&console.log(`DevicesTable updated attribute ${ie.clusterName}.${ie.attributeName} for device "${V.name}" serial "${V.serial}" to "${ie.attributeValue}"`)}},[D,c,q,N]);r.useEffect(()=>{const $=V=>{if(o&&console.log("DevicesTable received WebSocket Message:",V),V.method==="refresh_required"&&V.response.changed==="devices")o&&console.log(`DevicesTable received refresh_required: changed=${V.response.changed} and sending /api/devices request`),l({id:ne.current,sender:"DevicesTable",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}});else if(V.method==="refresh_required"&&V.response.changed==="settings")o&&console.log(`DevicesTable received refresh_required: changed=${V.response.changed} and sending /api/settings request`),l({id:ne.current,sender:"DevicesTable",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}});else if(V.method==="state_update"&&V.response)p(V);else if(V.method==="/api/devices")o&&console.log(`DevicesTable received ${V.response.length} devices:`,V.response),x(V.response);else if(V.method==="/api/settings")o&&console.log("DevicesTable received /api/settings:",V.response),Q(V.response?.matterbridgeInformation?.temperatureDeviceConversions??{});else if(V.method==="/api/clusters"){o&&console.log(`DevicesTable received ${V.response.clusters.length} clusters for plugin ${V.response.plugin}:`,V.response),v(V.response.clusters);const ie={};for(const K of V.response.clusters)o&&console.log("Cluster:",K.endpoint),ie[K.endpoint]?ie[K.endpoint]++:ie[K.endpoint]=1;A(Object.keys(ie).length)}};return i($,ne.current),o&&console.log("DevicesTable added WebSocket listener"),()=>{s($),o&&console.log("DevicesTable removed WebSocket listener")}},[l,i,s,p]),r.useEffect(()=>{a&&(o&&console.log("DevicesTable sending api requests with id ",ne.current),l({id:ne.current,sender:"DevicesTable",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),l({id:ne.current,sender:"DevicesTable",method:"/api/plugins",src:"Frontend",dst:"Matterbridge",params:{}}),l({id:ne.current,sender:"DevicesTable",method:"/api/devices",src:"Frontend",dst:"Matterbridge",params:{}}))},[a,l]),r.useEffect(()=>{q&&c&&(o&&console.log("DevicesTable sending /api/clusters"),l({id:ne.current,sender:"DevicesTable",method:"/api/clusters",src:"Frontend",dst:"Matterbridge",params:{plugin:q,endpoint:Number(c)}}))},[q,c,l]),r.useEffect(()=>{if(n===""){t(g),y.current=g;return}const $=g.filter(V=>V.name.toLowerCase().includes(n)||V.serial.toLowerCase().includes(n));t($),y.current=$},[g,n]);const d=$=>{if($.uniqueId===N){H(null),h(null),u(null),I(null);return}H($.uniqueId),h($.pluginName),u($.endpoint?$.endpoint.toString():null),I($.name)},b=$=>$.cluster.includes("Temperature:")||$.cluster.includes("Heat to:")||$.cluster.includes("Cool to:"),F=($,V)=>{if($.stopPropagation(),!V.uniqueId)return;const ie=$.target.value;Q(K=>({...K,[V.uniqueId]:ie})),l({id:ne.current,sender:"DevicesTable",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setdevicetemperatureconversion",uniqueId:V.uniqueId,value:ie}})},_=[...hi,{label:"Temp conversion",id:"temperatureConversion",render:($,V,ie)=>{if(!b(ie))return null;const K=Y[ie.uniqueId]??ui;return e.jsx(ze,{size:"small",value:K,onChange:te=>F(te,ie),onClick:te=>te.stopPropagation(),style:{height:"30px",minWidth:"220px"},children:mi.map(te=>e.jsx(w,{value:te.value,children:te.label},te.value))})}}];return o&&console.log("DevicesTable rendering..."),a?e.jsxs("div",{style:{display:"flex",flexDirection:"column",margin:"0px",padding:"0px",gap:"20px",width:"100%",overflow:"hidden"},children:[e.jsx(Ce,{style:{margin:"0px",padding:"0px",gap:"0px",width:"100%",maxHeight:`${q&&c?"30%":"100%"}`,flex:"1 1 auto",overflow:"hidden"},children:e.jsx(Tt,{name:"Registered devices",getRowKey:xi,onRowClick:d,rows:j,columns:_,footerLeft:`Total devices: ${j.length.toString()}`})}),q&&c&&e.jsx(Ce,{style:{margin:"0px",padding:"0px",gap:"0px",width:"100%",height:"70%",maxHeight:"70%",flex:"1 1 auto",overflow:"hidden"},children:e.jsx(Tt,{name:"Clusters",title:k||"",getRowKey:bi,rows:D,columns:fi,footerLeft:`Total child endpoints: ${S-1}`})})]}):e.jsx(Oe,{})}const yi=r.memo(vi);function ji(){const{online:n}=r.useContext(ve),[a,l]=r.useState(""),[i,s]=r.useState("icon");r.useEffect(()=>{const x=localStorage.getItem(oe.devicesFilter);x&&l(x)},[]),r.useEffect(()=>{const x=localStorage.getItem(oe.devicesViewMode);x&&s(x)},[]);const m=x=>{l(x.target.value.toLowerCase()),localStorage.setItem(oe.devicesFilter,x.target.value.toLowerCase())},g=x=>{s(x),localStorage.setItem(oe.devicesViewMode,x)};return o&&console.log("Devices rendering..."),n?e.jsxs(ht,{name:"Devices",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",padding:0,margin:0,gap:"20px",width:"100%"},children:[e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(he,{sx:{fontSize:"16px",fontWeight:"normal",color:"var(--div-text-color)",marginLeft:"5px",whiteSpace:"nowrap"},children:"Filter by:"}),e.jsx(be,{variant:"outlined",value:a,onChange:m,placeholder:"Enter the device name or serial",sx:{width:"260px"},InputProps:{style:{backgroundColor:"var(--main-bg-color)"}}})]}),e.jsxs(ae,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(he,{sx:{fontSize:"16px",fontWeight:"normal",color:"var(--div-text-color)",marginLeft:"5px",whiteSpace:"nowrap"},children:"View mode:"}),e.jsx(G,{onClick:()=>g("table"),"aria-label":"Table View",disabled:i==="table",children:e.jsx(E,{title:"Table View",children:e.jsx(Mo,{style:{color:i==="table"?"var(--main-icon-color)":"var(--primary-color)"}})})}),e.jsx(G,{onClick:()=>g("icon"),"aria-label":"Icon View",disabled:i==="icon",children:e.jsx(E,{title:"Icon View (beta)",children:e.jsx(Do,{style:{color:i==="icon"?"var(--main-icon-color)":"var(--primary-color)"}})})})]})]}),i==="table"&&e.jsx(yi,{filter:a}),i==="icon"&&e.jsx(pi,{filter:a})]}):e.jsx(Oe,{})}const Ci=r.memo(ji);function wi(){const{logLength:n,logAutoScroll:a,setMessages:l,setLogFilterLevel:i,setLogFilterSearch:s,online:m,filterLogMessages:g}=r.useContext(ve),[x,j]=r.useState(localStorage.getItem(oe.logFilterLevel)??"info"),[t,D]=r.useState(localStorage.getItem(oe.logFilterSearch)??"*"),[v,S]=r.useState(n.current.toString()),[A,Y]=r.useState(a.current),Q=k=>{const I=k.target.value;j(I),i(I),g(I,t),localStorage.setItem(oe.logFilterLevel,I),o&&console.log("handleLogFilterLevelChange called with value:",I)},q=k=>{const I=k.target.value;D(I),s(I),g(x,I),localStorage.setItem(oe.logFilterSearch,I),o&&console.log("handleLogFilterSearchChange called with value:",I)},h=k=>{const I=k.target.checked;Y(I),a.current=I,g(x,t),localStorage.setItem(oe.logAutoScroll,I?"true":"false"),o&&console.log("handleAutoScrollChange called with value:",I)},c=k=>{const I=k.target.value;S(I),n.current=Number(I),localStorage.setItem(oe.logLength,I),o&&console.log("handleLogLengthChange called with value:",I)},u=()=>{o&&console.log("handleClearLogsClick called"),l([])};return o&&console.log("Logs rendering..."),m?e.jsxs(ht,{name:"Logs",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",margin:"0px",padding:"0px",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx(Ft,{id:"select-level",style:{color:"var(--div-text-color)"},children:"Filter log by level:"}),e.jsxs(ze,{style:{height:"30px",backgroundColor:"var(--main-bg-color)"},labelId:"select-level",id:"debug-level",value:x,onChange:Q,children:[e.jsx(w,{value:"debug",children:"Debug"}),e.jsx(w,{value:"info",children:"Info"}),e.jsx(w,{value:"notice",children:"Notice"}),e.jsx(w,{value:"warn",children:"Warn"}),e.jsx(w,{value:"error",children:"Error"}),e.jsx(w,{value:"fatal",children:"Fatal"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"5px"},children:[e.jsx(Ft,{id:"search",style:{color:"var(--div-text-color)"},children:"Filter log by text:"}),e.jsx(E,{title:"Use /text/ for case-insensitive regex search",children:e.jsx(be,{style:{width:"210px"},size:"small",id:"logsearch",variant:"outlined",value:t,onChange:q,slotProps:{input:{style:{height:"30px",padding:"0 0px",backgroundColor:"var(--main-bg-color)"}}}})})]}),e.jsx(Ye,{control:e.jsx(Be,{checked:A,onChange:h}),label:"Auto scroll",style:{color:"var(--div-text-color)"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[e.jsx(Ft,{id:"select-size-label",style:{color:"var(--div-text-color)"},children:"Log length:"}),e.jsxs(ze,{style:{height:"30px",backgroundColor:"var(--main-bg-color)"},labelId:"select-size-label",id:"select-size",value:v,onChange:c,children:[e.jsx(w,{value:100,children:"100"}),e.jsx(w,{value:200,children:"200"}),e.jsx(w,{value:500,children:"500"}),e.jsx(w,{value:1e3,children:"1000"})]}),e.jsx(E,{title:"Clear the logs",children:e.jsx(de,{onClick:u,endIcon:e.jsx(Ht,{}),style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",height:"30px"},children:"Clear"})})]})]}),e.jsx("div",{style:{flex:"1",overflow:"auto",margin:"0px",padding:"0px"},children:e.jsx(Sr,{})})]}):e.jsx(Oe,{})}const Si=r.memo(wi),ki=({open:n,ip:a,onClose:l,onSave:i})=>{const s=a?a.split(".").slice(0,3).join(".")+".1":"",[m,g]=r.useState("dhcp"),[x,j]=r.useState({ip:a??"",subnet:"255.255.255.0",gateway:s,dns:s}),t=S=>A=>{j({...x,[S]:A.target.value})},D=()=>{l()},v=()=>{i({type:m,...x}),l()};return e.jsxs(He,{open:n,onClose:(S,A)=>{A==="backdropClick"||A==="escapeKeyDown"||l()},maxWidth:"sm",style:{maxWidth:"550px",margin:"auto"},children:[e.jsx(Ve,{gap:"20px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:"Network Configuration"})]})}),e.jsxs(Ae,{dividers:!0,children:[e.jsxs(vr,{component:"fieldset",fullWidth:!0,children:[e.jsx(we,{component:"legend",children:"Select IP Configuration"}),e.jsxs(yr,{row:!0,value:m,onChange:S=>g(S.target.value),children:[e.jsx(Ye,{value:"dhcp",control:e.jsx($t,{}),label:"DHCP"}),e.jsx(Ye,{value:"static",control:e.jsx($t,{}),label:"Static"})]})]}),m==="static"&&e.jsxs(Ke,{container:!0,spacing:2,sx:{mt:2},children:[e.jsx(Ke,{size:6,children:e.jsx(be,{label:"IP Address",fullWidth:!0,value:x.ip,onChange:t("ip")})}),e.jsx(Ke,{size:6,children:e.jsx(be,{label:"Subnet Mask",fullWidth:!0,value:x.subnet,onChange:t("subnet")})}),e.jsx(Ke,{size:6,children:e.jsx(be,{label:"Gateway",fullWidth:!0,value:x.gateway,onChange:t("gateway")})}),e.jsx(Ke,{size:6,children:e.jsx(be,{label:"DNS Server",fullWidth:!0,value:x.dns,onChange:t("dns")})})]})]}),e.jsxs(Ge,{children:[e.jsx(de,{onClick:D,children:"Cancel"}),e.jsx(de,{variant:"contained",onClick:v,children:"Save"})]})]})},Ii=({open:n,onClose:a,onSave:l})=>{const[i,s]=r.useState(""),[m,g]=r.useState(""),x=A=>{s(A.target.value)},j=A=>{g(A.target.value)},t=i.length>0&&i===m,D=()=>{a()},v=()=>{t&&(l(i),a())},S=()=>{l(""),a()};return e.jsxs(He,{open:n,onClose:(A,Y)=>{Y==="backdropClick"||Y==="escapeKeyDown"||a()},maxWidth:"sm",style:{maxWidth:"500px",margin:"auto"},disableEscapeKeyDown:!0,children:[e.jsx(Ve,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h4",{style:{margin:0},children:"Change Password"})]})}),e.jsx(Ae,{dividers:!0,children:e.jsx(vr,{component:"fieldset",fullWidth:!0,sx:{margin:0,padding:0,gap:"20px"},children:e.jsxs(Ke,{container:!0,spacing:2,sx:{mt:2},children:[e.jsx(Ke,{size:12,children:e.jsx(be,{type:"password",autoComplete:"new-password",label:"New Password",size:"small",variant:"outlined",fullWidth:!0,value:i,onChange:x})}),e.jsx(Ke,{size:12,children:e.jsx(be,{type:"password",autoComplete:"new-password",label:"Confirm Password",size:"small",variant:"outlined",fullWidth:!0,value:m,onChange:j,error:m!==""&&i!==m,helperText:m!==""&&i!==m?"Passwords do not match":""})})]})})}),e.jsxs(Ge,{children:[e.jsx(de,{onClick:D,children:"Cancel"}),e.jsx(de,{variant:"contained",onClick:v,disabled:!t,children:"Change"}),e.jsx(de,{variant:"contained",onClick:S,children:"Reset"})]})]})};function nt(n=1e3){let a=null;const l=(i=>{a!==null&&window.clearTimeout(a),a=window.setTimeout(()=>{i(),a=null},n)});return l.cancel=()=>{a!==null&&(window.clearTimeout(a),a=null)},l}const Wt=330;function Mi(){const{mobile:n}=r.useContext(Le),{online:a,addListener:l,removeListener:i,sendMessage:s,getUniqueId:m}=r.useContext(ve),[g,x]=r.useState(null),[j,t]=r.useState(null),D=r.useRef(m());return r.useEffect(()=>{const v=S=>{o&&console.log("Settings received WebSocket Message:",S),S.method==="refresh_required"&&S.response.changed==="settings"?(o&&console.log(`Settings received refresh_required: changed=${S.response.changed} and sending /api/settings request`),s({id:D.current,sender:"Settings",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})):S.method==="/api/settings"&&(o&&console.log("Settings received /api/settings:",S.response),x(S.response.matterbridgeInformation),t(S.response.systemInformation))};return l(v,D.current),o&&console.log("Settings added WebSocket listener"),()=>{i(v),o&&console.log("Settings removed WebSocket listener")}},[l,i,s]),r.useEffect(()=>{a&&(o&&console.log("Settings received online"),s({id:D.current,sender:"Settings",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}))},[a,s]),o&&console.log("Settings rendering..."),!a||!g||!j?e.jsx(Oe,{}):e.jsx(ht,{name:"Settings",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:xe&&n?"10px":"20px"},children:[e.jsx(Di,{matterbridgeInfo:g,systemInfo:j}),e.jsx(Pi,{matterbridgeInfo:g}),e.jsx(Li,{matterbridgeInfo:g}),e.jsx($i,{systemInfo:j})]})})}function Di({matterbridgeInfo:n,systemInfo:a}){const{sendMessage:l,getUniqueId:i}=r.useContext(ve),[s,m]=r.useState("bridge"),[g,x]=r.useState("Info"),[j,t]=r.useState(!1),[D,v]=r.useState("dark"),[S,A]=r.useState(localStorage.getItem(oe.homePagePlugins)!=="false"),[Y,Q]=r.useState(localStorage.getItem(oe.homePageMode)??"devices"),[q,h]=r.useState(localStorage.getItem(oe.virtualMode)??"outlet"),[c,u]=r.useState("none"),k=r.useRef(i()),[I,N]=r.useState(!1),H=()=>N(!1),ne=M=>{o&&console.log("handleSaveNetConfig called with config:",M),l({id:k.current,sender:"Settings",method:"/api/shellynetconfig",src:"Frontend",dst:"Matterbridge",params:M})},[y,p]=r.useState(!1),d=()=>p(!1),b=M=>{o&&console.log("handleSaveChangePassword called with password:",M),l({id:k.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setpassword",value:M}}),Ui(M)};r.useEffect(()=>{n&&(m(n.bridgeMode==="bridge"?"bridge":"childbridge"),x(n.loggerLevel.charAt(0).toUpperCase()+n.loggerLevel.slice(1)),t(n.fileLogger),h(n.virtualMode),u(n.temperatureConversion))},[n]),r.useEffect(()=>{const M=localStorage.getItem(oe.frontendTheme);M&&v(M)},[]);const F=M=>{o&&console.log("handleChangeBridgeMode called with value:",M.target.value),m(M.target.value),l({id:k.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setbridgemode",value:M.target.value}})},_=M=>{o&&console.log("handleChangeMbLoggerLevel called with value:",M.target.value),x(M.target.value),l({id:k.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmbloglevel",value:M.target.value}})},$=M=>{o&&console.log("handleLogOnFileMbChange called with value:",M.target.checked),t(M.target.checked),l({id:k.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmblogfile",value:M.target.checked}})},V=M=>{const C=M.target.value;o&&console.log("handleChangeTheme called with value:",C),v(C),localStorage.setItem(oe.frontendTheme,C),document.body.setAttribute("frontend-theme",C)},ie=M=>{const C=M.target.checked;o&&console.log("handleChangeHomePagePlugins called with value:",C),A(C),localStorage.setItem(oe.homePagePlugins,C?"true":"false")},K=M=>{const C=M.target.value;o&&console.log("handleChangeHomePageMode called with value:",C),Q(C),localStorage.setItem(oe.homePageMode,C)},te=M=>{const C=M.target.value;o&&console.log("handleChangeVirtualMode called with value:",C),h(C),localStorage.setItem(oe.virtualMode,C),l({id:k.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setvirtualmode",value:C}})},R=M=>{const C=M.target.value;o&&console.log("handleChangeTemperatureConversion called with value:",C),u(C),l({id:k.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"settemperatureconversion",value:C}})};return!n||!a?null:e.jsxs(Ce,{style:{flex:`1 1 ${Wt}px`},children:[e.jsx(De,{children:e.jsx(Se,{children:"Matterbridge settings"})}),e.jsx(ki,{open:I,ip:a.ipv4Address,onClose:H,onSave:ne}),e.jsx(Ii,{open:y,onClose:d,onSave:b}),e.jsxs(Ne,{style:{flexDirection:"column",padding:"10px",gap:"0px",backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"matterbridgeInfo-mode",children:"Mode:"}),e.jsxs(yr,{row:!0,name:"mode-buttons-group",value:s,onChange:F,children:[e.jsx(Ye,{value:"bridge",control:e.jsx($t,{}),label:"Bridge",disabled:n.readOnly===!0}),e.jsx(Ye,{value:"childbridge",control:e.jsx($t,{}),label:"Childbridge",disabled:n.readOnly===!0})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px",gap:"15px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"mblogger-level-label",children:"Logger level:"}),e.jsxs(ze,{style:{height:"30px"},labelId:"mblogger-level-label",id:"mblogger-level",value:g,onChange:_,children:[e.jsx(w,{value:"Debug",children:"Debug"}),e.jsx(w,{value:"Info",children:"Info"}),e.jsx(w,{value:"Notice",children:"Notice"}),e.jsx(w,{value:"Warn",children:"Warn"}),e.jsx(w,{value:"Error",children:"Error"}),e.jsx(w,{value:"Fatal",children:"Fatal"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"mblogger-file-label",children:"Log on file:"}),e.jsx(Be,{checked:j,onChange:$,id:"mblogger-file",name:"logOnFileMb"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"5px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"frontend-theme-label",children:"Frontend theme:"}),e.jsxs(ze,{style:{height:"30px"},labelId:"frontend-theme-label",id:"frontend-theme",value:D,onChange:V,children:[e.jsx(w,{value:"classic",children:"Classic"}),e.jsx(w,{value:"light",children:"Light"}),e.jsx(w,{value:"dark",children:"Dark"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"5px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"frontend-home-plugin-label",children:"Home page pluginsz:"}),e.jsx(Be,{checked:S,onChange:ie,name:"showPlugins"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"5px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"frontend-home-label",children:"Home page bottom panel:"}),e.jsxs(ze,{style:{height:"30px"},labelId:"frontend-home-label",id:"frontend-home",value:Y,onChange:K,children:[e.jsx(w,{value:"logs",children:"Logs"}),e.jsx(w,{value:"devices",children:"Devices"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"10px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"frontend-virtual-label",children:"Virtual devices:"}),e.jsxs(ze,{style:{height:"30px"},labelId:"frontend-virtual-label",id:"frontend-virtual",value:q,onChange:te,children:[e.jsx(w,{value:"disabled",children:"Disabled"}),e.jsx(w,{value:"outlet",children:"Outlet"}),e.jsx(w,{value:"light",children:"Light"}),e.jsx(w,{value:"switch",children:"Switch"}),e.jsx(w,{value:"mounted_switch",children:"Mounted Switch"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"10px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"frontend-temperature-conversion-label",children:"Convert temps to:"}),e.jsx(ze,{style:{height:"30px"},labelId:"frontend-temperature-conversion-label",id:"frontend-temperature-conversion",value:c,onChange:R,children:gi.map(M=>e.jsx(w,{value:M.value,children:M.label},M.value))})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"20px"},children:e.jsx(de,{variant:"contained",color:"primary",onClick:()=>p(!0),children:"Change password"})}),n.shellyBoard&&e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginTop:"20px"},children:e.jsx(de,{variant:"contained",color:"primary",onClick:()=>N(!0),children:"Configure IP"})})]})]})}function Pi({matterbridgeInfo:n}){const{sendMessage:a,getUniqueId:l}=r.useContext(ve),[i,s]=r.useState("Info"),[m,g]=r.useState(!1),[x,j]=r.useState(""),[t,D]=r.useState(""),[v,S]=r.useState(""),[A,Y]=r.useState(""),[Q,q]=r.useState(""),[h,c]=r.useState(""),u=r.useRef(l()),k=r.useMemo(()=>nt(1e3),[]),I=r.useMemo(()=>nt(1e3),[]),N=r.useMemo(()=>nt(1e3),[]),H=r.useMemo(()=>nt(1e3),[]),ne=r.useMemo(()=>nt(1e3),[]),y=r.useMemo(()=>nt(1e3),[]);r.useEffect(()=>{n&&(s(["Debug","Info","Notice","Warn","Error","Fatal"][n.matterLoggerLevel]),g(n.matterFileLogger),j(n.matterMdnsInterface||""),D(n.matterIpv4Address||""),S(n.matterIpv6Address||""),Y(n.matterPort?n.matterPort.toString():""),q(n.matterDiscriminator?n.matterDiscriminator.toString():""),c(n.matterPasscode?n.matterPasscode.toString():""))},[n]),r.useEffect(()=>()=>k.cancel(),[k]),r.useEffect(()=>()=>I.cancel(),[I]),r.useEffect(()=>()=>N.cancel(),[N]),r.useEffect(()=>()=>H.cancel(),[H]),r.useEffect(()=>()=>ne.cancel(),[ne]),r.useEffect(()=>()=>y.cancel(),[y]);const p=K=>{o&&console.log("handleChangeMjLoggerLevel called with value:",K.target.value),s(K.target.value),a({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmjloglevel",value:K.target.value}})},d=K=>{o&&console.log("handleLogOnFileMjChange called with value:",K.target.checked),g(K.target.checked),a({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmjlogfile",value:K.target.checked}})},b=K=>{o&&console.log("handleChangeMdnsInterface called with value:",K.target.value);const te=K.target.value;j(te),k(()=>{o&&console.log("debounced sendMessage setmdnsinterface with value:",te),a({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmdnsinterface",value:te}})})},F=K=>{o&&console.log("handleChangeIpv4Address called with value:",K.target.value);const te=K.target.value;D(te),I(()=>{o&&console.log("debounced sendMessage setipv4address with value:",te),a({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setipv4address",value:te}})})},_=K=>{o&&console.log("handleChangeIpv6Address called with value:",K.target.value);const te=K.target.value;S(te),N(()=>{o&&console.log("debounced sendMessage setipv6address with value:",te),a({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setipv6address",value:te}})})},$=K=>{o&&console.log("handleChangeMatterPort called with value:",K.target.value);const te=K.target.value;Y(te),H(()=>{o&&console.log("debounced sendMessage setmatterport with value:",te),a({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmatterport",value:te}})})},V=K=>{o&&console.log("handleChangeMatterDiscriminator called with value:",K.target.value);const te=K.target.value;q(te),ne(()=>{o&&console.log("debounced sendMessage setmatterdiscriminator with value:",te),a({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmatterdiscriminator",value:te}})})},ie=K=>{o&&console.log("handleChangemMatterPasscode called with value:",K.target.value);const te=K.target.value;c(te),y(()=>{o&&console.log("debounced sendMessage setmatterpasscode with value:",te),a({id:u.current,sender:"Settings",method:"/api/config",src:"Frontend",dst:"Matterbridge",params:{name:"setmatterpasscode",value:te}})})};return n?e.jsxs(Ce,{style:{flex:`1 1 ${Wt}px`},children:[e.jsx(De,{children:e.jsx(Se,{children:"Matter settings"})}),e.jsxs(Ne,{style:{flexDirection:"column",padding:"10px",gap:"0px",backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px",gap:"15px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"mjlogger-level-label",children:"Logger level:"}),e.jsxs(ze,{style:{height:"30px"},labelId:"mjlogger-level-label",id:"mjlogger-level",value:i,onChange:p,children:[e.jsx(w,{value:"Debug",children:"Debug"}),e.jsx(w,{value:"Info",children:"Info"}),e.jsx(w,{value:"Notice",children:"Notice"}),e.jsx(w,{value:"Warn",children:"Warn"}),e.jsx(w,{value:"Error",children:"Error"}),e.jsx(w,{value:"Fatal",children:"Fatal"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px",gap:"10px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px"},id:"mjlogger-file-label",children:"Log on file:"}),e.jsx(Be,{checked:m,onChange:d,id:"mjlogger-file",name:"logOnFileMj"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Mdns interface:"}),e.jsx(be,{value:x,onChange:b,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Ipv4 address:"}),e.jsx(be,{value:t,onChange:F,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Ipv6 address:"}),e.jsx(be,{value:v,onChange:_,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Commissioning port:"}),e.jsx(be,{value:A,onChange:$,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Commissioning discriminator:"}),e.jsx(be,{value:Q,onChange:V,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",marginBottom:"10px",gap:"15px"},children:[e.jsx(we,{style:{padding:"0px",margin:"0px",textWrap:"nowrap"},children:"Commissioning passcode:"}),e.jsx(be,{value:h,onChange:ie,size:"small",variant:"outlined",style:{height:"30px",flexGrow:1},InputProps:{readOnly:n.readOnly===!0,style:{height:"30px",padding:"0"}}})]})]})]}):null}function Li({matterbridgeInfo:n}){return n?e.jsxs(Ce,{style:{flex:`1 1 ${Wt}px`},children:[e.jsx(De,{children:e.jsx(Se,{children:"Matterbridge info"})}),e.jsxs(Ne,{style:{flexDirection:"column",padding:"10px",gap:"5px"},children:[e.jsx(Pe,{value:n.matterbridgeVersion,label:"Current Version"}),e.jsx(Pe,{value:n.matterbridgeLatestVersion,label:"Latest Version"}),e.jsx(Pe,{value:n.rootDirectory,label:"Root Directory"}),e.jsx(Pe,{value:n.homeDirectory,label:"Home Directory"}),e.jsx(Pe,{value:n.matterbridgeDirectory,label:"Matterbridge Storage Directory"}),e.jsx(Pe,{value:n.matterbridgePluginDirectory,label:"Matterbridge Plugin Directory"}),e.jsx(Pe,{value:n.globalModulesDirectory,label:"Global Module Directory"})]})]}):null}function $i({systemInfo:n}){return n?e.jsxs(Ce,{style:{flex:`1 1 ${Wt}px`},children:[e.jsx(De,{children:e.jsx(Se,{children:"System info"})}),e.jsxs(Ne,{style:{flexDirection:"column",padding:"10px",gap:"5px"},children:[e.jsx(Pe,{value:n.interfaceName,label:"Interface name"}),e.jsx(Pe,{value:n.macAddress,label:"MAC Address"}),e.jsx(Pe,{value:n.ipv4Address,label:"IPv4 Address"}),e.jsx(Pe,{value:n.ipv6Address,label:"IPv6 Address"}),e.jsx(Pe,{value:n.nodeVersion,label:"Node Version"}),e.jsx(Pe,{value:n.hostname,label:"Hostname"}),e.jsx(Pe,{value:n.user,label:"User"})]})]}):null}function Pe({value:n,label:a,width:l}){return e.jsx(be,{focused:!0,value:n,size:"small",label:a,variant:"standard",sx:{width:l?`${l-20}px`:"100%","& .MuiInput-underline:before":{borderBottomColor:"var(--main-label-color)",borderBottomWidth:"1px",opacity:.5},"& .MuiInput-underline:hover:not(.Mui-disabled):before":{borderBottomColor:"var(--main-label-color)",borderBottomWidth:"1px",opacity:.5},"& .MuiInput-underline.Mui-focused:after":{borderBottomColor:"var(--main-label-color)",borderBottomWidth:"1px",opacity:.5}},slotProps:{input:{readOnly:!0,sx:{color:"var(--div-text-color)","&:before":{borderBottomColor:"var(--main-label-color)"},"&:after":{borderBottomColor:"var(--main-label-color)"}}},inputLabel:{sx:{marginTop:"3px",color:"var(--main-label-color)","&.Mui-focused":{color:"var(--main-label-color)"}}}}})}const Ti=r.memo(Mi);function Wi(){const{online:n,sendMessage:a,addListener:l,removeListener:i,getUniqueId:s}=r.useContext(ve),{showSnackbarMessage:m}=r.useContext(Le),[g,x]=r.useState(null),[j,t]=r.useState([]),[D,v]=r.useState([]),[S,A]=r.useState(null),[Y,Q]=r.useState({cpuUsage:0}),[q,h]=r.useState({totalMemory:"",freeMemory:"",heapTotal:"",heapUsed:"",external:"",arrayBuffers:"",rss:""}),[c,u]=r.useState({systemUptime:"",processUptime:""}),k=r.useRef(s());return o&&console.log("Test uniqueId:",k),r.useEffect(()=>{o&&console.log("Test useEffect WebSocketMessage mounting");const I=N=>{if(N.method==="restart_required")o&&console.log("Test received restart_required"),m("Restart required",0);else if(N.method==="refresh_required")o&&console.log(`Test received refresh_required: changed=${N.response.changed} and sending api requests`),m("Refresh required",0),a({id:k.current,method:"/api/settings",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{}}),a({id:k.current,method:"/api/plugins",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{}}),a({id:k.current,method:"/api/devices",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{}});else if(N.method==="memory_update")o&&console.log("Test received memory_update",N),h(N.response);else if(N.method==="cpu_update")o&&console.log("Test received cpu_update",N),Q(N.response);else if(N.method==="uptime_update")o&&console.log("Test received uptime_update",N),u(N.response);else if(N.method==="/api/settings"&&N.response)o&&console.log("Test received /api/settings:",N.response),m("Test received /api/settings",0),x(N.response);else if(N.method==="/api/plugins"&&N.response)o&&console.log(`Test received ${N.response.length} plugins:`,N.response),m("Test received /api/plugins",0),t(N.response);else if(N.method==="/api/devices"&&N.response){o&&console.log(`Test received ${N.response.length} devices:`,N.response),m("Test received /api/devices",0),v(N.response);for(const H of N.response)o&&console.log("Test sending /api/clusters for device:",H.pluginName,H.name,H.endpoint),a({id:k.current,method:"/api/clusters",sender:"Test",src:"Frontend",dst:"Matterbridge",params:{plugin:H.pluginName,endpoint:H.endpoint||0}})}else N.method==="/api/clusters"&&N.response&&(o&&console.log(`Test received ${N.response.clusters.length} clusters for device ${N.response.deviceName} endpoint ${N.response.id}:${N.response.number}:`,N),m(`Test received /api/clusters for ${N.response.plugin}::${N.response.deviceName}`,0),A(N.response))};return l(I,k.current),o&&console.log("Test useEffect WebSocketMessage mounted"),()=>{o&&console.log("Test useEffect WebSocketMessage unmounting"),i(I),o&&console.log("Test useEffect WebSocketMessage unmounted")}},[l,i,a,m]),r.useEffect(()=>(o&&console.log("Test useEffect online mounting"),n&&o&&console.log("Test useEffect online received online"),o&&console.log("Test useEffect online mounted"),()=>{o&&console.log("Test useEffect online unmounted")}),[n,a,m]),o&&console.log("Test rendering..."),n?e.jsx(ht,{name:"Test",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",alignContent:"center",gap:"20px",height:"100vh",width:"100vw"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"256px",width:"256px",margin:"10px"}}),e.jsx("p",{children:"Welcome to the Test page of the Matterbridge frontend"})]})}):e.jsx(Oe,{})}const Fi=r.memo(Wi);function Ni(n,a){o&&console.log("getCssVariable:",n,"defaultValue",a);const l=getComputedStyle(document.body).getPropertyValue(n).trim();return l||console.error("getCssVariable: undefined",l),l||a}function Ri(n){return Po({palette:{primary:{main:n},action:{disabled:"var(--main-label-color)"},text:{disabled:"var(--main-label-color)"}},typography:{fontFamily:"Roboto, Helvetica, Arial, sans-serif"},components:{MuiDialog:{styleOverrides:{paper:{color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)",border:"2px solid var(--div-border-color)",borderRadius:"var(--div-border-radius)",boxShadow:"2px 2px 5px var(--div-shadow-color)"}}},MuiTooltip:{defaultProps:{placement:"top-start",arrow:!0}},MuiButton:{styleOverrides:{root:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)","&:hover":{backgroundColor:"var(--main-button-bg-color)"},"&.Mui-disabled":{color:"var(--main-button-color)",backgroundColor:"var(--main-grey-color)"}},contained:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)"},outlined:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)"},text:{color:"var(--main-button-color)"}},defaultProps:{variant:"contained",size:"small"}},MuiIconButton:{styleOverrides:{root:{color:"var(--main-icon-color)","&:hover .MuiSvgIcon-root":{color:"var(--primary-color)"}}}},MuiCheckbox:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-checked":{color:"var(--primary-color)"}}}},MuiTextField:{defaultProps:{size:"small",variant:"outlined",fullWidth:!0}},MuiOutlinedInput:{styleOverrides:{root:{backgroundColor:"var(--div-bg-color)","& .MuiOutlinedInput-notchedOutline":{borderColor:"var(--main-label-color)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"var(--main-text-color)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"var(--primary-color)"},padding:"0px"},input:{color:"var(--div-text-color)",padding:"4px 8px"}}},MuiInputLabel:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-focused":{color:"var(--primary-color)"}}}},MuiFormLabel:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-focused":{color:"var(--main-label-color)"}}}},MuiFormControl:{styleOverrides:{root:{color:"var(--main-grey-color)"}}},MuiRadio:{styleOverrides:{root:{color:"var(--main-label-color)","&.Mui-checked":{color:"var(--primary-color)"}}}},MuiSelect:{styleOverrides:{root:{backgroundColor:"var(--div-bg-color)",color:"var(--div-text-color)",height:"30px","&:hover":{borderColor:"var(--main-text-color)"},"&.Mui-focused":{borderColor:"var(--primary-color)"}}}},MuiMenu:{styleOverrides:{paper:{backgroundColor:"var(--main-menu-bg-color)",padding:"0px",margin:"0px"},list:{padding:"0px"}}},MuiMenuItem:{styleOverrides:{root:{color:"var(--main-menu-color)",backgroundColor:"var(--main-menu-bg-color)","&:hover":{backgroundColor:"var(--main-menu-hover-color)"},"&.Mui-selected":{color:"var(--main-menu-color)",backgroundColor:"var(--main-menu-bg-color)"},"&.Mui-selected:hover":{backgroundColor:"var(--main-menu-hover-color)"}}}},MuiListItemButton:{styleOverrides:{root:{cursor:"pointer","&:hover":{backgroundColor:"var(--main-bg-color)"}}}},MuiListItemIcon:{styleOverrides:{root:{color:"var(--div-text-color)"}}},MuiListItemText:{styleOverrides:{primary:{fontSize:"16px",fontWeight:"bold",color:"var(--div-text-color)"},secondary:{fontSize:"14px",fontWeight:"normal",color:"var(--div-text-color)"}}}}})}function _i(){const{mobile:n,showSnackbarMessage:a,showConfirmCancelDialog:l}=r.useContext(Le),{online:i,sendMessage:s,logMessage:m,addListener:g,removeListener:x,getUniqueId:j}=r.useContext(ve),[t,D]=r.useState(!1),[v,S]=r.useState(!1),[A,Y]=r.useState(!1),[Q,q]=r.useState(!1),[h,c]=r.useState(null),u=r.useRef(j()),[k,I]=r.useState(null),[N,H]=r.useState(null),[ne,y]=r.useState(null),[p,d]=r.useState(null),[b,F]=r.useState(null),_=_r(),$=()=>{window.open("https://www.buymeacoffee.com/luligugithub","_blank")},V=()=>{window.open("https://matterbridge.io/")},ie=()=>{window.open("https://matterbridge.io/README.html")},K=()=>{window.open("https://matterbridge.io/CHANGELOG.html")},te=()=>{window.open("https://discord.gg/QX58CDe6hd","_blank")},R=()=>{window.open("https://github.com/Luligu/matterbridge","_blank")},M=()=>{s({id:u.current,sender:"Header",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:"matterbridge",restart:!0}}),Y(!1)},C=()=>{s({id:u.current,sender:"Header",method:"/api/install",src:"Frontend",dst:"Matterbridge",params:{packageName:"matterbridge@dev",restart:!0}}),q(!1)},W=()=>{s({id:u.current,sender:"Header",method:"/api/checkupdates",src:"Frontend",dst:"Matterbridge",params:{}})},T=()=>{o&&console.log("Header: handleShellySystemUpdateClick"),m("Matterbridge","Installing system updates..."),s({id:u.current,sender:"Header",method:"/api/shellysysupdate",src:"Frontend",dst:"Matterbridge",params:{}})},P=()=>{o&&console.log("Header: handleShellyMainUpdateClick"),m("Matterbridge","Installing software updates..."),s({id:u.current,sender:"Header",method:"/api/shellymainupdate",src:"Frontend",dst:"Matterbridge",params:{}})},O=()=>{o&&console.log("Header: handleShellyCreateSystemLog"),s({id:u.current,sender:"Header",method:"/api/shellycreatesystemlog",src:"Frontend",dst:"Matterbridge",params:{}})},X=()=>{o&&console.log("Header: handleShellyDownloadSystemLog"),m("Matterbridge","Downloading Shelly system log..."),a("Downloading Shelly system log...",5),window.location.href="./api/shellydownloadsystemlog"},me=()=>{h?.matterbridgeInformation.restartMode===""?s({id:u.current,sender:"Header",method:"/api/restart",src:"Frontend",dst:"Matterbridge",params:{}}):s({id:u.current,sender:"Header",method:"/api/shutdown",src:"Frontend",dst:"Matterbridge",params:{}})},ue=()=>{s({id:u.current,sender:"Header",method:"/api/shutdown",src:"Frontend",dst:"Matterbridge",params:{}})},J=()=>{s({id:u.current,sender:"Header",method:"/api/reboot",src:"Frontend",dst:"Matterbridge",params:{}})},f=()=>{s({id:u.current,sender:"Header",method:"/api/softreset",src:"Frontend",dst:"Matterbridge",params:{}})},pe=()=>{s({id:u.current,sender:"Header",method:"/api/hardreset",src:"Frontend",dst:"Matterbridge",params:{}})},Z=z=>{I(z.currentTarget)},L=z=>{o&&console.log("Header: handleMenuClose",z),I(null),z==="/"||z==="/devices"||z==="/log"||z==="/settings"?_(z):z==="reset_frontend"?(m("Matterbridge","Resetting frontend UI..."),a("Resetting frontend UI...",5),xn(),window.location.reload()):z==="download-mblog"?(m("Matterbridge","Downloading matterbridge log..."),a("Downloading matterbridge log...",5),window.location.href="./api/download-mblog"):z==="download-mjlog"?(m("Matterbridge","Downloading matter log..."),a("Downloading matter log...",5),window.location.href="./api/download-mjlog"):z==="view-mblog"?(m("Matterbridge","Loading matterbridge log..."),a("Loading matterbridge log...",5),window.open("./api/view-mblog","_blank","noopener,noreferrer")):z==="view-mjlog"?(m("Matterbridge","Loading matter log..."),a("Loading matter log...",5),window.open("./api/view-mjlog","_blank","noopener,noreferrer")):z==="view-diagnostic"?(m("Matterbridge","Loading diagnostic log..."),a("Loading diagnostic log...",5),window.open("./api/view-diagnostic","_blank","noopener,noreferrer")):z==="download-diagnostic"?(m("Matterbridge","Downloading diagnostic log..."),a("Downloading diagnostic log...",5),window.location.href="./api/download-diagnostic"):z==="view-history"?s({id:u.current,sender:"Header",method:"/api/viewhistorypage",src:"Frontend",dst:"Matterbridge",params:{}}):z==="download-history"?s({id:u.current,sender:"Header",method:"/api/downloadhistorypage",src:"Frontend",dst:"Matterbridge",params:{}}):z==="view-shellylog"?(m("Matterbridge","Loading shelly system log..."),a("Loading shelly system log...",5),window.location.href="./api/shellyviewsystemlog"):z==="download-mbstorage"?(m("Matterbridge","Downloading matterbridge storage..."),a("Downloading matterbridge storage...",5),window.location.href="./api/download-mbstorage"):z==="download-pluginstorage"?(m("Matterbridge","Downloading matterbridge plugins storage..."),a("Downloading matterbridge plugins storage...",5),window.location.href="./api/download-pluginstorage"):z==="download-pluginconfig"?(m("Matterbridge","Downloading matterbridge plugins config..."),a("Downloading matterbridge plugins config...",5),window.location.href="./api/download-pluginconfig"):z==="download-mjstorage"?(m("Matterbridge","Downloading matter storage..."),a("Downloading matter storage...",5),window.location.href="./api/download-mjstorage"):z==="download-backup"?(m("Matterbridge","Downloading backup..."),a("Downloading backup...",10),window.location.href="./api/download-backup"):z==="update"?M():z==="updatedev"?C():z==="updatecheck"?W():z==="shelly-sys-update"?T():z==="shelly-main-update"?P():z==="shelly-create-system-log"?O():z==="shelly-download-system-log"?X():z==="softreset"?f():z==="hardreset"?pe():z==="restart"?me():z==="shutdown"?ue():z==="reboot"?J():z==="create-backup"?s({id:u.current,sender:"Header",method:"/api/create-backup",src:"Frontend",dst:"Matterbridge",params:{}}):z==="unregister"?s({id:u.current,sender:"Header",method:"/api/unregister",src:"Frontend",dst:"Matterbridge",params:{}}):z==="reset"?s({id:u.current,sender:"Header",method:"/api/reset",src:"Frontend",dst:"Matterbridge",params:{}}):z==="factoryreset"&&s({id:u.current,sender:"Header",method:"/api/factoryreset",src:"Frontend",dst:"Matterbridge",params:{}})},je=z=>{o&&console.log("Header: handleMenuCloseCancel:",z),I(null)},Re=z=>{H(z.currentTarget)},ye=()=>{H(null)},se=z=>{y(z.currentTarget)},ge=()=>{y(null)},Ee=z=>{d(z.currentTarget)},Me=()=>{d(null)},ct=z=>{F(z.currentTarget)},U=()=>{F(null)},ke=()=>{Ei(),o&&console.log("Matterbridge logo clicked: debug is now",o)};return r.useEffect(()=>{const z=le=>{o&&console.log("Header received WebSocket Message:",le),le.method==="/api/settings"&&le.id===u.current?(o&&console.log("Header received settings:",le.response),c(le.response),D(le.response.matterbridgeInformation.restartRequired||le.response.matterbridgeInformation.fixedRestartRequired),S(le.response.matterbridgeInformation.fixedRestartRequired),Y(le.response.matterbridgeInformation.updateRequired)):le.method==="refresh_required"&&le.response.changed==="settings"?(o&&console.log(`Header received refresh_required: changed=${le.response.changed} and sending /api/settings request`),s({id:u.current,sender:"Header",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})):le.method==="restart_required"?(o&&console.log(`Header received restart_required with fixed: ${le.response.fixed}`),D(!0),le.response.fixed===!0&&S(!0)):le.method==="restart_not_required"?(o&&console.log("Header received restart_not_required"),D(!1)):le.method==="update_required"?(o&&console.log("Header received update_required"),le.response.devVersion===!0?q(!0):Y(!0),s({id:u.current,sender:"Header",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}})):le.method==="shelly_sys_update"?(o&&console.log("Header received WS_ID_SHELLY_SYS_UPDATE:"),c($e=>$e?{matterbridgeInformation:{...$e.matterbridgeInformation,shellySysUpdate:le.response.available},systemInformation:$e.systemInformation}:null)):le.method==="shelly_main_update"?(o&&console.log("Header received WS_ID_SHELLY_MAIN_UPDATE:"),c($e=>$e?{matterbridgeInformation:{...$e.matterbridgeInformation,shellyMainUpdate:le.response.available},systemInformation:$e.systemInformation}:null)):le.method==="/api/viewhistorypage"&&le.id===u.current&&le.success===!0?(o&&console.log("Header received /api/viewhistorypage success"),window.open("./api/viewhistory","_blank","noopener,noreferrer")):le.method==="/api/downloadhistorypage"&&le.id===u.current&&le.success===!0&&(o&&console.log("Header received /api/downloadhistorypage success"),window.location.href="./api/downloadhistory")};return g(z,u.current),o&&console.log(`Header added WebSocket listener id ${u.current}`),()=>{x(z),o&&console.log("Header removed WebSocket listener")}},[g,x,s,a]),r.useEffect(()=>{i&&(o&&console.log("Header sending /api/settings and /api/checkupdates requests"),s({id:u.current,sender:"Header",method:"/api/settings",src:"Frontend",dst:"Matterbridge",params:{}}),s({id:u.current,sender:"Header",method:"/api/checkupdates",src:"Frontend",dst:"Matterbridge",params:{}}))},[i,s]),o&&console.log("Header rendering... mobile %s",n),!i||!h?null:e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",width:"100%",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"30px"},onClick:ke}),e.jsx("h2",{style:{fontSize:"22px",color:"var(--main-icon-color)",margin:"0px"},children:"Matterbridge"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:e.jsxs("nav",{children:[e.jsx(ft,{to:"/",className:"nav-link",children:"Home"}),e.jsx(ft,{to:"/devices",className:"nav-link",children:"Devices"}),e.jsx(ft,{to:"/log",className:"nav-link",children:"Logs"}),e.jsx(ft,{to:"/settings",className:"nav-link",children:"Settings"})]})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"10px"},children:[!h.matterbridgeInformation.readOnly&&e.jsx(E,{title:`Matterbridge v.${h.matterbridgeInformation.matterbridgeVersion}`,children:e.jsxs("span",{className:"status-information",style:{cursor:"default"},children:["v.",h.matterbridgeInformation.matterbridgeVersion.split("-")[0]+(h.matterbridgeInformation.matterbridgeVersion.includes("-dev-")?"@dev":"")+(h.matterbridgeInformation.matterbridgeVersion.includes("-git-")?"@git":"")]})}),h.matterbridgeInformation.shellyBoard&&e.jsx("img",{src:"Shelly.svg",alt:"Shelly Icon",style:{height:"30px",padding:"0px",margin:"0px",marginRight:"30px"}}),h.matterbridgeInformation.bridgeMode!==""&&h.matterbridgeInformation.readOnly===!1?e.jsx(E,{title:"Bridge mode",children:e.jsx("span",{className:"status-information",style:{cursor:"default"},children:h.matterbridgeInformation.bridgeMode})}):null,h.matterbridgeInformation.restartMode!==""&&h.matterbridgeInformation.readOnly===!1?e.jsx(E,{title:"Restart mode",children:e.jsx("span",{className:"status-information",style:{cursor:"default"},children:h.matterbridgeInformation.restartMode})}):null,h.matterbridgeInformation.profile&&h.matterbridgeInformation.profile!==""&&h.matterbridgeInformation.readOnly===!1?e.jsx(E,{title:"Current profile",children:e.jsx("span",{className:"status-information",style:{cursor:"default"},children:h.matterbridgeInformation.profile})}):null,o&&e.jsxs("span",{className:"status-information",style:{cursor:"default"},children:[n?"Mobile ":"Desktop ",`${Pt}x${Lt}`,` enabled ${localStorage.getItem(oe.enableMobile)!=="false"}`]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",gap:"5px"},children:[h.matterbridgeInformation.readOnly===!1?e.jsx(E,{title:"Matterbridge discord group",children:e.jsx("img",{src:"discord.svg",alt:"Discord Logo",style:{cursor:"pointer",height:"25px"},onClick:te})}):null,h.matterbridgeInformation.readOnly===!1?e.jsx(E,{title:"Give a star to Matterbridge",children:e.jsx(G,{style:{color:"#FFD700",margin:"0",padding:"0"},onClick:R,children:e.jsx(br,{})})}):null,h.matterbridgeInformation.readOnly===!1?e.jsx(E,{title:"Sponsor Matterbridge",children:e.jsx(G,{style:{color:"#b6409c",margin:"0",padding:"0"},onClick:$,children:e.jsx(At,{})})}):null,e.jsx(E,{title:"Matterbridge homepage",children:e.jsx(G,{style:{color:"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:V,children:e.jsx(Lo,{})})}),e.jsx(E,{title:"Matterbridge help",children:e.jsx(G,{style:{color:"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:ie,children:e.jsx(hr,{})})}),e.jsx(E,{title:"Matterbridge changelog",children:e.jsx(G,{style:{color:"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:K,children:e.jsx(Vt,{})})}),h.matterbridgeInformation&&!h.matterbridgeInformation.readOnly&&A&&e.jsx(E,{title:`Update matterbridge to latest version v.${h.matterbridgeInformation.matterbridgeLatestVersion}`,children:e.jsx(G,{style:{color:"var(--primary-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:M,children:e.jsx(_e,{})})}),h.matterbridgeInformation&&!h.matterbridgeInformation.readOnly&&Q&&e.jsx(E,{title:`Update matterbridge to latest dev version v.${h.matterbridgeInformation.matterbridgeDevVersion}`,children:e.jsx(G,{style:{color:"var(--secondary-color)",margin:"0",marginLeft:"5px",padding:"0"},onClick:C,children:e.jsx(_e,{})})}),h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&h.matterbridgeInformation.shellySysUpdate&&e.jsx(E,{title:"Shelly system update",children:e.jsx(G,{style:{color:"var(--primary-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:T,children:e.jsx(_e,{})})}),h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&h.matterbridgeInformation.shellyMainUpdate&&e.jsx(E,{title:"Shelly software update",children:e.jsx(G,{style:{color:"var(--primary-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:P,children:e.jsx(_e,{})})}),e.jsx(E,{title:"Restart matterbridge",children:e.jsx(G,{style:{color:t||v?"var(--primary-color)":"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:me,children:e.jsx(Dt,{})})}),h.matterbridgeInformation.restartMode===""?e.jsx(E,{title:"Shut down matterbridge",children:e.jsx(G,{style:{color:t||v?"var(--primary-color)":"var(--main-icon-color)",margin:"0",marginLeft:"5px",padding:"0px"},onClick:ue,children:e.jsx(Qe,{})})}):null,e.jsx(E,{title:"Download, backup and more",children:e.jsx(G,{onClick:Z,children:e.jsx($o,{style:{color:"var(--main-icon-color)"}})})}),e.jsxs(st,{id:"command-menu",anchorEl:k,keepMounted:!0,open:!!k,onClose:()=>L(""),children:[xe&&n&&e.jsxs(w,{onClick:()=>L("/"),children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Home page",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),xe&&n&&e.jsxs(w,{onClick:()=>L("/devices"),children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Devices page",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),xe&&n&&e.jsxs(w,{onClick:()=>L("/log"),children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Logs page",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),xe&&n&&e.jsxs(w,{onClick:()=>L("/settings"),children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Settings page",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&!h.matterbridgeInformation.readOnly&&e.jsxs(w,{onClick:()=>L("update"),children:[e.jsx(B,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Install latest stable",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&!h.matterbridgeInformation.readOnly&&e.jsxs(w,{onClick:()=>L("updatedev"),children:[e.jsx(B,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Install latest dev",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&!h.matterbridgeInformation.readOnly&&e.jsxs(w,{onClick:()=>L("updatecheck"),children:[e.jsx(B,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Check for updates",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&h.matterbridgeInformation.shellySysUpdate&&e.jsxs(w,{onClick:()=>L("shelly-sys-update"),children:[e.jsx(B,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Shelly system update",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&h.matterbridgeInformation.shellyMainUpdate&&e.jsxs(w,{onClick:()=>L("shelly-main-update"),children:[e.jsx(B,{children:e.jsx(_e,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Shelly software update",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>L("restart"),children:[e.jsx(B,{children:e.jsx(Dt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Restart",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation.restartMode===""?e.jsxs(w,{onClick:()=>L("shutdown"),children:[e.jsx(B,{children:e.jsx(Qe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Shutdown",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}):null,h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&e.jsxs(w,{onClick:()=>{l("Reboot","Are you sure you want to reboot the Shelly board?","reboot",L,je)},children:[e.jsx(B,{children:e.jsx(Dt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Reboot...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsx(jt,{}),e.jsxs(w,{onClick:se,children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"View",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(st,{id:"sub-menu-view",anchorEl:ne,keepMounted:!0,open:!!ne,onClose:ge,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(w,{onClick:()=>{Ai(),ge(),je(""),window.open("/home","_self")},children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Desktop site",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{Vi(),ge(),je(""),window.open("/home","_self")},children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Mobile site",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("view-mblog"),ge()},children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matterbridge log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("view-mjlog"),ge()},children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matter log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("view-diagnostic"),ge()},children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matterbridge diagnostic log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("view-history"),ge()},children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matterbridge system history",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&e.jsxs(w,{onClick:()=>{L("view-shellylog"),ge()},children:[e.jsx(B,{children:e.jsx(We,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Shelly system log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]}),e.jsx(jt,{}),e.jsxs(w,{onClick:Ee,children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Download",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(st,{id:"sub-menu-download",anchorEl:p,keepMounted:!0,open:!!p,onClose:Me,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(w,{onClick:()=>{L("download-mbstorage"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matterbridge storage",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("download-pluginstorage"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matterbridge plugins storage",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("download-pluginconfig"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matterbridge plugins config",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("download-mblog"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matterbridge log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("download-mjstorage"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matter storage",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("download-mjlog"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matter log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("download-diagnostic"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matterbridge diagnostic log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("download-history"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Matterbridge system history",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&e.jsxs(w,{onClick:()=>{L("shelly-create-system-log"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Create Shelly system log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&e.jsxs(w,{onClick:()=>{L("shelly-download-system-log"),Me()},children:[e.jsx(B,{children:e.jsx(Fe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Download Shelly system log",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]}),e.jsx(jt,{}),e.jsxs(w,{onClick:Re,children:[e.jsx(B,{children:e.jsx(Nt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Backup",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(st,{id:"sub-menu-backup",anchorEl:N,keepMounted:!0,open:!!N,onClose:ye,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(w,{onClick:()=>{L("create-backup"),ye()},children:[e.jsx(B,{children:e.jsx(Nt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Create backup",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{L("download-backup"),ye()},children:[e.jsx(B,{children:e.jsx(Nt,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Download backup",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]}),e.jsx(jt,{}),e.jsxs(w,{onClick:ct,children:[e.jsx(B,{children:e.jsx(To,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Reset",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(st,{id:"sub-menu-reset",anchorEl:b,keepMounted:!0,open:!!b,onClose:U,sx:{"& .MuiPaper-root":{backgroundColor:"#e2e2e2"}},children:[e.jsxs(w,{onClick:()=>{U(),l("Reset the frontend UI","Are you sure you want to reset the frontend UI? This will reset all local settings and reload the page.","reset_frontend",L,je)},children:[e.jsx(B,{children:e.jsx(Qe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Reset the frontend UI...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{U(),l("Reset all devices and shutdown","Are you sure you want to unregister all devices? This will temporarily remove all devices from the controller and you may loose the controller configuration.","unregister",L,je)},children:[e.jsx(B,{children:e.jsx(Qe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Reset all devices...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),e.jsxs(w,{onClick:()=>{U(),l("Reset commissioning and shutdown","Are you sure you want to reset the commissioning? You will have to manually remove Matterbridge from the controller.","reset",L,je)},children:[e.jsx(B,{children:e.jsx(Qe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Reset commissioning...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),!h.matterbridgeInformation.readOnly&&e.jsxs(w,{onClick:()=>{U(),l("Factory reset and shutdown","Are you sure you want to factory reset Matterbridge? You will have to manually remove Matterbridge from the controller.","factoryreset",L,je)},children:[e.jsx(B,{children:e.jsx(Qe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Factory reset...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&e.jsxs(w,{onClick:()=>{U(),l("Network reset","Are you sure you want to factory reset the network parameters?","softreset",L,je)},children:[e.jsx(B,{children:e.jsx(Qe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Reset network...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]}),h.matterbridgeInformation&&h.matterbridgeInformation.shellyBoard&&e.jsxs(w,{onClick:()=>{U(),l("Factory reset","Are you sure you want to factory reset Matterbridge? You will have to manually remove Matterbridge from the controller.","hardreset",L,je)},children:[e.jsx(B,{children:e.jsx(Qe,{style:{color:"var(--main-icon-color)"}})}),e.jsx(re,{primary:"Factory reset...",primaryTypographyProps:{style:{fontWeight:"normal",color:"var(--main-icon-color)"}}})]})]})]})]})]})}const dr=r.memo(_i),kr=1200,Ir=900;let Pt,Lt;function pr(){if(typeof window<"u"){Pt=Math.floor(window.visualViewport?.width??window.innerWidth),Lt=Math.floor(window.visualViewport?.height??window.innerHeight);const n=Pt<kr||Lt<Ir;return o&&console.log("Visual viewport (%s) width %i height %i mobile %s",window.visualViewport!==void 0,Pt,Lt,n),n}return!1}function Oi({children:n}){const{mobile:a,setMobile:l}=r.useContext(Le),{logAutoScroll:i}=r.useContext(ve);return r.useEffect(()=>{function s(){const m=pr();m&&(i.current=!1,localStorage.setItem(oe.logAutoScroll,"false")),l(m)}return window.addEventListener("resize",s),l(pr()),()=>window.removeEventListener("resize",s)},[i,l]),o&&console.log("MbfScreen rendering... mobile %s",a),xe&&a?e.jsxs("div",{style:{display:"flex",flexDirection:"column",overflow:"visible",margin:"0px",padding:"10px",gap:"10px"},children:[e.jsx(dr,{}),e.jsx("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",margin:"0px",padding:"0px",gap:"10px"},children:n})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",overflow:"hidden",width:a?`${kr}px`:"calc(100vw - 40px)",height:a?`${Ir}px`:"calc(100vh - 40px)",margin:"0px",padding:"20px",gap:"20px"},children:[e.jsx(dr,{}),e.jsx("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"calc(100% - 60px)",margin:"0px",padding:"0px",gap:"20px"},children:n})]})}let o=!1;const Ei=()=>{o=!o},Hi=!1;let xe=localStorage.getItem(oe.enableMobile)!=="false";const Vi=()=>{xe=!0,localStorage.setItem(oe.enableMobile,"true")},Ai=()=>{xe=!1,localStorage.setItem(oe.enableMobile,"false")};let at;const Ui=n=>{at=n};let mt=!1,ur="/",it="/",Et="/";function qi({setLoggedIn:n}){const[a,l]=r.useState(""),[i,s]=r.useState(""),m={display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"var(--main-bg-color)"},g={display:"flex",flexDirection:"column",maxWidth:"400px",margin:"0 auto",padding:"20px",gap:"20px",border:"1px solid var(--div-border-color)",borderRadius:"var(--div-border-radius)",boxShadow:"2px 2px 5px var(--div-shadow-color)",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},x={margin:"10px 0",padding:"3px 3px",fontSize:"14px",width:"230px",border:"1px solid var(--main-label-color)",color:"var(--div-text-color)",backgroundColor:"var(--div-bg-color)"},j=async D=>{try{const v=await fetch("./api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:D})});if(v.ok){const{valid:S}=await v.json();S?(n(!0),D!==""&&(at=D)):D!==""&&s("Incorrect password!")}else console.error("Failed to log in:",v.statusText)}catch(v){console.error("Failed to log in:",v)}},t=D=>{D.preventDefault(),j(a)};return j(""),e.jsx("div",{style:m,children:e.jsxs("form",{onSubmit:t,style:g,children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"20px"},children:[e.jsx("img",{src:"matterbridge.svg",alt:"Matterbridge Logo",style:{height:"32px",width:"32px"}}),e.jsx("h3",{style:{color:"var(--div-text-color)"},children:"Welcome to Matterbridge"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:"20px"},children:[e.jsx("input",{type:"text",name:"username",autoComplete:"username",style:{display:"none"},tabIndex:-1}),e.jsx("input",{type:"password",value:a,onChange:D=>l(D.target.value),style:x,placeholder:"password",autoComplete:"current-password"}),e.jsx("button",{type:"submit",style:{color:"var(--main-button-color)",backgroundColor:"var(--main-button-bg-color)",borderColor:"var(--div-bg-color)"},children:"Log in"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",margin:0,height:"30px"},children:i&&e.jsx("p",{style:{color:"red"},children:i})})]})})}function zi(){const[n,a]=r.useState(!1),l=localStorage.getItem(oe.frontendTheme)||"dark";o&&console.log('Setting frontend theme "%s"',l),document.body.setAttribute("frontend-theme",l);const i=Ni("--primary-color","#1976d2");o&&console.log('Primary color from CSS "%s"',i);const s=Ri(i);return ur=window.location.href,it=window.location.pathname,Et=it.includes("/matterbridge/")?"/matterbridge/":it.includes("/api/hassio_ingress/")?it:"/",mt=it.includes("/api/hassio_ingress/"),console.log("Loading App..."),console.log(`- href = "${ur}"`),console.log(`- pathname = "${it}"`),console.log(`- baseName = "${Et}"`),console.log(`- isIngress = "${mt}"`),n?e.jsx(Wo,{theme:s,children:e.jsx(qr,{dense:!0,maxSnack:10,preventDuplicate:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(vn,{children:e.jsx(yn,{children:e.jsx(Or,{basename:Et,children:e.jsx(Oi,{children:e.jsxs(Er,{children:[e.jsx(Xe,{path:"/",element:e.jsx(Zn,{})}),e.jsx(Xe,{path:"/devices",element:e.jsx(Ci,{})}),e.jsx(Xe,{path:"/log",element:e.jsx(Si,{})}),e.jsx(Xe,{path:"/settings",element:e.jsx(Ti,{})}),e.jsx(Xe,{path:"/test",element:e.jsx(Fi,{})}),e.jsx(Xe,{path:"*",element:e.jsx(Hr,{to:"/"})})]})})})})})})}):e.jsx(qi,{setLoggedIn:a})}Vr.createRoot(document.getElementById("root")).render(e.jsx(Ar.StrictMode,{children:e.jsx(zi,{})}));
